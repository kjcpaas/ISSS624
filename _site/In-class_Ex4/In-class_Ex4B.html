<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kristine Joy Paas">
<meta name="dcterms.date" content="2023-12-09">

<title>ISSS624 - In-class Ex 4: Calibration</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ISSS624</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex1/Hands-on_Ex1A.html" rel="" target="">
 <span class="dropdown-text">1A: Data Wrangling with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex1/Hands-on_Ex1B.html" rel="" target="">
 <span class="dropdown-text">1B: Choropleth Mapping with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex2/Hands-on_Ex2A.html" rel="" target="">
 <span class="dropdown-text">2A: Spatial Weights and Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex2/Hands-on_Ex2B.html" rel="" target="">
 <span class="dropdown-text">2B: Global Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex2/Hands-on_Ex2C.html" rel="" target="">
 <span class="dropdown-text">2C: Local Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex3/Hands-on_Ex3.html" rel="" target="">
 <span class="dropdown-text">3: Processing and Visualizing Flow Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../In-class_Ex1/In-class_Ex1.html" rel="" target="">
 <span class="dropdown-text">1: Bus Commuter Flow by Origin</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex2/In-class_Ex2A.html" rel="" target="">
 <span class="dropdown-text">2A: Spatial Weights with sfdep</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex2/In-class_Ex2B.html" rel="" target="">
 <span class="dropdown-text">2B: GLSA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex2/In-class_Ex2C.html" rel="" target="">
 <span class="dropdown-text">2C: EHSA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex3/In-class_Ex3.html" rel="" target="">
 <span class="dropdown-text">3: Calibrating Spatial Interactions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex4/In-class_Ex4A.html" rel="" target="">
 <span class="dropdown-text">4A: Geocoding</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex4/In-class_Ex4B.html" rel="" target="">
 <span class="dropdown-text">4B: SIM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex5/In-class_Ex5.html" rel="" target="">
 <span class="dropdown-text">5: Spatial Economic Interaction Models</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../Take-home_Ex1/Take-home_Ex1.html" rel="" target="">
 <span class="dropdown-text">1: Geospatial Analytics for Public Good</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Take-home_Ex2/Take-home_Ex2.html" rel="" target="">
 <span class="dropdown-text">2: Applied Spatial Interaction Models</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">The Data</a></li>
  <li><a href="#origin-production-constrained-sim" id="toc-origin-production-constrained-sim" class="nav-link" data-scroll-target="#origin-production-constrained-sim">Origin (Production) constrained SIM</a>
  <ul class="collapse">
  <li><a href="#goodness-of-fit" id="toc-goodness-of-fit" class="nav-link" data-scroll-target="#goodness-of-fit">Goodness of Fit</a></li>
  </ul></li>
  <li><a href="#doubly-constrained" id="toc-doubly-constrained" class="nav-link" data-scroll-target="#doubly-constrained">Doubly constrained</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">In-class Ex 4: Calibration</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kristine Joy Paas </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 9, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">December 9, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="setup" class="level1">
<h1>Setup</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tmap, sf, sp, DT, performance, reshape2, ggpubr, units, tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-data" class="level1">
<h1>The Data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>flow_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/flow_data_tidy.rds"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(flow_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 14,734
Columns: 13
$ ORIGIN_SZ       &lt;chr&gt; "AMSZ01", "AMSZ01", "AMSZ01", "AMSZ01", "AMSZ01", "AMS…
$ DESTIN_SZ       &lt;chr&gt; "AMSZ01", "AMSZ02", "AMSZ03", "AMSZ04", "AMSZ05", "AMS…
$ MORNING_PEAK    &lt;dbl&gt; 1998, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, …
$ dist            &lt;dbl&gt; 50.0000, 810.4491, 1360.9294, 840.4432, 1076.7916, 805…
$ ORIGIN_AGE7_12  &lt;dbl&gt; 310, 310, 310, 310, 310, 310, 310, 310, 310, 310, 310,…
$ ORIGIN_AGE13_24 &lt;dbl&gt; 710, 710, 710, 710, 710, 710, 710, 710, 710, 710, 710,…
$ ORIGIN_AGE25_64 &lt;dbl&gt; 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, …
$ DESTIN_AGE7_12  &lt;dbl&gt; 310.00, 1140.00, 1010.00, 980.00, 810.00, 1050.00, 420…
$ DESTIN_AGE13_24 &lt;dbl&gt; 710.00, 2770.00, 2650.00, 2000.00, 1920.00, 2390.00, 1…
$ DESTIN_AGE25_64 &lt;dbl&gt; 2780.00, 15700.00, 14240.00, 11320.00, 9650.00, 12460.…
$ SCHOOL_COUNT    &lt;dbl&gt; 0.99, 2.00, 2.00, 1.00, 3.00, 2.00, 0.99, 0.99, 3.00, …
$ RETAIL_COUNT    &lt;dbl&gt; 1.00, 0.99, 6.00, 0.99, 0.99, 0.99, 1.00, 117.00, 0.99…
$ geometry        &lt;LINESTRING [m]&gt; LINESTRING (29501.77 39419...., LINESTRING …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>FlowNoIntra <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_SZ <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_SZ,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, flow_data<span class="sc">$</span>MORNING_PEAK</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>offset <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_SZ <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_SZ,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.000001</span>, <span class="dv">1</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> flow_data <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FlowNoIntra <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> inter_zonal_flow <span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">TRIPS =</span> MORNING_PEAK,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">DIST =</span> dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="origin-production-constrained-sim" class="level1">
<h1>Origin (Production) constrained SIM</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The tilde (~) is equivalent to “a function of”, i.e.&nbsp;<code>TRIPS</code> is a function of <code>SCHOOL_COUNT</code>, <code>RETAIL_COUNT</code>, <code>DIST</code>.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>orcSIM_Poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                        ORIGIN_SZ <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(SCHOOL_COUNT) <span class="sc">+</span> <span class="co"># attractiveness</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(RETAIL_COUNT) <span class="sc">+</span> <span class="co"># attractiveness</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(DIST) <span class="sc">-</span> <span class="dv">1</span>, <span class="co"># impedance (-1 to remove the intercept)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">na.action =</span> na.exclude</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orcSIM_Poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + log(SCHOOL_COUNT) + log(RETAIL_COUNT) + 
    log(DIST) - 1, family = poisson(link = "log"), data = inter_zonal_flow, 
    na.action = na.exclude)

Coefficients:
                    Estimate Std. Error  z value Pr(&gt;|z|)    
ORIGIN_SZAMSZ01   19.8739840  0.0047627  4172.84   &lt;2e-16 ***
ORIGIN_SZAMSZ02   20.5902203  0.0042786  4812.33   &lt;2e-16 ***
ORIGIN_SZAMSZ03   20.2327026  0.0045531  4443.70   &lt;2e-16 ***
ORIGIN_SZAMSZ04   19.7744438  0.0049837  3967.79   &lt;2e-16 ***
ORIGIN_SZAMSZ05   19.6574529  0.0056396  3485.61   &lt;2e-16 ***
ORIGIN_SZAMSZ06   19.9659115  0.0048946  4079.16   &lt;2e-16 ***
ORIGIN_SZAMSZ07   18.6746164  0.0096316  1938.90   &lt;2e-16 ***
ORIGIN_SZAMSZ08   19.2701601  0.0090776  2122.82   &lt;2e-16 ***
ORIGIN_SZAMSZ09   19.9889467  0.0052858  3781.64   &lt;2e-16 ***
ORIGIN_SZAMSZ10   20.3422035  0.0045778  4443.62   &lt;2e-16 ***
ORIGIN_SZAMSZ11   18.3944113  0.0129212  1423.58   &lt;2e-16 ***
ORIGIN_SZAMSZ12   18.3484209  0.0109652  1673.33   &lt;2e-16 ***
ORIGIN_SZBDSZ01   20.9668587  0.0043388  4832.36   &lt;2e-16 ***
ORIGIN_SZBDSZ02   20.4059518  0.0050601  4032.75   &lt;2e-16 ***
ORIGIN_SZBDSZ03   20.6725514  0.0045276  4565.93   &lt;2e-16 ***
ORIGIN_SZBDSZ04   21.6703853  0.0038930  5566.44   &lt;2e-16 ***
ORIGIN_SZBDSZ05   20.7497445  0.0046085  4502.46   &lt;2e-16 ***
ORIGIN_SZBDSZ06   20.9119361  0.0046432  4503.77   &lt;2e-16 ***
ORIGIN_SZBDSZ07   18.9749815  0.0097896  1938.28   &lt;2e-16 ***
ORIGIN_SZBDSZ08   19.1933901  0.0091312  2101.95   &lt;2e-16 ***
ORIGIN_SZBKSZ01   19.5422606  0.0064732  3018.96   &lt;2e-16 ***
ORIGIN_SZBKSZ02   20.1748913  0.0050076  4028.89   &lt;2e-16 ***
ORIGIN_SZBKSZ03   20.3984624  0.0047226  4319.35   &lt;2e-16 ***
ORIGIN_SZBKSZ04   19.6182212  0.0059652  3288.76   &lt;2e-16 ***
ORIGIN_SZBKSZ05   19.6033818  0.0063181  3102.74   &lt;2e-16 ***
ORIGIN_SZBKSZ06   19.7145224  0.0056372  3497.20   &lt;2e-16 ***
ORIGIN_SZBKSZ07   20.4237448  0.0041912  4873.03   &lt;2e-16 ***
ORIGIN_SZBKSZ08   19.7992538  0.0050405  3928.02   &lt;2e-16 ***
ORIGIN_SZBKSZ09   19.7821586  0.0055558  3560.66   &lt;2e-16 ***
ORIGIN_SZBLSZ01   17.7977276  0.0149058  1194.01   &lt;2e-16 ***
ORIGIN_SZBLSZ02   17.4287491  0.0192364   906.03   &lt;2e-16 ***
ORIGIN_SZBLSZ03   16.5884288  0.0459848   360.74   &lt;2e-16 ***
ORIGIN_SZBLSZ04   17.7851626  0.0232823   763.89   &lt;2e-16 ***
ORIGIN_SZBMSZ01   20.0751840  0.0052887  3795.89   &lt;2e-16 ***
ORIGIN_SZBMSZ02   18.6956140  0.0066656  2804.80   &lt;2e-16 ***
ORIGIN_SZBMSZ03   19.3204425  0.0054755  3528.56   &lt;2e-16 ***
ORIGIN_SZBMSZ04   19.4724220  0.0049390  3942.59   &lt;2e-16 ***
ORIGIN_SZBMSZ05   16.9581801  0.0168804  1004.61   &lt;2e-16 ***
ORIGIN_SZBMSZ06   16.9898638  0.0181852   934.27   &lt;2e-16 ***
ORIGIN_SZBMSZ07   19.2868403  0.0056231  3429.91   &lt;2e-16 ***
ORIGIN_SZBMSZ08   19.1477543  0.0055918  3424.28   &lt;2e-16 ***
ORIGIN_SZBMSZ09   18.7564539  0.0086298  2173.46   &lt;2e-16 ***
ORIGIN_SZBMSZ10   18.3617854  0.0089250  2057.35   &lt;2e-16 ***
ORIGIN_SZBMSZ11   18.9167941  0.0063340  2986.54   &lt;2e-16 ***
ORIGIN_SZBMSZ12   18.7874661  0.0093024  2019.63   &lt;2e-16 ***
ORIGIN_SZBMSZ13   19.5654046  0.0057517  3401.70   &lt;2e-16 ***
ORIGIN_SZBMSZ14   19.0685619  0.0063346  3010.24   &lt;2e-16 ***
ORIGIN_SZBMSZ15   19.4403124  0.0058147  3343.30   &lt;2e-16 ***
ORIGIN_SZBMSZ16   18.4469203  0.0092638  1991.28   &lt;2e-16 ***
ORIGIN_SZBMSZ17   18.3430175  0.0157692  1163.22   &lt;2e-16 ***
ORIGIN_SZBPSZ01   20.1806714  0.0053660  3760.81   &lt;2e-16 ***
ORIGIN_SZBPSZ02   19.8116707  0.0061485  3222.19   &lt;2e-16 ***
ORIGIN_SZBPSZ03   19.8467602  0.0059769  3320.57   &lt;2e-16 ***
ORIGIN_SZBPSZ04   20.4613200  0.0048398  4227.72   &lt;2e-16 ***
ORIGIN_SZBPSZ05   20.5379711  0.0043769  4692.39   &lt;2e-16 ***
ORIGIN_SZBPSZ06   18.8948034  0.0093668  2017.21   &lt;2e-16 ***
ORIGIN_SZBPSZ07   19.4104568  0.0087961  2206.70   &lt;2e-16 ***
ORIGIN_SZBSSZ01   20.0139503  0.0056561  3538.45   &lt;2e-16 ***
ORIGIN_SZBSSZ02   20.2543885  0.0047198  4291.38   &lt;2e-16 ***
ORIGIN_SZBSSZ03   19.5428803  0.0052713  3707.41   &lt;2e-16 ***
ORIGIN_SZBTSZ01   20.0198045  0.0058541  3419.77   &lt;2e-16 ***
ORIGIN_SZBTSZ02   19.3618525  0.0081472  2376.51   &lt;2e-16 ***
ORIGIN_SZBTSZ03   19.5883853  0.0068935  2841.59   &lt;2e-16 ***
ORIGIN_SZBTSZ04   18.7720238  0.0103909  1806.58   &lt;2e-16 ***
ORIGIN_SZBTSZ05   18.8069026  0.0120628  1559.08   &lt;2e-16 ***
ORIGIN_SZBTSZ06   18.7068633  0.0094575  1978.00   &lt;2e-16 ***
ORIGIN_SZBTSZ07   17.6292257  0.0141551  1245.43   &lt;2e-16 ***
ORIGIN_SZBTSZ08   18.6989374  0.0109610  1705.94   &lt;2e-16 ***
ORIGIN_SZCBSZ01   18.2189868  0.0548317   332.27   &lt;2e-16 ***
ORIGIN_SZCCSZ01   18.9734563  0.0139450  1360.59   &lt;2e-16 ***
ORIGIN_SZCHSZ01   19.5955119  0.0121035  1619.00   &lt;2e-16 ***
ORIGIN_SZCHSZ02   19.3320960  0.0081620  2368.55   &lt;2e-16 ***
ORIGIN_SZCHSZ03   21.2164518  0.0063552  3338.43   &lt;2e-16 ***
ORIGIN_SZCKSZ01   20.1046845  0.0049333  4075.29   &lt;2e-16 ***
ORIGIN_SZCKSZ02   20.5371946  0.0050256  4086.53   &lt;2e-16 ***
ORIGIN_SZCKSZ03   20.7210560  0.0042184  4912.07   &lt;2e-16 ***
ORIGIN_SZCKSZ04   21.4013886  0.0042524  5032.80   &lt;2e-16 ***
ORIGIN_SZCKSZ05   20.9413146  0.0049434  4236.18   &lt;2e-16 ***
ORIGIN_SZCKSZ06   20.2557727  0.0071832  2819.88   &lt;2e-16 ***
ORIGIN_SZCLSZ01   19.3383703  0.0076634  2523.46   &lt;2e-16 ***
ORIGIN_SZCLSZ02   18.5226956  0.0135522  1366.77   &lt;2e-16 ***
ORIGIN_SZCLSZ03   19.0225512  0.0080145  2373.51   &lt;2e-16 ***
ORIGIN_SZCLSZ04   20.7981505  0.0042400  4905.22   &lt;2e-16 ***
ORIGIN_SZCLSZ05   18.3015625  0.0146815  1246.58   &lt;2e-16 ***
ORIGIN_SZCLSZ06   20.8207386  0.0039567  5262.09   &lt;2e-16 ***
ORIGIN_SZCLSZ07   19.6728958  0.0054199  3629.76   &lt;2e-16 ***
ORIGIN_SZCLSZ08   20.0851929  0.0056956  3526.43   &lt;2e-16 ***
ORIGIN_SZCLSZ09   18.5749589  0.0165415  1122.93   &lt;2e-16 ***
ORIGIN_SZDTSZ02   15.8276209  0.0833992   189.78   &lt;2e-16 ***
ORIGIN_SZDTSZ03   16.2512838  0.0737972   220.22   &lt;2e-16 ***
ORIGIN_SZDTSZ13   16.7744385  0.0312450   536.87   &lt;2e-16 ***
ORIGIN_SZGLSZ01   18.2368248  0.0096104  1897.62   &lt;2e-16 ***
ORIGIN_SZGLSZ02   19.8705255  0.0049014  4054.06   &lt;2e-16 ***
ORIGIN_SZGLSZ03   19.8249435  0.0053109  3732.85   &lt;2e-16 ***
ORIGIN_SZGLSZ04   20.7800335  0.0041261  5036.20   &lt;2e-16 ***
ORIGIN_SZGLSZ05   20.6040494  0.0043049  4786.23   &lt;2e-16 ***
ORIGIN_SZHGSZ01   20.0273475  0.0044824  4468.04   &lt;2e-16 ***
ORIGIN_SZHGSZ02   20.2480656  0.0044575  4542.47   &lt;2e-16 ***
ORIGIN_SZHGSZ03   20.0756442  0.0049003  4096.81   &lt;2e-16 ***
ORIGIN_SZHGSZ04   20.7577748  0.0040465  5129.84   &lt;2e-16 ***
ORIGIN_SZHGSZ05   20.9779992  0.0040123  5228.42   &lt;2e-16 ***
ORIGIN_SZHGSZ06   19.7403058  0.0054229  3640.20   &lt;2e-16 ***
ORIGIN_SZHGSZ07   20.1896268  0.0046051  4384.22   &lt;2e-16 ***
ORIGIN_SZHGSZ08   19.8646492  0.0052403  3790.72   &lt;2e-16 ***
ORIGIN_SZHGSZ09   18.3647736  0.0069196  2654.04   &lt;2e-16 ***
ORIGIN_SZHGSZ10   16.8720475  0.0421046   400.72   &lt;2e-16 ***
ORIGIN_SZJESZ01   20.2673794  0.0046723  4337.79   &lt;2e-16 ***
ORIGIN_SZJESZ02   20.0595982  0.0046503  4313.61   &lt;2e-16 ***
ORIGIN_SZJESZ03   19.9128778  0.0049848  3994.75   &lt;2e-16 ***
ORIGIN_SZJESZ04   18.5053667  0.0099227  1864.94   &lt;2e-16 ***
ORIGIN_SZJESZ05   17.8172930  0.0138840  1283.29   &lt;2e-16 ***
ORIGIN_SZJESZ06   20.0124157  0.0045009  4446.36   &lt;2e-16 ***
ORIGIN_SZJESZ07   18.1821423  0.0117267  1550.49   &lt;2e-16 ***
ORIGIN_SZJESZ08   18.8713046  0.0116456  1620.46   &lt;2e-16 ***
ORIGIN_SZJESZ09   20.5535527  0.0048456  4241.72   &lt;2e-16 ***
ORIGIN_SZJESZ10   18.4922322  0.0191243   966.95   &lt;2e-16 ***
ORIGIN_SZJESZ11   18.2891211  0.0197114   927.85   &lt;2e-16 ***
ORIGIN_SZJWSZ01   20.4912737  0.0063102  3247.35   &lt;2e-16 ***
ORIGIN_SZJWSZ02   20.8236694  0.0042249  4928.82   &lt;2e-16 ***
ORIGIN_SZJWSZ03   21.2587613  0.0039733  5350.40   &lt;2e-16 ***
ORIGIN_SZJWSZ04   20.3816464  0.0046199  4411.67   &lt;2e-16 ***
ORIGIN_SZJWSZ05   18.0607448  0.0128857  1401.61   &lt;2e-16 ***
ORIGIN_SZJWSZ06   18.7015202  0.0107614  1737.83   &lt;2e-16 ***
ORIGIN_SZJWSZ07   17.3991822  0.0277096   627.91   &lt;2e-16 ***
ORIGIN_SZJWSZ08   21.8044465  0.0037356  5836.95   &lt;2e-16 ***
ORIGIN_SZJWSZ09   21.5414930  0.0036033  5978.19   &lt;2e-16 ***
ORIGIN_SZKLSZ01   20.0307712  0.0047868  4184.59   &lt;2e-16 ***
ORIGIN_SZKLSZ02   19.0634769  0.0062318  3059.05   &lt;2e-16 ***
ORIGIN_SZKLSZ03   19.2685700  0.0057172  3370.25   &lt;2e-16 ***
ORIGIN_SZKLSZ04   17.7085067  0.0119809  1478.06   &lt;2e-16 ***
ORIGIN_SZKLSZ05   18.6384471  0.0107596  1732.26   &lt;2e-16 ***
ORIGIN_SZKLSZ06   13.7280296  0.1857160    73.92   &lt;2e-16 ***
ORIGIN_SZKLSZ07   18.6425146  0.0084952  2194.47   &lt;2e-16 ***
ORIGIN_SZKLSZ08   18.0928506  0.0101567  1781.37   &lt;2e-16 ***
ORIGIN_SZLKSZ01   17.8907138  0.0397083   450.55   &lt;2e-16 ***
ORIGIN_SZMDSZ01   18.7605188  0.0285455   657.22   &lt;2e-16 ***
ORIGIN_SZMDSZ02   19.1533927  0.0102815  1862.90   &lt;2e-16 ***
ORIGIN_SZMDSZ03   17.8404982  0.0169690  1051.36   &lt;2e-16 ***
ORIGIN_SZMPSZ01   19.0765941  0.0083937  2272.74   &lt;2e-16 ***
ORIGIN_SZMPSZ02   19.2162527  0.0068331  2812.24   &lt;2e-16 ***
ORIGIN_SZMPSZ03   19.9965344  0.0054569  3664.44   &lt;2e-16 ***
ORIGIN_SZMUSZ02   15.9130765  0.1037472   153.38   &lt;2e-16 ***
ORIGIN_SZNTSZ01   17.0840999  0.0352513   484.64   &lt;2e-16 ***
ORIGIN_SZNTSZ02   16.5792122  0.0233186   710.99   &lt;2e-16 ***
ORIGIN_SZNTSZ03   18.9506415  0.0075957  2494.93   &lt;2e-16 ***
ORIGIN_SZNTSZ05   15.8770261  0.0495825   320.21   &lt;2e-16 ***
ORIGIN_SZNTSZ06   15.3997415  0.0557029   276.46   &lt;2e-16 ***
ORIGIN_SZNVSZ01   20.2241694  0.0043487  4650.65   &lt;2e-16 ***
ORIGIN_SZNVSZ02   19.1897826  0.0065383  2934.97   &lt;2e-16 ***
ORIGIN_SZNVSZ03   18.8854268  0.0080459  2347.22   &lt;2e-16 ***
ORIGIN_SZNVSZ04   18.8940191  0.0090985  2076.61   &lt;2e-16 ***
ORIGIN_SZNVSZ05   17.6278585  0.0168107  1048.61   &lt;2e-16 ***
ORIGIN_SZPGSZ01   19.4825220  0.0122960  1584.46   &lt;2e-16 ***
ORIGIN_SZPGSZ02   19.4726761  0.0073116  2663.25   &lt;2e-16 ***
ORIGIN_SZPGSZ03   20.5515713  0.0045631  4503.86   &lt;2e-16 ***
ORIGIN_SZPGSZ04   21.0527131  0.0041500  5072.89   &lt;2e-16 ***
ORIGIN_SZPGSZ05   20.1436604  0.0057267  3517.48   &lt;2e-16 ***
ORIGIN_SZPLSZ01   19.1832002  0.0120006  1598.53   &lt;2e-16 ***
ORIGIN_SZPLSZ02   18.8752206  0.0149740  1260.53   &lt;2e-16 ***
ORIGIN_SZPLSZ03   18.1000818  0.0371769   486.86   &lt;2e-16 ***
ORIGIN_SZPLSZ04   17.1730559  0.0370280   463.79   &lt;2e-16 ***
ORIGIN_SZPLSZ05   17.9084439  0.0225031   795.82   &lt;2e-16 ***
ORIGIN_SZPNSZ01   21.0804425  0.0044829  4702.41   &lt;2e-16 ***
ORIGIN_SZPNSZ02   19.8822123  0.0111507  1783.05   &lt;2e-16 ***
ORIGIN_SZPNSZ03   17.9293289  0.0193571   926.24   &lt;2e-16 ***
ORIGIN_SZPNSZ04   17.1039594  0.0334954   510.64   &lt;2e-16 ***
ORIGIN_SZPNSZ05   18.2543864  0.0275554   662.46   &lt;2e-16 ***
ORIGIN_SZPRSZ01   19.8777935  0.0117586  1690.49   &lt;2e-16 ***
ORIGIN_SZPRSZ02   21.0751780  0.0044832  4700.88   &lt;2e-16 ***
ORIGIN_SZPRSZ03   20.6717019  0.0045577  4535.55   &lt;2e-16 ***
ORIGIN_SZPRSZ04   19.6365125  0.0074923  2620.90   &lt;2e-16 ***
ORIGIN_SZPRSZ05   21.3132151  0.0042119  5060.24   &lt;2e-16 ***
ORIGIN_SZPRSZ06   18.9314574  0.0117278  1614.24   &lt;2e-16 ***
ORIGIN_SZPRSZ07   17.2822918  0.0162430  1063.98   &lt;2e-16 ***
ORIGIN_SZPRSZ08   19.9267642  0.0062298  3198.62   &lt;2e-16 ***
ORIGIN_SZQTSZ01   19.7357175  0.0066359  2974.08   &lt;2e-16 ***
ORIGIN_SZQTSZ02   19.2082141  0.0061402  3128.26   &lt;2e-16 ***
ORIGIN_SZQTSZ03   19.7771883  0.0056220  3517.83   &lt;2e-16 ***
ORIGIN_SZQTSZ04   18.7114421  0.0072842  2568.76   &lt;2e-16 ***
ORIGIN_SZQTSZ05   19.3049324  0.0062401  3093.69   &lt;2e-16 ***
ORIGIN_SZQTSZ06   19.2643228  0.0065590  2937.09   &lt;2e-16 ***
ORIGIN_SZQTSZ07   18.5697347  0.0095373  1947.06   &lt;2e-16 ***
ORIGIN_SZQTSZ08   19.6147001  0.0061330  3198.21   &lt;2e-16 ***
ORIGIN_SZQTSZ09   19.2550793  0.0069947  2752.82   &lt;2e-16 ***
ORIGIN_SZQTSZ10   19.5801866  0.0064513  3035.07   &lt;2e-16 ***
ORIGIN_SZQTSZ11   17.7398366  0.0143648  1234.95   &lt;2e-16 ***
ORIGIN_SZQTSZ12   17.2420354  0.0186736   923.34   &lt;2e-16 ***
ORIGIN_SZQTSZ13   19.3857418  0.0078878  2457.69   &lt;2e-16 ***
ORIGIN_SZQTSZ14   18.1300753  0.0122096  1484.90   &lt;2e-16 ***
ORIGIN_SZQTSZ15   19.4222283  0.0120871  1606.86   &lt;2e-16 ***
ORIGIN_SZRCSZ01   18.1549045  0.0125108  1451.13   &lt;2e-16 ***
ORIGIN_SZRCSZ06   18.8836400  0.0082161  2298.38   &lt;2e-16 ***
ORIGIN_SZRVSZ01   16.7864438  0.0323796   518.43   &lt;2e-16 ***
ORIGIN_SZRVSZ02   16.4203244  0.0276836   593.14   &lt;2e-16 ***
ORIGIN_SZRVSZ03   16.6453738  0.0244992   679.42   &lt;2e-16 ***
ORIGIN_SZRVSZ04   15.9559213  0.0556344   286.80   &lt;2e-16 ***
ORIGIN_SZRVSZ05   17.0476331  0.0164122  1038.71   &lt;2e-16 ***
ORIGIN_SZSBSZ01   20.0417968  0.0062488  3207.29   &lt;2e-16 ***
ORIGIN_SZSBSZ02   19.1869565  0.0081051  2367.26   &lt;2e-16 ***
ORIGIN_SZSBSZ03   20.5769861  0.0045108  4561.70   &lt;2e-16 ***
ORIGIN_SZSBSZ04   20.5154199  0.0050548  4058.57   &lt;2e-16 ***
ORIGIN_SZSBSZ05   19.6250669  0.0065562  2993.35   &lt;2e-16 ***
ORIGIN_SZSBSZ06   18.8419757  0.0171135  1101.00   &lt;2e-16 ***
ORIGIN_SZSBSZ07   19.4897259  0.0124528  1565.09   &lt;2e-16 ***
ORIGIN_SZSBSZ08   18.7027917  0.0140545  1330.73   &lt;2e-16 ***
ORIGIN_SZSBSZ09   18.8893480  0.0088571  2132.67   &lt;2e-16 ***
ORIGIN_SZSESZ02   20.8962192  0.0041665  5015.34   &lt;2e-16 ***
ORIGIN_SZSESZ03   20.9452771  0.0039737  5270.94   &lt;2e-16 ***
ORIGIN_SZSESZ04   20.6576142  0.0046364  4455.55   &lt;2e-16 ***
ORIGIN_SZSESZ05   19.5170732  0.0058912  3312.92   &lt;2e-16 ***
ORIGIN_SZSESZ06   20.7595824  0.0045747  4537.89   &lt;2e-16 ***
ORIGIN_SZSESZ07   17.6888256  0.0195787   903.47   &lt;2e-16 ***
ORIGIN_SZSGSZ01   19.1359250  0.0085781  2230.79   &lt;2e-16 ***
ORIGIN_SZSGSZ02   18.5614369  0.0102037  1819.10   &lt;2e-16 ***
ORIGIN_SZSGSZ03   19.9933176  0.0050434  3964.23   &lt;2e-16 ***
ORIGIN_SZSGSZ04   20.2426871  0.0047211  4287.71   &lt;2e-16 ***
ORIGIN_SZSGSZ05   18.0114965  0.0107743  1671.70   &lt;2e-16 ***
ORIGIN_SZSGSZ06   20.2593194  0.0044538  4548.76   &lt;2e-16 ***
ORIGIN_SZSGSZ07   19.0763664  0.0062968  3029.54   &lt;2e-16 ***
ORIGIN_SZSKSZ01   19.9222451  0.0085136  2340.04   &lt;2e-16 ***
ORIGIN_SZSKSZ02   20.8633383  0.0055248  3776.33   &lt;2e-16 ***
ORIGIN_SZSKSZ03   19.6528148  0.0080534  2440.33   &lt;2e-16 ***
ORIGIN_SZSKSZ04   18.0754470  0.0275771   655.45   &lt;2e-16 ***
ORIGIN_SZSKSZ05   19.1192521  0.0155579  1228.91   &lt;2e-16 ***
ORIGIN_SZSLSZ01   17.1501034  0.0329384   520.67   &lt;2e-16 ***
ORIGIN_SZSLSZ04   19.5949774  0.0076753  2552.98   &lt;2e-16 ***
ORIGIN_SZSRSZ01   16.9761403  0.0162020  1047.78   &lt;2e-16 ***
ORIGIN_SZTHSZ01   17.9695687  0.0488559   367.81   &lt;2e-16 ***
ORIGIN_SZTHSZ03   18.5427522  0.0223617   829.22   &lt;2e-16 ***
ORIGIN_SZTHSZ04   17.4760374  0.0286247   610.52   &lt;2e-16 ***
ORIGIN_SZTHSZ06   17.8401186  0.0183322   973.16   &lt;2e-16 ***
ORIGIN_SZTMSZ01   20.3406361  0.0056607  3593.33   &lt;2e-16 ***
ORIGIN_SZTMSZ02   22.0307026  0.0037386  5892.85   &lt;2e-16 ***
ORIGIN_SZTMSZ03   21.3451920  0.0040606  5256.65   &lt;2e-16 ***
ORIGIN_SZTMSZ04   20.6611593  0.0049896  4140.87   &lt;2e-16 ***
ORIGIN_SZTMSZ05   19.3323133  0.0112868  1712.82   &lt;2e-16 ***
ORIGIN_SZTNSZ01   17.9513571  0.0128266  1399.54   &lt;2e-16 ***
ORIGIN_SZTNSZ02   18.0267387  0.0098372  1832.51   &lt;2e-16 ***
ORIGIN_SZTNSZ03   17.7253700  0.0134668  1316.23   &lt;2e-16 ***
ORIGIN_SZTNSZ04   19.4474075  0.0073760  2636.59   &lt;2e-16 ***
ORIGIN_SZTPSZ01   19.1078631  0.0065635  2911.25   &lt;2e-16 ***
ORIGIN_SZTPSZ02   20.2837634  0.0041411  4898.18   &lt;2e-16 ***
ORIGIN_SZTPSZ03   19.1838238  0.0059552  3221.37   &lt;2e-16 ***
ORIGIN_SZTPSZ04   19.1805388  0.0054778  3501.53   &lt;2e-16 ***
ORIGIN_SZTPSZ05   19.3718076  0.0058610  3305.18   &lt;2e-16 ***
ORIGIN_SZTPSZ06   19.6605723  0.0054968  3576.70   &lt;2e-16 ***
ORIGIN_SZTPSZ07   19.4499807  0.0060491  3215.36   &lt;2e-16 ***
ORIGIN_SZTPSZ08   18.7996538  0.0095757  1963.28   &lt;2e-16 ***
ORIGIN_SZTPSZ09   19.0025110  0.0067068  2833.31   &lt;2e-16 ***
ORIGIN_SZTPSZ10   18.8899657  0.0076094  2482.46   &lt;2e-16 ***
ORIGIN_SZTPSZ11   19.6277780  0.0053983  3635.93   &lt;2e-16 ***
ORIGIN_SZTPSZ12   19.1471104  0.0065742  2912.45   &lt;2e-16 ***
ORIGIN_SZTSSZ01   17.4901113  0.0478954   365.17   &lt;2e-16 ***
ORIGIN_SZTSSZ02   20.4997466  0.0081850  2504.55   &lt;2e-16 ***
ORIGIN_SZTSSZ03   20.1076553  0.0084728  2373.19   &lt;2e-16 ***
ORIGIN_SZTSSZ04   20.0646610  0.0089008  2254.26   &lt;2e-16 ***
ORIGIN_SZTSSZ05   19.3962067  0.0151392  1281.19   &lt;2e-16 ***
ORIGIN_SZTSSZ06   20.9235857  0.0178278  1173.65   &lt;2e-16 ***
ORIGIN_SZWCSZ01   20.8411600  0.0086519  2408.86   &lt;2e-16 ***
ORIGIN_SZWCSZ02   17.7355404  0.0328889   539.26   &lt;2e-16 ***
ORIGIN_SZWCSZ03   14.9380886  0.1240699   120.40   &lt;2e-16 ***
ORIGIN_SZWDSZ01   21.1969012  0.0037830  5603.23   &lt;2e-16 ***
ORIGIN_SZWDSZ02   20.5930001  0.0044572  4620.13   &lt;2e-16 ***
ORIGIN_SZWDSZ03   21.2521867  0.0041672  5099.85   &lt;2e-16 ***
ORIGIN_SZWDSZ04   21.0702687  0.0048648  4331.13   &lt;2e-16 ***
ORIGIN_SZWDSZ05   20.4008998  0.0051801  3938.35   &lt;2e-16 ***
ORIGIN_SZWDSZ06   20.6669176  0.0049280  4193.78   &lt;2e-16 ***
ORIGIN_SZWDSZ07   19.0500370  0.0082729  2302.71   &lt;2e-16 ***
ORIGIN_SZWDSZ08   19.0816252  0.0080667  2365.49   &lt;2e-16 ***
ORIGIN_SZWDSZ09   21.4182096  0.0040391  5302.73   &lt;2e-16 ***
ORIGIN_SZYSSZ01   19.5355157  0.0057540  3395.14   &lt;2e-16 ***
ORIGIN_SZYSSZ02   20.8737972  0.0048278  4323.64   &lt;2e-16 ***
ORIGIN_SZYSSZ03   21.6614437  0.0040011  5413.81   &lt;2e-16 ***
ORIGIN_SZYSSZ04   20.9305289  0.0043595  4801.10   &lt;2e-16 ***
ORIGIN_SZYSSZ05   20.1727678  0.0058466  3450.34   &lt;2e-16 ***
ORIGIN_SZYSSZ06   19.1481507  0.0116724  1640.47   &lt;2e-16 ***
ORIGIN_SZYSSZ07   18.7919074  0.0141636  1326.78   &lt;2e-16 ***
ORIGIN_SZYSSZ08   19.9733515  0.0061229  3262.07   &lt;2e-16 ***
ORIGIN_SZYSSZ09   20.9366181  0.0040347  5189.15   &lt;2e-16 ***
log(SCHOOL_COUNT)  0.4755516  0.0004701  1011.55   &lt;2e-16 ***
log(RETAIL_COUNT)  0.1796905  0.0001856   968.12   &lt;2e-16 ***
log(DIST)         -1.6929522  0.0004093 -4136.01   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 189463537  on 14471  degrees of freedom
Residual deviance:  15526121  on 14189  degrees of freedom
AIC: 15615824

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Confirm that perceived attractive forces are <strong>positive</strong></p>
<p>Distance is always negative as the farther the distance, the less attractive it is</p>
<section id="goodness-of-fit" class="level2">
<h2 class="anchored" data-anchor-id="goodness-of-fit">Goodness of Fit</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>CalcRSquared <span class="ot">&lt;-</span> <span class="cf">function</span>(observed, estimated) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed, estimated)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  R2</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(orcSIM_Poisson<span class="sc">$</span>data<span class="sc">$</span>TRIPS, orcSIM_Poisson<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4362208</code></pre>
</div>
</div>
<p>This is a reasonable number but can be improved.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance_rmse</span>(orcSIM_Poisson, <span class="at">normalized =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2613.236</code></pre>
</div>
</div>
<p>The smaller, the better.</p>
</section>
</section>
<section id="doubly-constrained" class="level1">
<h1>Doubly constrained</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dbcSIM_Poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                        ORIGIN_SZ <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                        DEST_SZ <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(DIST),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">na.action =</span> na.exclude</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dbcSIM_Poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>