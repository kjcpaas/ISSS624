<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kristine Joy Paas">
<meta name="dcterms.date" content="2023-12-06">

<title>ISSS624 - Take Home Exercise 2: A Case Study of Singapore Public Bus Commuter Flows</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ISSS624</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex1/Hands-on_Ex1A.html" rel="" target="">
 <span class="dropdown-text">1A: Data Wrangling with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex1/Hands-on_Ex1B.html" rel="" target="">
 <span class="dropdown-text">1B: Choropleth Mapping with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex2/Hands-on_Ex2A.html" rel="" target="">
 <span class="dropdown-text">2A: Spatial Weights and Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex2/Hands-on_Ex2B.html" rel="" target="">
 <span class="dropdown-text">2B: Global Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex2/Hands-on_Ex2C.html" rel="" target="">
 <span class="dropdown-text">2C: Local Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex3/Hands-on_Ex3.html" rel="" target="">
 <span class="dropdown-text">3: Processing and Visualizing Flow Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../In-class_Ex1/In-class_Ex1.html" rel="" target="">
 <span class="dropdown-text">1: Bus Commuter Flow by Origin</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex2/In-class_Ex2A.html" rel="" target="">
 <span class="dropdown-text">2A: Spatial Weights with sfdep</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex2/In-class_Ex2B.html" rel="" target="">
 <span class="dropdown-text">2B: GLSA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex2/In-class_Ex2C.html" rel="" target="">
 <span class="dropdown-text">2C: EHSA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex3/In-class_Ex3.html" rel="" target="">
 <span class="dropdown-text">3: Calibrating Spatial Interactions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex4/In-class_Ex4A.html" rel="" target="">
 <span class="dropdown-text">4A: Geocoding</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex4/In-class_Ex4B.html" rel="" target="">
 <span class="dropdown-text">4B: SIM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex5/In-class_Ex5.html" rel="" target="">
 <span class="dropdown-text">5: Spatial Economic Interaction Models</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../Take-home_Ex1/Take-home_Ex1.html" rel="" target="">
 <span class="dropdown-text">1: Geospatial Analytics for Public Good</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Take-home_Ex2/Take-home_Ex2.html" rel="" target="">
 <span class="dropdown-text">2: Applied Spatial Interaction Models</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul>
  <li><a href="#the-analysis" id="toc-the-analysis" class="nav-link" data-scroll-target="#the-analysis">The Analysis</a></li>
  <li><a href="#data-outputs" id="toc-data-outputs" class="nav-link" data-scroll-target="#data-outputs">Data Outputs</a></li>
  <li><a href="#managing-our-data" id="toc-managing-our-data" class="nav-link" data-scroll-target="#managing-our-data">Managing our data</a></li>
  </ul></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data Wrangling</a>
  <ul>
  <li><a href="#utility-1" id="toc-utility-1" class="nav-link" data-scroll-target="#utility-1">Utility</a>
  <ul>
  <li><a href="#importing-the-datasets" id="toc-importing-the-datasets" class="nav-link" data-scroll-target="#importing-the-datasets">Importing the datasets</a></li>
  <li><a href="#generating-the-honeycomb-grid" id="toc-generating-the-honeycomb-grid" class="nav-link" data-scroll-target="#generating-the-honeycomb-grid">Generating the honeycomb grid</a></li>
  <li><a href="#assigning-id-to-each-hexagon" id="toc-assigning-id-to-each-hexagon" class="nav-link" data-scroll-target="#assigning-id-to-each-hexagon">Assigning id to each hexagon</a></li>
  </ul></li>
  <li><a href="#spatial-interaction-analysis-2" id="toc-spatial-interaction-analysis-2" class="nav-link" data-scroll-target="#spatial-interaction-analysis-2">Spatial Interaction Analysis</a>
  <ul>
  <li><a href="#importing-the-datasets-1" id="toc-importing-the-datasets-1" class="nav-link" data-scroll-target="#importing-the-datasets-1">Importing the datasets</a></li>
  <li><a href="#generating-the-o-d-trip-data-by-hexagon-level" id="toc-generating-the-o-d-trip-data-by-hexagon-level" class="nav-link" data-scroll-target="#generating-the-o-d-trip-data-by-hexagon-level">Generating the O-D trip data by hexagon level</a>
  <ul class="collapse">
  <li><a href="#filtering-the-relevant-data" id="toc-filtering-the-relevant-data" class="nav-link" data-scroll-target="#filtering-the-relevant-data">Filtering the relevant data</a></li>
  <li><a href="#generating-lookup-table-for-bus-stop-to-associated-hexagon" id="toc-generating-lookup-table-for-bus-stop-to-associated-hexagon" class="nav-link" data-scroll-target="#generating-lookup-table-for-bus-stop-to-associated-hexagon">Generating lookup table for bus stop to associated hexagon</a></li>
  <li><a href="#joining-od_trips-and-bs_hex" id="toc-joining-od_trips-and-bs_hex" class="nav-link" data-scroll-target="#joining-od_trips-and-bs_hex">Joining <em>od_trips</em> and <em>bs_hex</em></a></li>
  <li><a href="#aggregating-data-by-hexagon" id="toc-aggregating-data-by-hexagon" class="nav-link" data-scroll-target="#aggregating-data-by-hexagon">Aggregating data by hexagon</a></li>
  </ul></li>
  <li><a href="#generating-the-flow-lines" id="toc-generating-the-flow-lines" class="nav-link" data-scroll-target="#generating-the-flow-lines">Generating the flow lines</a>
  <ul class="collapse">
  <li><a href="#initial-inspection-of-the-flow-lines" id="toc-initial-inspection-of-the-flow-lines" class="nav-link" data-scroll-target="#initial-inspection-of-the-flow-lines">Initial inspection of the flow lines</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#spatial-interaction-modelling-2" id="toc-spatial-interaction-modelling-2" class="nav-link" data-scroll-target="#spatial-interaction-modelling-2">Spatial Interaction Modelling</a>
  <ul>
  <li><a href="#attractiveness-variables" id="toc-attractiveness-variables" class="nav-link" data-scroll-target="#attractiveness-variables">Attractiveness variables</a></li>
  <li><a href="#deriving-passengers-alighting-from-bus-stop" id="toc-deriving-passengers-alighting-from-bus-stop" class="nav-link" data-scroll-target="#deriving-passengers-alighting-from-bus-stop">Deriving Passengers Alighting from Bus Stop</a></li>
  <li><a href="#deriving-train-passenger-data" id="toc-deriving-train-passenger-data" class="nav-link" data-scroll-target="#deriving-train-passenger-data">Deriving Train Passenger Data</a>
  <ul class="collapse">
  <li><a href="#importing-data-sets" id="toc-importing-data-sets" class="nav-link" data-scroll-target="#importing-data-sets">Importing data sets</a></li>
  <li><a href="#adjusting-data-columns" id="toc-adjusting-data-columns" class="nav-link" data-scroll-target="#adjusting-data-columns">Adjusting data columns</a></li>
  <li><a href="#adding-tap-out-information-to-exits" id="toc-adding-tap-out-information-to-exits" class="nav-link" data-scroll-target="#adding-tap-out-information-to-exits">Adding tap out information to exits</a></li>
  <li><a href="#aggregating-trips-by-hexagon-level" id="toc-aggregating-trips-by-hexagon-level" class="nav-link" data-scroll-target="#aggregating-trips-by-hexagon-level">Aggregating TRIPS by Hexagon level</a></li>
  </ul></li>
  <li><a href="#deriving-hdb-population" id="toc-deriving-hdb-population" class="nav-link" data-scroll-target="#deriving-hdb-population">Deriving HDB population</a>
  <ul class="collapse">
  <li><a href="#importing-the-data" id="toc-importing-the-data" class="nav-link" data-scroll-target="#importing-the-data">Importing the data</a></li>
  <li><a href="#adding-hdb_count" id="toc-adding-hdb_count" class="nav-link" data-scroll-target="#adding-hdb_count">Adding <em>HDB_COUNT</em></a></li>
  <li><a href="#removing-unnecessary-data" id="toc-removing-unnecessary-data" class="nav-link" data-scroll-target="#removing-unnecessary-data">Removing unnecessary data</a></li>
  <li><a href="#adding-hdb_resident_count" id="toc-adding-hdb_resident_count" class="nav-link" data-scroll-target="#adding-hdb_resident_count">Adding <em>HDB_RESIDENT_COUNT</em></a></li>
  </ul></li>
  <li><a href="#propulsiveness-variables" id="toc-propulsiveness-variables" class="nav-link" data-scroll-target="#propulsiveness-variables">Propulsiveness variables</a></li>
  <li><a href="#generating-distance-table" id="toc-generating-distance-table" class="nav-link" data-scroll-target="#generating-distance-table">Generating distance table</a>
  <ul class="collapse">
  <li><a href="#generating-distance-matrix" id="toc-generating-distance-matrix" class="nav-link" data-scroll-target="#generating-distance-matrix">Generating distance matrix</a></li>
  <li><a href="#generating-a-pivot-table" id="toc-generating-a-pivot-table" class="nav-link" data-scroll-target="#generating-a-pivot-table">Generating a pivot table</a></li>
  <li><a href="#setting-intra-zonal-distances" id="toc-setting-intra-zonal-distances" class="nav-link" data-scroll-target="#setting-intra-zonal-distances">Setting intra-zonal distances</a></li>
  </ul></li>
  <li><a href="#putting-everything-together" id="toc-putting-everything-together" class="nav-link" data-scroll-target="#putting-everything-together">Putting everything together</a></li>
  <li><a href="#finishing-touches" id="toc-finishing-touches" class="nav-link" data-scroll-target="#finishing-touches">Finishing touches</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#visualizing-spatial-interactions" id="toc-visualizing-spatial-interactions" class="nav-link" data-scroll-target="#visualizing-spatial-interactions">Visualizing Spatial Interactions</a>
  <ul>
  <li><a href="#visualizing-flow-lines-again" id="toc-visualizing-flow-lines-again" class="nav-link" data-scroll-target="#visualizing-flow-lines-again">Visualizing flow lines again</a></li>
  <li><a href="#sec-plotting-trips-vs-distance" id="toc-sec-plotting-trips-vs-distance" class="nav-link" data-scroll-target="#sec-plotting-trips-vs-distance">Plotting <em>TRIPS</em> vs.&nbsp;<em>DISTANCE</em></a></li>
  <li><a href="#visualizing-propulsive-forces" id="toc-visualizing-propulsive-forces" class="nav-link" data-scroll-target="#visualizing-propulsive-forces">Visualizing propulsive forces</a></li>
  <li><a href="#visualizing-attractive-forces" id="toc-visualizing-attractive-forces" class="nav-link" data-scroll-target="#visualizing-attractive-forces">Visualizing attractive forces</a></li>
  </ul></li>
  <li><a href="#spatial-interaction-modelling-3" id="toc-spatial-interaction-modelling-3" class="nav-link" data-scroll-target="#spatial-interaction-modelling-3">Spatial Interaction Modelling</a>
  <ul>
  <li><a href="#about-the-models" id="toc-about-the-models" class="nav-link" data-scroll-target="#about-the-models">About the models</a></li>
  <li><a href="#generating-the-models" id="toc-generating-the-models" class="nav-link" data-scroll-target="#generating-the-models">Generating the models</a></li>
  <li><a href="#model-comparisons" id="toc-model-comparisons" class="nav-link" data-scroll-target="#model-comparisons">Model Comparisons</a></li>
  <li><a href="#visualizing-the-fit" id="toc-visualizing-the-fit" class="nav-link" data-scroll-target="#visualizing-the-fit">Visualizing the fit</a>
  <ul>
  <li><a href="#extracting-the-fitted-values" id="toc-extracting-the-fitted-values" class="nav-link" data-scroll-target="#extracting-the-fitted-values">Extracting the fitted values</a></li>
  <li><a href="#plotting-the-fit" id="toc-plotting-the-fit" class="nav-link" data-scroll-target="#plotting-the-fit">Plotting the fit</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  <li><a href="#improving-the-models" id="toc-improving-the-models" class="nav-link" data-scroll-target="#improving-the-models">Improving the Models</a>
  <ul>
  <li><a href="#opportunities-for-improvement" id="toc-opportunities-for-improvement" class="nav-link" data-scroll-target="#opportunities-for-improvement">Opportunities for Improvement</a></li>
  <li><a href="#plotting-correlation-matrix" id="toc-plotting-correlation-matrix" class="nav-link" data-scroll-target="#plotting-correlation-matrix">Plotting Correlation Matrix</a>
  <ul>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">Model comparison</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take Home Exercise 2: A Case Study of Singapore Public Bus Commuter Flows</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kristine Joy Paas </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 6, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">December 17, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<p>The aim of this exercise to study the bus commuter flow patterns in Singapore to gain insights that support decision-making.</p>
<p>We will be examining the <strong>weekend morning peak hours</strong> (11 AM - 2 PM) to figure out where people go during weekends and holidays.</p>
<p>We will also be the modelling the spatial interaction between the different locations in Singapore, related to the bus commuter patterns.</p>
<p>Check <a href="https://isss624-ay2023-24nov.netlify.app/take-home_ex02" class="uri">https://isss624-ay2023-24nov.netlify.app/take-home_ex02</a> for the full requirements of this exercise.</p>
<section id="the-analysis" class="level2">
<h2 class="anchored" data-anchor-id="the-analysis">The Analysis</h2>
<p>The analysis has two parts: (1) analyzing the spatial interactions between pairs of zone, (2) modelling the interaction.</p>
<p>We will create a honeycomb grid with hexagons with a distance of <strong>375m</strong> from the center to the midpoint of the edge as the <a href="https://tmg.utoronto.ca/files/Reports/Traffic-Zone-Guidance_March-2021_Final.pdf">traffic analysis zone (TAZ)</a>. These hexagons will serve as the <strong>zones</strong> for our analysis.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Spatial Interaction Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Spatial interaction Modelling</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>We will visualize the interactions by plotting the flow lines corresponding to the number of trips between each pair of zones.</p>
<p>We need the following to start this analysis:</p>
<ul>
<li><p>geometry with the traffic analysis zones</p></li>
<li><p>data about the number of trips between different pairs of zones</p></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>We will generate 4 <em>log</em>-based Poisson regression models:</p>
<ul>
<li><p>origin constrained model</p></li>
<li><p>destination constrained model</p></li>
<li><p>unconstrained model</p></li>
<li><p>doubly constrained model</p></li>
</ul>
<p>We need the following to start this analysis:</p>
<ul>
<li><p>geometry with the traffic analysis zones</p></li>
<li><p>propulsiveness variables, which influence the number of of trips originating from a zone</p></li>
<li><p>attractiveness variables, which influence bus commuters to make a trip a zone</p></li>
<li><p>data about the number of trips between different pairs of zones</p></li>
<li><p>distance between each pair of zone</p></li>
</ul>
<p>We use the different variables to generate formula for each model, which will be explored further in their respective sections.</p>
<p>Once the models are generated, we will also compare the models as to which one best fits our data, using <strong>goodness of fit</strong> test or <span class="math inline">\(R^2\)</span> test.</p>
</div>
</div>
</div>
<p>To perform our modelling, we need to identify the <strong>propulsiveness</strong> and <strong>attractiveness</strong> variables we will use for our model.</p>
<p>As our data will be based on real-world data, <em>Passenger Volume By Origin Destination Bus Stops</em> from <a href="https://datamall.lta.gov.sg/content/datamall/en.html">LTA DataMall</a> via API, we can think of possible factors based on our real-world experience.</p>
<p>As we are interested in the factors that influence <strong>weekend/holiday morning (11 AM - 2PM)</strong> peak period bus commuting patterns, we will consider the following variables.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Attractiveness</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Propulsiveness</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Attractiveness variables are factors that can motivate people to go to their destinations. In our case, these are what <em>motivates people to ride to their destination bus stop</em>.</p>
<table class="table">
<thead>
<tr class="header">
<th>Variable</th>
<th>Data Source</th>
<th>Motivation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>BUS_STOP_COUNT</code></td>
<td><em>Bus Stop Location</em> from <a href="https://datamall.lta.gov.sg/content/dam/datamall/datasets/Geospatial/BusStopLocation.zip">LTA DataMall</a></td>
<td>Transferring to another bus to their end destination</td>
</tr>
<tr class="even">
<td><code>TRAIN_EXITS_COUNT</code></td>
<td><em>Train Station</em> <em>Exit Point</em> from <a href="https://datamall.lta.gov.sg/content/dam/datamall/datasets/Geospatial/TrainStationExit.zip">LTA DataMall</a></td>
<td>Transferring to train to their end destination</td>
</tr>
<tr class="odd">
<td><code>HDB_COUNT</code></td>
<td><code>hdb.csv</code> aspatial data provided on E-learn</td>
<td>To meet up with friends/family</td>
</tr>
<tr class="even">
<td><code>ENTERTN_COUNT</code></td>
<td><code>entertn.shp</code> geospatial data provided on E-learn</td>
<td>For recreation, spending time with friends/family</td>
</tr>
<tr class="odd">
<td><code>F_AND_B_COUNT</code></td>
<td><code>F&amp;B.shp</code> geospatial data provided on E-learn</td>
<td>For spending time with friends/family</td>
</tr>
<tr class="even">
<td><code>LEISURE_COUNT</code></td>
<td><code>Liesure&amp;Recreation.shp</code> geospatial data provided on E-learn</td>
<td>For recreation, spending time with friends/family</td>
</tr>
<tr class="odd">
<td><code>RETAIL_COUNT</code></td>
<td><code>Retails.shp</code> geospatial data provided on E-learn</td>
<td>For errands, shopping, spending time with friends/family</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Propulsiveness variables are factors that influence people to ride the bus from specific zones. This is based on the <strong>number</strong> <strong>of potential passengers</strong> at the origin zones.</p>
<table class="table">
<thead>
<tr class="header">
<th>Variable</th>
<th>Data Source</th>
<th>Motivation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>BUS_ALIGHT_COUNT</code></td>
<td><em>Passenger Volume By Origin Destination Bus Stops</em> from <a href="https://datamall.lta.gov.sg/content/datamall/en.html">LTA DataMall</a> via API</td>
<td>Passengers who alight from a bus stop within can transfer to another bus to reach</td>
</tr>
<tr class="even">
<td><code>TRAIN_ALIGHT_COUNT</code></td>
<td><em>Passenger Volume By Train Stations</em> from <a href="https://datamall.lta.gov.sg/content/datamall/en.html">LTA DataMall</a> via API</td>
<td>Passengers who alight from a train station can transfer to a bus to reach their final destination</td>
</tr>
<tr class="odd">
<td><code>HDB_RESIDENT_COUNT</code></td>
<td><code>hdb.csv</code> aspatial data provided on E-learn</td>
<td>Residents in an area are potential bus passengers as they leave their homes</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="data-outputs" class="level2">
<h2 class="anchored" data-anchor-id="data-outputs">Data Outputs</h2>
<p>To accomplish our analysis, we need to prepare the data with the following specifications.</p>
<p>For all our geospatial data, we will use the <a href="https://app.sla.gov.sg/sirent/About/PlaneCoordinateSystem"><strong>SVY21</strong></a> projection it is appropriate for the Singapore context. Also, having a consistent projection will make it straightforward to use the functions from <code>sfdep</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Utility</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Spatial Interaction Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Spatial Interaction Modelling</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Singapore Boundary geometry (<em>mpsz)</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Sourced from <code>MPSZ-2019</code> geospatial data from E-learn, this will provide the Singapore boundary geometry for visualization purposes.</p>
<p>We will be using <code>tmap_mode("plot")</code> instead of <code>tmap_mode("view")</code> to make the code run more efficiently with less memory requirements.</p>
<p><strong>Prerequisites:</strong> None</p>
<p><strong>Output data:</strong> <code>mpsz</code> (geospatial)</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Honeycomb grid corresponding to bus stop locations (<em>honeycomb)</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Sourced from the <code>shp</code> <a href="https://datamall.lta.gov.sg/content/datamall/en/static-data.html#:~:text=drop%20off%20passengers.-,203%20kB,-Last%20Update%3A%C2%A0Jul"><em>Bus Stop Locations</em></a> dataset from LTA DataMall. This consist of hexagons with a distance of <strong>375m</strong> from the center to the midpoint of the edge as the <a href="https://tmg.utoronto.ca/files/Reports/Traffic-Zone-Guidance_March-2021_Final.pdf">traffic analysis zone (TAZ)</a>.</p>
<p>We only consider the bus stops within Singapore so we have to ensure that the bus stops included here are within the <em>Singapore Boundary geometry (mpsz)</em>.</p>
<p><strong>Prerequisites:</strong> <em>Singapore Boundary geometry (mpsz)</em></p>
<p><strong>Output data:</strong> <code>honeycomb</code> (geospatial)</p>
<p><strong>Columns:</strong></p>
<ul>
<li><code>HEX_ID</code>: Unique ID used to associate the zone with other data frames</li>
<li>Geometry of the hexagons corresponding to the traffic analysis zone</li>
</ul>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Number of trips between 2 zones (<em>od_hex</em>)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This contains the number of trips on <strong>weekend/holiday morning peak periods</strong> (11 AM - 2 PM). Data is sourced from <em>Passenger Volume By Origin Destination Bus Stops</em> from <a href="https://datamall.lta.gov.sg/content/datamall/en.html">LTA DataMall</a> via API</p>
<p>This data will be used generating the flow lines for visualization, and for Spatial Interaction Modelling.</p>
<p><strong>Prerequisites:</strong> <em>Honeycomb grid corresponding to bus stop locations (honeycomb)</em></p>
<p><strong>Output data:</strong> <code>od_hex</code> (geospatial)</p>
<p><strong>Columns</strong>:</p>
<ul>
<li><code>ORIG_HEX_ID</code>: ID corresponding to the origin zone</li>
<li><code>DEST_HEX_ID</code>: ID corresponding to the destination zone</li>
<li><code>TRIPS</code>: Number of bus trips between the origin and destination zones</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Flow Lines (<em>flowlines</em>)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This contains the flow lines derived from the pairs of zones in [Number of trips between 2 zones (od_hex)]. It will be used to visualize the flow patterns.</p>
<p><strong>Prerequisites:</strong> <em>Number of trips between 2 zones (od_hex)</em></p>
<p><strong>Output data:</strong> <code>flowlines</code></p>
<p><strong>Columns</strong>:</p>
<ul>
<li><code>ORIG_HEX_ID</code>: ID corresponding to the origin zone</li>
<li><code>DEST_HEX_ID</code>: ID corresponding to the destination zone</li>
<li><code>TRIPS</code>: Number of bus trips between the origin and destination zones</li>
<li>Geometry of the line between the origin and destination zones</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Attractiveness Variables Table (<em>attractiveness</em>)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This table contains the values of the <a href="#attractiveness">Attractiveness</a> variables. Data sources are defined in the <a href="#attractiveness">Attractiveness</a> section. We will also use this data to plot the attractive forces for visualizing spatial interactions.</p>
<p><strong>Prerequisites:</strong> <em>Honeycomb grid corresponding to bus stop locations (honeycomb)</em>, prepared data from identified data sources</p>
<p><strong>Output data:</strong> <code>attractiveness</code> (geospatial)</p>
<p><strong>Columns</strong>:</p>
<ul>
<li><code>HEX_ID</code>: ID corresponding to the zone</li>
<li><code>BUS_STOP_COUNT</code>: Number of bus stops in a zone</li>
<li><code>TRAIN_EXITS_COUNT</code>: Number of train station exits in a zone</li>
<li><code>HDB_COUNT</code>: Number of HDB blocks in a zone</li>
<li><code>ENTERTN_COUNT</code>: Number of entertainment locations in a zone</li>
<li><code>F_AND_B_COUNT</code>: Number of F&amp;B outlets in a zone</li>
<li><code>LEISURE_COUNT</code>: Number of leisure and recreation in a zone</li>
<li><code>RETAIL_COUNT</code>: Number of retail locations in a zone</li>
<li>Geometry of the hexagons corresponding to the traffic analysis zone</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Propulsiveness Variables Table (<em>propulsiveness</em>)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This table contains the values of the <a href="#propulsiveness">Propulsiveness</a> variables. Data sources are defined in the <a href="#propulsiveness">Propulsiveness</a> section. We will also use this data to plot the propulsive forces for visualizing spatial interactions.</p>
<p><strong>Prerequisites:</strong> <em>Honeycomb grid corresponding to bus stop locations (honeycomb)</em>, prepared data from identified data sources</p>
<p><strong>Output data:</strong> <code>propulsiveness</code> (geospatial)</p>
<p><strong>Columns</strong>:</p>
<ul>
<li><code>HEX_ID</code>: ID corresponding to the zone</li>
<li><code>BUS_ALIGHT_COUNT</code>: Number of bus passengers alighting from a zone</li>
<li><code>TRAIN_ALIGHT_COUNT</code>: Number of train passengers alighting from a zone</li>
<li><code>HDB_RESIDENT_COUNT</code>: Number of residents in a zone</li>
<li>Geometry of the hexagons corresponding to the traffic analysis zone</li>
</ul>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zone distance table (<em>dist_tbl</em>)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This table contains the distances between all the pair of zones. This corresponds to the <strong>distance decay</strong> component of our model</p>
<p><strong>Prerequisites:</strong> <em>Honeycomb grid corresponding to bus stop locations (honeycomb)</em></p>
<p><strong>Output data:</strong> <code>dist_tbl</code> (aspatial)</p>
<p><strong>Columns</strong>:</p>
<ul>
<li><code>ORIG_HEX_ID</code>: ID corresponding to the origin zone</li>
<li><code>DEST_HEX_ID</code>: ID corresponding to the destination zone</li>
<li><code>DISTANCE</code>: Distance between the (centroids of) origin and destination zones</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Model Data (<em>SIM_data</em>)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Contains all the data we need to model the interaction.</p>
<p><strong>Prerequisites:</strong></p>
<ul>
<li><em>Zone distance table (dist_tbl)</em></li>
<li><em>Attractiveness Variables Table (attractiveness)</em></li>
<li><em>Propulsiveness Variables Table (propulsiveness)</em></li>
<li><em>Flow Lines (flowlines)</em></li>
</ul>
<p><strong>Output data:</strong> <code>SIM_data</code> (aspatial)</p>
<p><strong>Columns</strong>:</p>
<ul>
<li><p><code>ORIG_HEX_ID</code>: ID corresponding to the origin zone</p></li>
<li><p><code>DEST_HEX_ID</code>: ID corresponding to the destination zone</p></li>
<li><p><code>DISTANCE</code>: Distance between the (centroids of) origin and destination zones</p></li>
<li><p><code>TRIPS</code>: Number of bus trips between the origin and destination zones</p></li>
<li><p><code>DEST_*_COUNT</code>: Values from <em>Attractiveness Variables Table (attractiveness)</em></p></li>
<li><p><code>ORIG_*_COUNT</code>: Values from <em>Propulsiveness Variables Table (propulsiveness)</em></p></li>
<li><p>Geomtery corresponding to the flowlines</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="managing-our-data" class="level2">
<h2 class="anchored" data-anchor-id="managing-our-data">Managing our data</h2>
<p>As this process is expected to have a lot of intermediate steps, <strong>Save</strong>, <strong>Load</strong>, and <strong>Data clear</strong> points are available to make our data wrangling more efficient.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is where data is written as <code>rds</code> files using <code>write_rds()</code> for important data sets that will be used in later analysis. Examples are:</p>
<ul>
<li>Data we need to prepare for analysis</li>
<li>Critical outputs of expensive calculations</li>
<li>Cleaned up data for lightweight processing</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load point
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is where data is loaded from <code>rds</code> files using <code>read_rds()</code>. They were previously generated by the save point.</p>
<p><strong>TIP</strong>: Skip to the load points to progress without running the code above it</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is where data that will not be used anymore are cleared. The data in RStudio environment will pile up and will make it more difficult to check the relevant data in each part.</p>
<p>We can set <code>#| eval: false</code> in code chunks if we want skip the clearing. For example, the code below won’t be run.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>message <span class="ot">&lt;-</span> <span class="st">"This code chunk executed"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="setup" class="level1">
<h1>Setup</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Datasets</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">R Packages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Environment Settings</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Using the data sources identified in <a href="#data-outputs">Data Outputs</a>, we will download the datasets and add them into our <code>data/</code> directory.</p>
<p>We will also prepare the <code>data/rds/</code> directory to save important or expesive data, such as those we load from our <a href="#load-point">Load point</a>.</p>
<p>After the setup we are left with the directory structure below.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Directory structure
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Take-home_Ex2/data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> aspatial</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── hdb.csv</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── origin_destination_bus_202310.csv</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   └── origin_destination_train_202310.csv</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> geospatial</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── BusStop.cpg</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── BusStop.dbf</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── BusStop.lyr</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── BusStop.prj</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── BusStop.sbn</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── BusStop.sbx</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── BusStop.shp</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── BusStop.shp.xml</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── BusStop.shx</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── F<span class="kw">&amp;</span><span class="ex">B.cpg</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── F<span class="kw">&amp;</span><span class="ex">B.dbf</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── F<span class="kw">&amp;</span><span class="ex">B.prj</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── F<span class="kw">&amp;</span><span class="ex">B.qix</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── F<span class="kw">&amp;</span><span class="ex">B.qmd</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── F<span class="kw">&amp;</span><span class="ex">B.shp</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── F<span class="kw">&amp;</span><span class="ex">B.shx</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Liesure<span class="kw">&amp;</span><span class="ex">Recreation.cpg</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Liesure<span class="kw">&amp;</span><span class="ex">Recreation.dbf</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Liesure<span class="kw">&amp;</span><span class="ex">Recreation.prj</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Liesure<span class="kw">&amp;</span><span class="ex">Recreation.qmd</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Liesure<span class="kw">&amp;</span><span class="ex">Recreation.shp</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Liesure<span class="kw">&amp;</span><span class="ex">Recreation.shx</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── MPSZ-2019.cpg</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── MPSZ-2019.dbf</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── MPSZ-2019.prj</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── MPSZ-2019.qmd</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── MPSZ-2019.shp</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── MPSZ-2019.shx</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Train_Station_Exit_Layer.cpg</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Train_Station_Exit_Layer.dbf</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Train_Station_Exit_Layer.lyr</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Train_Station_Exit_Layer.prj</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Train_Station_Exit_Layer.sbn</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Train_Station_Exit_Layer.sbx</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Train_Station_Exit_Layer.shp</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Train_Station_Exit_Layer.shp.xml</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Train_Station_Exit_Layer.shx</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Retails.cpg</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Retails.dbf</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Retails.prj</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Retails.qix</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Retails.qmd</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Retails.shp</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── Retails.shx</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── entertn.cpg</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── entertn.dbf</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── entertn.prj</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── entertn.qix</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── entertn.qmd</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   ├── entertn.shp</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a><span class="ex">│</span>   └── entertn.shx</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a><span class="ex">└──</span> rds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>We will use the following R packages to run the code needed for data analysis.</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/tmap/index.html"><strong>tmap</strong></a>: for thematic mapping</li>
<li><a href="https://cran.r-project.org/web/packages/sf/index.html"><strong>sf</strong></a>: for geospatial data handling</li>
<li><a href="https://cran.r-project.org/web/packages/tidyverse/index.html"><strong>tidyverse</strong></a>: for non-spatial data handling</li>
<li><a href="https://cran.r-project.org/web/packages/knitr/"><strong>knitr</strong></a>: for prettifying presentation</li>
<li><a href="https://cran.r-project.org/web/packages/stplanr/index.html"><strong>stplanr</strong></a>: for generating flow lines</li>
<li><a href="https://cran.r-project.org/web/packages/reshape2/index.html"><strong>reshape2</strong></a>: for generating pivot tables from matrix</li>
<li><a href="https://cran.r-project.org/web/packages/performance/index.html"><strong>performance</strong></a>: for model comparisons</li>
</ul>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>These are the default setting we will use, and initial setup required for the environment.</p>
<ul>
<li><code>tmap_mode</code> to <strong>plot</strong>: for plotting simple maps</li>
<li><code>tmap_style</code> to <strong>natural</strong>: for my preferred mapping style</li>
<li>set <strong>seed</strong> for the <em>random number generator</em> so our results are deterministic (for reproduceability)</li>
</ul>
</div>
</div>
</div>
<p>Using the setup tasks identified above, we will now run the setup code.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>We will label this code chunk with <code>label: setup</code> so it will always be run even if we reset our environment and start in the middle of the page</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  sf, sp, tmap, tidyverse, knitr,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  stplanr, reshape2, performance,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  ggpubr, corrplot)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_style</span>(<span class="st">"natural"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-wrangling" class="level1">
<h1>Data Wrangling</h1>
<p>Using the <a href="#data-outputs">Data Outputs</a> previously identified, we generate the dependency map below.</p>
<p><img src="images/data_dependency_map.png" class="img-fluid"></p>
<p>We will use this as a guide to do our complex data wrangling tasks.</p>
<section id="utility-1" class="level2">
<h2 class="anchored" data-anchor-id="utility-1">Utility</h2>
<p>We will first start by preparing the data needed for utility, <em>Singapore Boundary geometry (mpsz)</em> and <em>Honeycomb grid corresponding to bus stop locations (honeycomb)</em>. (see <a href="#data-outputs">Data Outputs</a>)</p>
<section id="importing-the-datasets" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-datasets">Importing the datasets</h3>
<p>We will import the datasets needed to prepare the utility data.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Singapore boundary map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">BusStop (shp)</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>We will import the <strong>Master Plan 2019 Subzone Boundary (Web)</strong> data set that has been used in class. We will only keep the <code>SUBZONE_N</code> column and the geometry as we will only use this as the <strong>base for our visualizations</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"MPSZ-2019"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SUBZONE_N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MPSZ-2019' from data source 
  `/Users/kjcpaas/Documents/Grad School/ISSS624/Project/ISSS624/Take-home_Ex2/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 332 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correcting the projection
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This data frame using the global GPS standard, <a href="https://gisgeography.com/wgs84-world-geodetic-system/"><strong>WGS84</strong></a>. We need to convert this to <a href="https://app.sla.gov.sg/sirent/About/PlaneCoordinateSystem"><strong>SVY21</strong></a> projection that we will use for all our data in our analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> mpsz <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visual inspection
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will do a quick visual inspection to check if the map has been imported as expected.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"lightgreen"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Map of Singapore"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>() <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Next, we need to import the bus stop data as we will generate the honeycomb grid based on locations with bus stops.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>busstops <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">layer =</span> <span class="st">"BusStop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `BusStop' from data source 
  `/Users/kjcpaas/Documents/Grad School/ISSS624/Project/ISSS624/Take-home_Ex2/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 5161 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82
Projected CRS: SVY21</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correcting the projection
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We want to use <a href="https://app.sla.gov.sg/sirent/About/PlaneCoordinateSystem">SVY21</a> as the projection for this study as it is the projection used for local Singaporean context.</p>
<p>After the import, it shows that the <strong>Projected CRS</strong>is <strong>SVY21</strong>. However, checking the CRS with <code>st_crs()</code> tells a different story.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(busstops)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: SVY21 
  wkt:
PROJCRS["SVY21",
    BASEGEOGCRS["WGS 84",
        DATUM["World Geodetic System 1984",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ID["EPSG",6326]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["Degree",0.0174532925199433]]],
    CONVERSION["unnamed",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]]]</code></pre>
</div>
</div>
<p>As we can see EPSG value is <strong>9001</strong>, which correspond to <a href="https://gisgeography.com/wgs84-world-geodetic-system/"><strong>WGS84</strong></a>. We have to fix the projection by transforming to EPSG value of <strong>3414</strong>, which corresponds to <strong>SVY21</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>busstops <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(busstops, <span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visual inspection
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will do a quick visual inspection to check if the map has been imported as expected.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_style</span>(<span class="st">"natural"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"lightgreen"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Map of bus stops in Singapore"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(busstops) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.005</span>, <span class="at">title =</span> <span class="st">"Bus Stops"</span>) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>() <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The map shows that there are bus stops in our data set that are outside Singapore bounds (green area). We need to remove them as we are only interested in bus stops within Singapore.</p>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Removing the bus stops outside Singapore
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can remove the points outside Singapore from our <code>busstops</code> data by using <code>st_intersection()</code>.</p>
<p>We will use this as <code>busstops</code> contains points, the intersection of the 2 geometries will generate points corresponding to the bus stops within Singapore.</p>
<p>We will also just retain the <code>BUS_STOP_N</code> to remove the columns we do not need.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>busstops <span class="ot">&lt;-</span> busstops <span class="sc">%&gt;%</span> <span class="fu">st_intersection</span>(mpsz) <span class="sc">%&gt;%</span> <span class="fu">select</span>(BUS_STOP_N, )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizing again, all the bus stops are now within Singapore.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_style</span>(<span class="st">"natural"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"lightgreen"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Map of bus stops in Singapore"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(busstops) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.005</span>, <span class="at">title =</span> <span class="st">"Bus Stops"</span>) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>() <span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s save <code>mpsz</code> geometry as this is one of our Utility data outputs, [Singapore Boundary geometry (mpsz)].</p>
<p>We will also save <code>busstops</code> for later use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mpsz, <span class="st">"data/rds/mpsz.rds"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(busstops, <span class="st">"data/rds/busstops.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="generating-the-honeycomb-grid" class="level3">
<h3 class="anchored" data-anchor-id="generating-the-honeycomb-grid">Generating the honeycomb grid</h3>
<p>Finally, we can generate the honeycomb grid using <code>st_make_grid()</code>, providing <em>cellsize</em> of <strong>750m</strong>.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Calculating cellsize
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="https://www.merriam-webster.com/dictionary/apothem">Apothem</a> is defined as <em>the perpendicular from the center of a regular polygon to one of the sides<strong>.</strong></em></p>
<p>The specification is this study requires hexagons to be <strong>375 m</strong> from the center of the hexagon to the center of one of it’s edge.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/apothem.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>As such, this corresponds to the length of 2 opposite apothems, which is <strong>750 m</strong>.</p>
<p>The edge length is <strong>not</strong> the same as apothem. It is <strong>433.013 m</strong>m.</p>
<p><span class="math display">\[
375m/cos(30) = 433.013m
\]</span></p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>honeycomb <span class="ot">&lt;-</span> busstops <span class="sc">%&gt;%</span> <span class="fu">st_make_grid</span>(<span class="at">cellsize =</span> <span class="dv">750</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">what=</span><span class="st">"polygons"</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">square =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_sf</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">lengths</span>(<span class="fu">st_intersects</span>(geometry, busstops)) <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<dl>
<dt>st_make_grid()</dt>
<dd>
<p>Creates a grid that covers the entire bus stop geometry, including areas without bus stop.</p>
</dd>
<dt>st_sf()</dt>
<dd>
<p>Converts to simple feature data set</p>
</dd>
<dt>st_intersects()</dt>
<dd>
<p>Checks if the hexagons have bus stops</p>
</dd>
<dt>filter()</dt>
<dd>
<p>Removes hexagons without bus stops</p>
</dd>
</dl>
</div>
</div>
</div>
<p>Let’s plot the map to visually inspect if the hexagons cover all the bus stop locations.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"green"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(honeycomb) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"white"</span>, <span class="at">title =</span> <span class="st">"Hexagons"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Honeycomb grid corresponding to Singapore bus stops"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(busstops) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.001</span>, <span class="at">title =</span> <span class="st">"Bus Stops"</span>) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="assigning-id-to-each-hexagon" class="level3">
<h3 class="anchored" data-anchor-id="assigning-id-to-each-hexagon">Assigning id to each hexagon</h3>
<p>Now that we have hexagons properly generated, we will assign id for each hexagon to be used as a unique identifier. We will store this id under the <code>HEX_ID</code> column, and can be used in joining data frames.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>honeycomb<span class="sc">$</span>HEX_ID <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"H%04d"</span>, <span class="fu">seq_len</span>(<span class="fu">nrow</span>(honeycomb))) <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(honeycomb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">geometry</th>
<th style="text-align: left;">HEX_ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">POLYGON ((3970.122 27348.13…</td>
<td style="text-align: left;">H0001</td>
</tr>
<tr class="even">
<td style="text-align: left;">POLYGON ((4345.122 27997.65…</td>
<td style="text-align: left;">H0002</td>
</tr>
<tr class="odd">
<td style="text-align: left;">POLYGON ((4345.122 30595.72…</td>
<td style="text-align: left;">H0003</td>
</tr>
<tr class="even">
<td style="text-align: left;">POLYGON ((4720.122 28647.16…</td>
<td style="text-align: left;">H0004</td>
</tr>
<tr class="odd">
<td style="text-align: left;">POLYGON ((4720.122 29946.2,…</td>
<td style="text-align: left;">H0005</td>
</tr>
<tr class="even">
<td style="text-align: left;">POLYGON ((4720.122 31245.24…</td>
<td style="text-align: left;">H0006</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s save <code>honeycomb</code> as it contains the main geometry we will use in analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(honeycomb, <span class="st">"data/rds/honeycomb.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="spatial-interaction-analysis-2" class="level2">
<h2 class="anchored" data-anchor-id="spatial-interaction-analysis-2">Spatial Interaction Analysis</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can start from this point by loading the relevant datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/mpsz.rds"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>honeycomb <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/honeycomb.rds"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>busstops <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/busstops.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<section id="importing-the-datasets-1" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-datasets-1">Importing the datasets</h3>
<p>We will import the datasets needed to prepare the data outputs, [Number of trips between 2 zones (od_hex)] and [Flow Lines (flowlines)].</p>
<p>Aside from the output of <a href="#utility">Utility</a>, we also need to import the <em>Passenger Volume By Origin Destination Bus Stops</em> from <a href="https://datamall.lta.gov.sg/content/datamall/en.html">LTA DataMall</a> via API for the month of <strong>October 2023</strong>.</p>
<p>The data set is an aspatial data in <code>csv</code> format so we will use <code>read_csv()</code> to import the data.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>We will use the October 2023 passenger data in this document. If you want to use dataset for another month, replace <code>202310</code> to the corresponding <code>YYYYMM</code> format.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>odbus <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/origin_destination_bus_202310.csv"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(odbus))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">YEAR_MONTH</th>
<th style="text-align: left;">DAY_TYPE</th>
<th style="text-align: right;">TIME_PER_HOUR</th>
<th style="text-align: left;">PT_TYPE</th>
<th style="text-align: left;">ORIGIN_PT_CODE</th>
<th style="text-align: left;">DESTINATION_PT_CODE</th>
<th style="text-align: right;">TOTAL_TRIPS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2023-10</td>
<td style="text-align: left;">WEEKENDS/HOLIDAY</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">BUS</td>
<td style="text-align: left;">04168</td>
<td style="text-align: left;">10051</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">2023-10</td>
<td style="text-align: left;">WEEKDAY</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">BUS</td>
<td style="text-align: left;">04168</td>
<td style="text-align: left;">10051</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2023-10</td>
<td style="text-align: left;">WEEKENDS/HOLIDAY</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">BUS</td>
<td style="text-align: left;">80119</td>
<td style="text-align: left;">90079</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">2023-10</td>
<td style="text-align: left;">WEEKDAY</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">BUS</td>
<td style="text-align: left;">80119</td>
<td style="text-align: left;">90079</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2023-10</td>
<td style="text-align: left;">WEEKDAY</td>
<td style="text-align: right;">17</td>
<td style="text-align: left;">BUS</td>
<td style="text-align: left;">44069</td>
<td style="text-align: left;">17229</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">2023-10</td>
<td style="text-align: left;">WEEKENDS/HOLIDAY</td>
<td style="text-align: right;">17</td>
<td style="text-align: left;">BUS</td>
<td style="text-align: left;">20281</td>
<td style="text-align: left;">20141</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="generating-the-o-d-trip-data-by-hexagon-level" class="level3">
<h3 class="anchored" data-anchor-id="generating-the-o-d-trip-data-by-hexagon-level">Generating the O-D trip data by hexagon level</h3>
<section id="filtering-the-relevant-data" class="level4">
<h4 class="anchored" data-anchor-id="filtering-the-relevant-data">Filtering the relevant data</h4>
<p>We only need the data for the <strong>weekend morning peak period</strong>, which is from 11 AM - 2 PM on weekends and holidays. As such, we will filter the data for the relevant hours.</p>
<p>We will also rename the <code>ORIGIN_PT_CODE</code> and <code>DESTINATION_PT_CODE</code> to be consistent with the naming with <code>busstops</code> as these columns can be associated to <code>busstops</code>’s <code>BUS_STOP_N</code></p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How to filter data by <em>TIME_PER_HOUR</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The <code>TIME_PER_HOUR</code> in data set covers the data from the start to the end of the hour in <strong>24-hour format</strong>, i.e.&nbsp;when <code>TIME_PER_HOUR = 13</code>, this means bus taps from <code>1:00 PM</code> ton<code>1:59:59PM</code>.</p>
<p>Hence, if we want to get 11AM to 2PM data, we will filter by:</p>
<pre><code>TIME_PER_HOUR &gt;= 11 &amp; TIME_PER_HOUR &lt; 14</code></pre>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>od_trips <span class="ot">&lt;-</span> odbus <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DAY_TYPE <span class="sc">==</span> <span class="st">"WEEKENDS/HOLIDAY"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( TIME_PER_HOUR <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>            TIME_PER_HOUR <span class="sc">&lt;</span> <span class="dv">14</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_PT_CODE, DESTINATION_PT_CODE) <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TOTAL_TRIPS)) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ORIG_BUS_STOP_N =</span> ORIGIN_PT_CODE,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">DEST_BUS_STOP_N =</span> DESTINATION_PT_CODE</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(od_trips))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ORIG_BUS_STOP_N</th>
<th style="text-align: left;">DEST_BUS_STOP_N</th>
<th style="text-align: right;">TRIPS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">01012</td>
<td style="text-align: left;">01112</td>
<td style="text-align: right;">204</td>
</tr>
<tr class="even">
<td style="text-align: left;">01012</td>
<td style="text-align: left;">01113</td>
<td style="text-align: right;">129</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01012</td>
<td style="text-align: left;">01121</td>
<td style="text-align: right;">95</td>
</tr>
<tr class="even">
<td style="text-align: left;">01012</td>
<td style="text-align: left;">01211</td>
<td style="text-align: right;">91</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01012</td>
<td style="text-align: left;">01311</td>
<td style="text-align: right;">152</td>
</tr>
<tr class="even">
<td style="text-align: left;">01012</td>
<td style="text-align: left;">01559</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We do not need <code>odbus</code> anymore as we already extracted the data relevant to our analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(odbus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="generating-lookup-table-for-bus-stop-to-associated-hexagon" class="level4">
<h4 class="anchored" data-anchor-id="generating-lookup-table-for-bus-stop-to-associated-hexagon">Generating lookup table for bus stop to associated hexagon</h4>
<p>To connect the trip data to the their corresponding hexagon, we need to create a lookup table. This will serve as a glue in associating the aspatial <code>od_trips</code> data frame to the <code>honeycomb</code> data frame.</p>
<p>This can be done via <code>st_intersection()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>bs_hex <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(busstops, honeycomb) <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(BUS_STOP_N, HEX_ID))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(bs_hex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">BUS_STOP_N</th>
<th style="text-align: left;">HEX_ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">3269</td>
<td style="text-align: left;">25059</td>
<td style="text-align: left;">H0001</td>
</tr>
<tr class="even">
<td style="text-align: left;">2570</td>
<td style="text-align: left;">25751</td>
<td style="text-align: left;">H0002</td>
</tr>
<tr class="odd">
<td style="text-align: left;">254</td>
<td style="text-align: left;">26379</td>
<td style="text-align: left;">H0003</td>
</tr>
<tr class="even">
<td style="text-align: left;">2403</td>
<td style="text-align: left;">26369</td>
<td style="text-align: left;">H0003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2829</td>
<td style="text-align: left;">25741</td>
<td style="text-align: left;">H0004</td>
</tr>
<tr class="even">
<td style="text-align: left;">1715</td>
<td style="text-align: left;">26399</td>
<td style="text-align: left;">H0005</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="joining-od_trips-and-bs_hex" class="level4">
<h4 class="anchored" data-anchor-id="joining-od_trips-and-bs_hex">Joining <em>od_trips</em> and <em>bs_hex</em></h4>
<p>Next, we need to associate each origin bus stop and destination bus stop to their corresponding hexagons.</p>
<p>We can use that by doing <code>inner_join()</code> twice, once for the origin and another for the destination.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why <em>inner_join()</em> instead of <em>left_join()</em>?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will use <code>inner_join</code> as there are <code>BUS_STOP_N</code> values in <code>od_trips</code> data that are not in <code>bs_hex</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  od_trips<span class="sc">$</span>ORIG_BUS_STOP_N[<span class="sc">!</span>(od_trips<span class="sc">$</span>ORIG_BUS_STOP_N <span class="sc">%in%</span> bs_hex<span class="sc">$</span>BUS_STOP_N)],</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  od_trips<span class="sc">$</span>DEST_BUS_STOP_N[<span class="sc">!</span>(od_trips<span class="sc">$</span>DEST_BUS_STOP_N <span class="sc">%in%</span> bs_hex<span class="sc">$</span>BUS_STOP_N)]</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">unique</span>() <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 59</code></pre>
</div>
</div>
<p>There are <strong>59</strong> bus stops in <code>od_trips</code> that are not in <code>bs_hex</code>. <strong>5</strong> of these can be attributed the bus stops we removed due to them being out in Singapore. Others may be due to the <em>BusStops</em> data set not having complete information.</p>
<p>The proper way to handle this is to validate the existence of each of these bus stops and look at public sources (e.g.&nbsp;Google Maps, LTA data) and add coordinate data. However, as we do not have much to do this task, we have to <strong>remove</strong> these bus stops from our analysis as <strong>we do not have geospatial data</strong> to associate to the hexagons from the data sets available to us.</p>
<p>Therefore, we will use <code>inner_join</code> to keep only the observations in <code>trips</code> with the matching bus stops in <code>bs_hex</code>.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>od_trips_w_hex <span class="ot">&lt;-</span> od_trips <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(bs_hex,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIG_BUS_STOP_N"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ORIG_HEX_ID =</span> HEX_ID) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(bs_hex,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"DEST_BUS_STOP_N"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DEST_HEX_ID =</span> HEX_ID)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(od_trips_w_hex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ORIG_BUS_STOP_N</th>
<th style="text-align: left;">DEST_BUS_STOP_N</th>
<th style="text-align: right;">TRIPS</th>
<th style="text-align: left;">ORIG_HEX_ID</th>
<th style="text-align: left;">DEST_HEX_ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">01012</td>
<td style="text-align: left;">01112</td>
<td style="text-align: right;">204</td>
<td style="text-align: left;">H0515</td>
<td style="text-align: left;">H0527</td>
</tr>
<tr class="even">
<td style="text-align: left;">01012</td>
<td style="text-align: left;">01113</td>
<td style="text-align: right;">129</td>
<td style="text-align: left;">H0515</td>
<td style="text-align: left;">H0527</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01012</td>
<td style="text-align: left;">01121</td>
<td style="text-align: right;">95</td>
<td style="text-align: left;">H0515</td>
<td style="text-align: left;">H0550</td>
</tr>
<tr class="even">
<td style="text-align: left;">01012</td>
<td style="text-align: left;">01211</td>
<td style="text-align: right;">91</td>
<td style="text-align: left;">H0515</td>
<td style="text-align: left;">H0550</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01012</td>
<td style="text-align: left;">01311</td>
<td style="text-align: right;">152</td>
<td style="text-align: left;">H0515</td>
<td style="text-align: left;">H0561</td>
</tr>
<tr class="even">
<td style="text-align: left;">01012</td>
<td style="text-align: left;">01559</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">H0515</td>
<td style="text-align: left;">H0550</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="aggregating-data-by-hexagon" class="level4">
<h4 class="anchored" data-anchor-id="aggregating-data-by-hexagon">Aggregating data by hexagon</h4>
<p>Next, we will perform aggregations by <code>ORIG_HEX_ID</code> and <code>DEST_HEX_ID</code> to have an aggregated sum of trips by hexagon instead of bus stops.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>od_hex <span class="ot">&lt;-</span> od_trips_w_hex <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIG_HEX_ID, DEST_HEX_ID) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TRIPS))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(od_hex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ORIG_HEX_ID</th>
<th style="text-align: left;">DEST_HEX_ID</th>
<th style="text-align: right;">TRIPS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">H0002</td>
<td style="text-align: left;">H0016</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0002</td>
<td style="text-align: left;">H0017</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0002</td>
<td style="text-align: left;">H0032</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0003</td>
<td style="text-align: left;">H0005</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0003</td>
<td style="text-align: left;">H0022</td>
<td style="text-align: right;">56</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0003</td>
<td style="text-align: left;">H0028</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s save <code>od_hex</code> as it contains the <code>TRIP</code> data needed to visualize flow data and do spatial interaction modelling. Take note that this <strong>includes intra-zonal trips</strong>.</p>
<p>We will also write save <code>od_trips</code> as we need this later for calculating propulsiveness variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(bs_hex, <span class="st">"data/rds/bs_hex.rds"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(od_hex, <span class="st">"data/rds/od_hex202310.rds"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(od_trips, <span class="st">"data/rds/od_trips202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We do not need <code>bs_hex</code>, <code>od_trips_w_hex</code> anymore as we already have the necessary data for doing hexagon-based analysis in <code>od_hex</code>.</p>
<p>We will also remove <code>od_trips</code> for now as we do not need them until the later sections.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(bs_hex)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(od_trips)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(od_trips_w_hex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="generating-the-flow-lines" class="level3">
<h3 class="anchored" data-anchor-id="generating-the-flow-lines">Generating the flow lines</h3>
<p>First, we will generate the flow lines using <code>od2line()</code>. <code>honeycomb</code> will be supplied as the <code>zone</code> as it contains the hexagons we are using as the <strong>traffic analysis zones</strong>.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>This operation takes a while so we will save it as soon as it is generated so we set <code>eval</code> to <code>false</code>. Run this code chunk manually to regenerate the code.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>flowlines <span class="ot">&lt;-</span> od_hex <span class="sc">%&gt;%</span> <span class="fu">od2line</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  honeycomb,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">zone_code =</span> <span class="st">"HEX_ID"</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(flowlines, <span class="st">"data/rds/flowlines202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="initial-inspection-of-the-flow-lines" class="level4">
<h4 class="anchored" data-anchor-id="initial-inspection-of-the-flow-lines">Initial inspection of the flow lines</h4>
<p>Next, we will do an initial inspection of the flow lines to check if they have been generated correctly.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"green"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(honeycomb) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"white"</span>, <span class="at">title =</span> <span class="st">"Hexagons"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(flowlines) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"TRIPS"</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>),</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">title.lwd =</span> <span class="st">"# of bus trips"</span>,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Bus Passenger flow for Weekends/Holidays 11 AM - 2PM (October 2023)"</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights
</div>
</div>
<div class="callout-body-container callout-body">
<p>The flow lines are sparse at the West side of Singapore, the <strong>Jurong</strong> and <strong>Choa Chu Kang</strong> areas. This is consistent with the observations that we have in the <a href="Take-home_Ex1/Take-home_Ex1">Take-home Exercise 1</a> that these areas are least busy in terms of bus rides.</p>
<p>We can also notice that the thickest flow lines is between <strong>Woodlands Checkpoint</strong> and <strong>Kranji Station</strong>. There are not residential areas so our hypothesis that connecting transport points influence the bus passenger flow.</p>
<p>Lastly, points where many lines intersect must be transportation hubs as many trips originate or end in those zones.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s save <code>flowlines</code> as it contains the data for spatial interaction that we will use later on.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(flowlines, <span class="st">"data/rds/flowlines202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We do not need <code>flowlines</code> and <code>od_hex</code> until later sections so we can remove them from the environment for now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(flowlines)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(od_hex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="spatial-interaction-modelling-2" class="level2">
<h2 class="anchored" data-anchor-id="spatial-interaction-modelling-2">Spatial Interaction Modelling</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can start from this point by loading the relevant datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/mpsz.rds"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>honeycomb <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/honeycomb.rds"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>busstops <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/busstops.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Next, we will prepare the data needed for spatial interaction modelling. Some of these are straightforward to get, especially those of attractiveness variables. Additional steps are needed for more complex data sets, like those needed for propulsiveness variables. We will derive those in a separate section.</p>
<section id="attractiveness-variables" class="level3">
<h3 class="anchored" data-anchor-id="attractiveness-variables">Attractiveness variables</h3>
<p>We will first initiate <code>attractiveness</code> from <code>honeycomb</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>attractiveness <span class="ot">&lt;-</span> honeycomb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For all the variables, we only need to count the number of each location types for each hexagon. We will use a combination of <code>lengths()</code> and <code>st_intersects()</code> to derive this value.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Bus Stops</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Entertainment</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">F&amp;B</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">Leisure &amp; Recreation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false">Retail</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-6" role="tab" aria-controls="tabset-6-6" aria-selected="false">Train Station Exits</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>attractiveness<span class="sc">$</span>BUS_STOP_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersects</span>(attractiveness, busstops))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>entertn <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, <span class="at">layer =</span> <span class="st">"entertn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `entertn' from data source 
  `/Users/kjcpaas/Documents/Grad School/ISSS624/Project/ISSS624/Take-home_Ex2/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 114 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 10809.34 ymin: 26528.63 xmax: 41600.62 ymax: 46375.77
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visual Inspection
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As we haven’t used this dataset before, we will do a quick visual inspection to check if the points are within Singapore.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"green"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(honeycomb) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"white"</span>, <span class="at">title =</span> <span class="st">"Hexagons"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Map of Entertainment Spots in Singapore"</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(entertn) <span class="sc">+</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.005</span>, <span class="at">title =</span> <span class="st">"Entertainment Spots"</span>) <span class="sc">+</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>attractiveness<span class="sc">$</span>ENTERTN_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(attractiveness, entertn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>f_and_b <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, <span class="at">layer =</span> <span class="st">"F&amp;B"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `F&amp;B' from data source 
  `/Users/kjcpaas/Documents/Grad School/ISSS624/Project/ISSS624/Take-home_Ex2/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 1919 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6010.495 ymin: 25343.27 xmax: 45462.43 ymax: 48796.21
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visual Inspection
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As we haven’t used this dataset before, we will do a quick visual inspection to check if the points are within Singapore.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"green"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(honeycomb) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"white"</span>, <span class="at">title =</span> <span class="st">"Hexagons"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Map of F&amp;B Establishments in Singapore"</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(f_and_b) <span class="sc">+</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.005</span>, <span class="at">title =</span> <span class="st">"F&amp;B Establishments Spots"</span>) <span class="sc">+</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>attractiveness<span class="sc">$</span>F_AND_B_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(attractiveness, f_and_b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>leis_rec <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, <span class="at">layer =</span> <span class="st">"Liesure&amp;Recreation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Liesure&amp;Recreation' from data source 
  `/Users/kjcpaas/Documents/Grad School/ISSS624/Project/ISSS624/Take-home_Ex2/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 1217 features and 30 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6010.495 ymin: 25134.28 xmax: 48439.77 ymax: 50078.88
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visual Inspection
</div>
</div>
<div class="callout-body-container callout-body">
<p>As we haven’t used this dataset before, we will do a quick visual inspection to check if the points are within Singapore.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"green"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(honeycomb) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"white"</span>, <span class="at">title =</span> <span class="st">"Hexagons"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Map of Leisure &amp; Recreation Spots in Singapore"</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(leis_rec) <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.005</span>, <span class="at">title =</span> <span class="st">"Leisure &amp; Recreation Spots"</span>) <span class="sc">+</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>attractiveness<span class="sc">$</span>LEISURE_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(attractiveness, leis_rec))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>retail <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, <span class="at">layer =</span> <span class="st">"Retails"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Retails' from data source 
  `/Users/kjcpaas/Documents/Grad School/ISSS624/Project/ISSS624/Take-home_Ex2/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 37635 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 4737.982 ymin: 25171.88 xmax: 48265.04 ymax: 50135.28
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visual Inspection
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As we haven’t used this dataset before, we will do a quick visual inspection to check if the points are within Singapore.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"green"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(honeycomb) <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"white"</span>, <span class="at">title =</span> <span class="st">"Hexagons"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Map of Retail Outlets in Singapore"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(retail) <span class="sc">+</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.005</span>, <span class="at">title =</span> <span class="st">"Retail Outlets"</span>) <span class="sc">+</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>attractiveness<span class="sc">$</span>RETAIL_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(attractiveness, retail))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>train_exits <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, <span class="at">layer =</span> <span class="st">"Train_Station_Exit_Layer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Train_Station_Exit_Layer' from data source 
  `/Users/kjcpaas/Documents/Grad School/ISSS624/Project/ISSS624/Take-home_Ex2/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 565 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6134.086 ymin: 27499.7 xmax: 45356.36 ymax: 47865.92
Projected CRS: SVY21</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correcting the projection
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We want to use <a href="https://app.sla.gov.sg/sirent/About/PlaneCoordinateSystem">SVY21</a> as the projection for this study as it is the projection used for local Singaporean context.</p>
<p>After the import, it shows that the <strong>Projected CRS</strong> is <strong>SVY21</strong>. However, checking the CRS with <code>st_crs()</code> tells a different story.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(train_exits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: SVY21 
  wkt:
PROJCRS["SVY21",
    BASEGEOGCRS["WGS 84",
        DATUM["World Geodetic System 1984",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ID["EPSG",6326]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["Degree",0.0174532925199433]]],
    CONVERSION["unnamed",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]]]</code></pre>
</div>
</div>
<p>As we can see EPSG value is <strong>9001</strong>, which correspond to <a href="https://gisgeography.com/wgs84-world-geodetic-system/"><strong>WGS84</strong></a>. We have to fix the projection by transforming to EPSG value of <strong>3414</strong>, which corresponds to <strong>SVY21</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>train_exits <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(train_exits, <span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visual Inspection
</div>
</div>
<div class="callout-body-container callout-body">
<p>As we haven’t used this dataset before, we will do a quick visual inspection to check if the points are within Singapore.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"green"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(honeycomb) <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"white"</span>, <span class="at">title =</span> <span class="st">"Hexagons"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Map of Train Station Exits in Singapore"</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(train_exits) <span class="sc">+</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.005</span>, <span class="at">title =</span> <span class="st">"Train Station Exits"</span>) <span class="sc">+</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>attractiveness<span class="sc">$</span>TRAIN_EXITS_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(attractiveness, train_exits))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Let’s check if the attractiveness variables have been added correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(attractiveness))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 24%">
<col style="width: 5%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">geometry</th>
<th style="text-align: left;">HEX_ID</th>
<th style="text-align: right;">BUS_STOP_COUNT</th>
<th style="text-align: right;">ENTERTN_COUNT</th>
<th style="text-align: right;">F_AND_B_COUNT</th>
<th style="text-align: right;">LEISURE_COUNT</th>
<th style="text-align: right;">RETAIL_COUNT</th>
<th style="text-align: right;">TRAIN_EXITS_COUNT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">POLYGON ((3970.122 27348.13…</td>
<td style="text-align: left;">H0001</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">POLYGON ((4345.122 27997.65…</td>
<td style="text-align: left;">H0002</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">POLYGON ((4345.122 30595.72…</td>
<td style="text-align: left;">H0003</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">POLYGON ((4720.122 28647.16…</td>
<td style="text-align: left;">H0004</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">POLYGON ((4720.122 29946.2,…</td>
<td style="text-align: left;">H0005</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">POLYGON ((4720.122 31245.24…</td>
<td style="text-align: left;">H0006</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-38-contents" aria-controls="callout-38" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-38" class="callout-38-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s save <code>attractiveness</code> even though it is still missing <code>HDB_COUNT</code> as additional processing is needed to derive that. We will also save <code>train_exits</code> as it contains data needed for deriving propulsiveness variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(attractiveness, <span class="st">"data/rds/attractiveness_no_hdb.rds"</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(train_exits, <span class="st">"data/rds/train_exits.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-39-contents" aria-controls="callout-39" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-39" class="callout-39-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We do not need the data used to read the <code>shp</code> contents anymore as we have already derived the attractiveness variables from them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(busstops)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(entertn)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(f_and_b)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(leis_rec)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(retail)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="deriving-passengers-alighting-from-bus-stop" class="level3">
<h3 class="anchored" data-anchor-id="deriving-passengers-alighting-from-bus-stop">Deriving Passengers Alighting from Bus Stop</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-40-contents" aria-controls="callout-40" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-40" class="callout-40-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can run from this point by loading these data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>bs_hex <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/bs_hex.rds"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>od_trips <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/od_trips202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>bs_hex</code>: for connecting <code>od_trips</code> with honeycomb grid.</li>
<li><code>od_trips</code>: to get trips to destination bus stops</li>
</ul>
<p>We are not using <code>od_hex</code> as some destination trips were lost from [Joining od_trips and bs_hex] if the origin bus stop has no known geometry.</p>
</div>
</div>
</div>
<p>Using the similar techniques used in <a href="Take-home_Ex1/Take-home_Ex1.html#extracting-hourly-of-bus-trips-originating-from-hexagons">Take-home Exercise 1</a>, we will aggregate the trips using <code>inner_join()</code>, <code>group_by</code>, and <code>summarise</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>dest_bus_hex <span class="ot">&lt;-</span> od_trips <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(bs_hex,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">join_by</span>(DEST_BUS_STOP_N <span class="sc">==</span> BUS_STOP_N)) <span class="sc">%&gt;%</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(HEX_ID) <span class="sc">%&gt;%</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TRIPS))</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(dest_bus_hex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">HEX_ID</th>
<th style="text-align: right;">TRIPS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">H0002</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0003</td>
<td style="text-align: right;">121</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0004</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0005</td>
<td style="text-align: right;">152</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0006</td>
<td style="text-align: right;">204</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0007</td>
<td style="text-align: right;">41</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-41-contents" aria-controls="callout-41" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-41" class="callout-41-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s save <code>dest_bus_hex</code> as it contains the data for propulsiveness variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(dest_bus_hex, <span class="st">"data/rds/dest_bus_hex202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-42-contents" aria-controls="callout-42" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-42" class="callout-42-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We do not need <code>bs_hex</code> and <code>od_trips</code> anymore so we can remove them from our environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(bs_hex)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(od_trips)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="deriving-train-passenger-data" class="level3">
<h3 class="anchored" data-anchor-id="deriving-train-passenger-data">Deriving Train Passenger Data</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-43-contents" aria-controls="callout-43" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-43" class="callout-43-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can run from this point by loading these data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>honeycomb <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/honeycomb.rds"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>train_exits <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/train_exits.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>One of our propulsiveness variables is the <strong>number of passengers alighting from a train stations</strong> as they are potential bus passengers, especially if they need to transfer to a bus to reach their final destination.</p>
<p>For this, we will import the <em>Passenger Volume By Origin Destination Train Stations</em> from <a href="https://datamall.lta.gov.sg/content/datamall/en.html">LTA DataMall</a> via API, which contains the number of tap outs from a station every hour. It has a similar structure to <em>Passenger Volume By Origin Destination Bus Stops</em> from <a href="https://datamall.lta.gov.sg/content/datamall/en.html">LTA DataMall</a> via API, which we have been using in class so I will not dive deep in to the details on how to get passenger data from them as we are using the same techniques as the bus data.</p>
<section id="importing-data-sets" class="level4">
<h4 class="anchored" data-anchor-id="importing-data-sets">Importing data sets</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Passenger Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Station Code and Names</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>We will import the <code>csv</code> from <em>Passenger Volume By Train Stations</em> from <a href="https://datamall.lta.gov.sg/content/datamall/en.html">LTA DataMall</a> via API, using <code>read_csv()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>od_train <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/origin_destination_train_202310.csv"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(od_train))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">YEAR_MONTH</th>
<th style="text-align: left;">DAY_TYPE</th>
<th style="text-align: right;">TIME_PER_HOUR</th>
<th style="text-align: left;">PT_TYPE</th>
<th style="text-align: left;">ORIGIN_PT_CODE</th>
<th style="text-align: left;">DESTINATION_PT_CODE</th>
<th style="text-align: right;">TOTAL_TRIPS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2023-10</td>
<td style="text-align: left;">WEEKENDS/HOLIDAY</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">TRAIN</td>
<td style="text-align: left;">EW32</td>
<td style="text-align: left;">DT24</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">2023-10</td>
<td style="text-align: left;">WEEKDAY</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">TRAIN</td>
<td style="text-align: left;">BP4</td>
<td style="text-align: left;">EW31</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2023-10</td>
<td style="text-align: left;">WEEKENDS/HOLIDAY</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">TRAIN</td>
<td style="text-align: left;">NE15</td>
<td style="text-align: left;">SW5</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="even">
<td style="text-align: left;">2023-10</td>
<td style="text-align: left;">WEEKDAY</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">TRAIN</td>
<td style="text-align: left;">SW5</td>
<td style="text-align: left;">NE15</td>
<td style="text-align: right;">87</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2023-10</td>
<td style="text-align: left;">WEEKENDS/HOLIDAY</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">TRAIN</td>
<td style="text-align: left;">SW5</td>
<td style="text-align: left;">NE15</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="even">
<td style="text-align: left;">2023-10</td>
<td style="text-align: left;">WEEKDAY</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">TRAIN</td>
<td style="text-align: left;">NE15</td>
<td style="text-align: left;">SW5</td>
<td style="text-align: right;">73</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We only need data for <strong>weekend/holidays 11AM - 2PM,</strong> and the columns <code>DESTINATION_PT_CODE</code> and <code>TOTAL_TRIPS</code> as we are only interested in passengers leaving the train station.</p>
<p>We will extract this the same way we did in <a href="#filtering-the-relevant-data">Filtering the relevant data</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>od_train_trips <span class="ot">&lt;-</span> od_train <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DAY_TYPE <span class="sc">==</span> <span class="st">"WEEKENDS/HOLIDAY"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( TIME_PER_HOUR <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>            TIME_PER_HOUR <span class="sc">&lt;</span> <span class="dv">14</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">%&gt;%</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(DESTINATION_PT_CODE) <span class="sc">%&gt;%</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TOTAL_TRIPS)) <span class="sc">%&gt;%</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">TRAIN_ST_CODE =</span> DESTINATION_PT_CODE)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(od_train_trips))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">TRAIN_ST_CODE</th>
<th style="text-align: right;">TRIPS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">BP10</td>
<td style="text-align: right;">3839</td>
</tr>
<tr class="even">
<td style="text-align: left;">BP11</td>
<td style="text-align: right;">3011</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BP12</td>
<td style="text-align: right;">1972</td>
</tr>
<tr class="even">
<td style="text-align: left;">BP13</td>
<td style="text-align: right;">982</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BP2</td>
<td style="text-align: right;">2757</td>
</tr>
<tr class="even">
<td style="text-align: left;">BP3</td>
<td style="text-align: right;">3988</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-44-contents" aria-controls="callout-44" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-44" class="callout-44-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We do not need <code>od_train</code> anymore as we already extracted the tap out data we need.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(od_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>The passenger data only has the <strong>train station code</strong>, but not the name. However, <code>train_exits</code> only have the <strong>station names</strong>, not the station code.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-45-contents" aria-controls="callout-45" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Recap of <em>train exits</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-45" class="callout-45-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(train_exits))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">stn_name</th>
<th style="text-align: left;">exit_code</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MACPHERSON MRT STATION</td>
<td style="text-align: left;">Exit A</td>
<td style="text-align: left;">POINT (34285.07 34322.99)</td>
</tr>
<tr class="even">
<td style="text-align: left;">MACPHERSON MRT STATION</td>
<td style="text-align: left;">Exit B</td>
<td style="text-align: left;">POINT (34382.15 34231.9)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MACPHERSON MRT STATION</td>
<td style="text-align: left;">Exit C</td>
<td style="text-align: left;">POINT (34337.29 34190.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">TONGKANG LRT STATION</td>
<td style="text-align: left;">Exit B</td>
<td style="text-align: left;">POINT (33872.15 41256.05)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TONGKANG LRT STATION</td>
<td style="text-align: left;">Exit A</td>
<td style="text-align: left;">POINT (33858.54 41234.07)</td>
</tr>
<tr class="even">
<td style="text-align: left;">RENJONG LRT STATION</td>
<td style="text-align: left;">Exit A</td>
<td style="text-align: left;">POINT (34353.45 40959.61)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p>Hence, we need way to connect the 2 datasets so we will use <em>Train Station Codes and Chinese Names</em> from <a href="https://datamall.lta.gov.sg/content/dam/datamall/datasets/PublicTransportRelated/Train%20Station%20Codes%20and%20Chinese%20Names.zip">LTA DataMall</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>station_codes_names <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/Train_Station_Codes_and_Chinese_Names.csv"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(station_codes_names))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">stn_code</th>
<th style="text-align: left;">mrt_station_english</th>
<th style="text-align: left;">mrt_station_chinese</th>
<th style="text-align: left;">mrt_line_english</th>
<th style="text-align: left;">mrt_line_chinese</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NS1</td>
<td style="text-align: left;">Jurong East</td>
<td style="text-align: left;">裕廊东</td>
<td style="text-align: left;">North-South Line</td>
<td style="text-align: left;">南北线</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS2</td>
<td style="text-align: left;">Bukit Batok</td>
<td style="text-align: left;">武吉巴督</td>
<td style="text-align: left;">North-South Line</td>
<td style="text-align: left;">南北线</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS3</td>
<td style="text-align: left;">Bukit Gombak</td>
<td style="text-align: left;">武吉甘柏</td>
<td style="text-align: left;">North-South Line</td>
<td style="text-align: left;">南北线</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS4</td>
<td style="text-align: left;">Choa Chu Kang</td>
<td style="text-align: left;">蔡厝港</td>
<td style="text-align: left;">North-South Line</td>
<td style="text-align: left;">南北线</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS5</td>
<td style="text-align: left;">Yew Tee</td>
<td style="text-align: left;">油池</td>
<td style="text-align: left;">North-South Line</td>
<td style="text-align: left;">南北线</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS7</td>
<td style="text-align: left;">Kranji</td>
<td style="text-align: left;">克兰芝</td>
<td style="text-align: left;">North-South Line</td>
<td style="text-align: left;">南北线</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We only need the station code and English names so we can remove the columns that are not needed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>station_codes_names <span class="ot">&lt;-</span> station_codes_names <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(stn_code, mrt_station_english)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="adjusting-data-columns" class="level4">
<h4 class="anchored" data-anchor-id="adjusting-data-columns">Adjusting data columns</h4>
<p>To connect <code>train_exits</code>, <code>station_code_names</code>, and <code>train_tap_out</code>, we need to make adjustments to the columns.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true"><em>station_code_names</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false"><em>od_train_trips</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false"><em>train_exits</em></a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(station_codes_names))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">stn_code</th>
<th style="text-align: left;">mrt_station_english</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NS1</td>
<td style="text-align: left;">Jurong East</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS2</td>
<td style="text-align: left;">Bukit Batok</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS3</td>
<td style="text-align: left;">Bukit Gombak</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS4</td>
<td style="text-align: left;">Choa Chu Kang</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS5</td>
<td style="text-align: left;">Yew Tee</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS7</td>
<td style="text-align: left;">Kranji</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We need to capitalize the station names as the names are capitalized in <code>train_exits</code>. We can use <code>toupper()</code> to accomplish this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>station_codes_names <span class="ot">&lt;-</span> station_codes_names <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stn_name =</span> <span class="fu">toupper</span>(mrt_station_english))</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(station_codes_names))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">stn_code</th>
<th style="text-align: left;">mrt_station_english</th>
<th style="text-align: left;">stn_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NS1</td>
<td style="text-align: left;">Jurong East</td>
<td style="text-align: left;">JURONG EAST</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS2</td>
<td style="text-align: left;">Bukit Batok</td>
<td style="text-align: left;">BUKIT BATOK</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS3</td>
<td style="text-align: left;">Bukit Gombak</td>
<td style="text-align: left;">BUKIT GOMBAK</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS4</td>
<td style="text-align: left;">Choa Chu Kang</td>
<td style="text-align: left;">CHOA CHU KANG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS5</td>
<td style="text-align: left;">Yew Tee</td>
<td style="text-align: left;">YEW TEE</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS7</td>
<td style="text-align: left;">Kranji</td>
<td style="text-align: left;">KRANJI</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(od_train_trips[<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>,]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">TRAIN_ST_CODE</th>
<th style="text-align: right;">TRIPS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">BP3</td>
<td style="text-align: right;">3988</td>
</tr>
<tr class="even">
<td style="text-align: left;">BP4</td>
<td style="text-align: right;">1752</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BP5</td>
<td style="text-align: right;">2324</td>
</tr>
<tr class="even">
<td style="text-align: left;">BP6/DT1</td>
<td style="text-align: right;">48165</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BP7</td>
<td style="text-align: right;">1120</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>There are multiple station codes in <code>TRAIN_ST_CODE</code> column, while in <code>station_codes_names</code>, the <code>stn_code</code> column only has 1 station code.</p>
<p>We have to separate these station codes into their own rows by using <code>separate_rows()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>od_train_trips <span class="ot">&lt;-</span> od_train_trips <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(TRAIN_ST_CODE, <span class="at">sep=</span><span class="st">"/"</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(od_train_trips[<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>,]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">TRAIN_ST_CODE</th>
<th style="text-align: right;">TRIPS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">BP3</td>
<td style="text-align: right;">3988</td>
</tr>
<tr class="even">
<td style="text-align: left;">BP4</td>
<td style="text-align: right;">1752</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BP5</td>
<td style="text-align: right;">2324</td>
</tr>
<tr class="even">
<td style="text-align: left;">BP6</td>
<td style="text-align: right;">48165</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DT1</td>
<td style="text-align: right;">48165</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><code>station_codes_names</code> and <code>od_train_trips</code> now have the number of rows so they can be mapped one-to-one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(station_codes_names) <span class="sc">==</span> <span class="fu">nrow</span>(od_train_trips)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(train_exits))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">stn_name</th>
<th style="text-align: left;">exit_code</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MACPHERSON MRT STATION</td>
<td style="text-align: left;">Exit A</td>
<td style="text-align: left;">POINT (34285.07 34322.99)</td>
</tr>
<tr class="even">
<td style="text-align: left;">MACPHERSON MRT STATION</td>
<td style="text-align: left;">Exit B</td>
<td style="text-align: left;">POINT (34382.15 34231.9)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MACPHERSON MRT STATION</td>
<td style="text-align: left;">Exit C</td>
<td style="text-align: left;">POINT (34337.29 34190.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">TONGKANG LRT STATION</td>
<td style="text-align: left;">Exit B</td>
<td style="text-align: left;">POINT (33872.15 41256.05)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TONGKANG LRT STATION</td>
<td style="text-align: left;">Exit A</td>
<td style="text-align: left;">POINT (33858.54 41234.07)</td>
</tr>
<tr class="even">
<td style="text-align: left;">RENJONG LRT STATION</td>
<td style="text-align: left;">Exit A</td>
<td style="text-align: left;">POINT (34353.45 40959.61)</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Station names in <code>train_exits</code> have <code>MRT STATION</code> or <code>LRT STATION</code> while <code>station_code_names</code> does not have.</p>
<p>We have to remove this part of the name so we can join the tables properly. We can use <code>sub()</code> to remove this part of the station name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>train_exits <span class="ot">&lt;-</span> train_exits <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stn_name_short =</span> <span class="fu">gsub</span>(<span class="st">" [ML]RT STATION$"</span> , <span class="st">""</span>, stn_name))</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(train_exits))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 31%">
<col style="width: 13%">
<col style="width: 35%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">stn_name</th>
<th style="text-align: left;">exit_code</th>
<th style="text-align: left;">geometry</th>
<th style="text-align: left;">stn_name_short</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MACPHERSON MRT STATION</td>
<td style="text-align: left;">Exit A</td>
<td style="text-align: left;">POINT (34285.07 34322.99)</td>
<td style="text-align: left;">MACPHERSON</td>
</tr>
<tr class="even">
<td style="text-align: left;">MACPHERSON MRT STATION</td>
<td style="text-align: left;">Exit B</td>
<td style="text-align: left;">POINT (34382.15 34231.9)</td>
<td style="text-align: left;">MACPHERSON</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MACPHERSON MRT STATION</td>
<td style="text-align: left;">Exit C</td>
<td style="text-align: left;">POINT (34337.29 34190.6)</td>
<td style="text-align: left;">MACPHERSON</td>
</tr>
<tr class="even">
<td style="text-align: left;">TONGKANG LRT STATION</td>
<td style="text-align: left;">Exit B</td>
<td style="text-align: left;">POINT (33872.15 41256.05)</td>
<td style="text-align: left;">TONGKANG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TONGKANG LRT STATION</td>
<td style="text-align: left;">Exit A</td>
<td style="text-align: left;">POINT (33858.54 41234.07)</td>
<td style="text-align: left;">TONGKANG</td>
</tr>
<tr class="even">
<td style="text-align: left;">RENJONG LRT STATION</td>
<td style="text-align: left;">Exit A</td>
<td style="text-align: left;">POINT (34353.45 40959.61)</td>
<td style="text-align: left;">RENJONG</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="adding-tap-out-information-to-exits" class="level4">
<h4 class="anchored" data-anchor-id="adding-tap-out-information-to-exits">Adding tap out information to exits</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Joining <em>station_code_names</em> and <em>od_train_trips</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Adding tap out to exits</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>We will join by the station code. Also, as some train stations have multiple station codes, we will remove the duplicates on the station name. This can be accomplished by selecting <code>stn_name</code> and <code>TRIPS</code> and applying <code>unique()</code>. It is safe to not include the station code here anymore as <code>trains_exits</code> does not have the station code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>od_train_trips_with_name <span class="ot">&lt;-</span> station_codes_names <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(od_train_trips,</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(stn_code <span class="sc">==</span> TRAIN_ST_CODE)) <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(stn_name, TRIPS) <span class="sc">%&gt;%</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(od_train_trips_with_name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">stn_name</th>
<th style="text-align: right;">TRIPS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">JURONG EAST</td>
<td style="text-align: right;">130709</td>
</tr>
<tr class="even">
<td style="text-align: left;">BUKIT BATOK</td>
<td style="text-align: right;">32809</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BUKIT GOMBAK</td>
<td style="text-align: right;">23429</td>
</tr>
<tr class="even">
<td style="text-align: left;">CHOA CHU KANG</td>
<td style="text-align: right;">48893</td>
</tr>
<tr class="odd">
<td style="text-align: left;">YEW TEE</td>
<td style="text-align: right;">33209</td>
</tr>
<tr class="even">
<td style="text-align: left;">KRANJI</td>
<td style="text-align: right;">29480</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>Next, we join <code>train_tap_out_with_names</code> with <code>train_exits</code> to finally add the tap information to exits.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>od_train_exits <span class="ot">&lt;-</span> train_exits <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(od_train_trips_with_name,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(stn_name_short <span class="sc">==</span> stn_name)) <span class="sc">%&gt;%</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">STN_NAME =</span> stn_name) <span class="sc">%&gt;%</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">EXIT_CODE =</span> exit_code) <span class="sc">%&gt;%</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(STN_NAME, EXIT_CODE, TRIPS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(od_train_exits))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">STN_NAME</th>
<th style="text-align: left;">EXIT_CODE</th>
<th style="text-align: right;">TRIPS</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MACPHERSON MRT STATION</td>
<td style="text-align: left;">Exit A</td>
<td style="text-align: right;">17282</td>
<td style="text-align: left;">POINT (34285.07 34322.99)</td>
</tr>
<tr class="even">
<td style="text-align: left;">MACPHERSON MRT STATION</td>
<td style="text-align: left;">Exit B</td>
<td style="text-align: right;">17282</td>
<td style="text-align: left;">POINT (34382.15 34231.9)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MACPHERSON MRT STATION</td>
<td style="text-align: left;">Exit C</td>
<td style="text-align: right;">17282</td>
<td style="text-align: left;">POINT (34337.29 34190.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">TONGKANG LRT STATION</td>
<td style="text-align: left;">Exit B</td>
<td style="text-align: right;">3136</td>
<td style="text-align: left;">POINT (33872.15 41256.05)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TONGKANG LRT STATION</td>
<td style="text-align: left;">Exit A</td>
<td style="text-align: right;">3136</td>
<td style="text-align: left;">POINT (33858.54 41234.07)</td>
</tr>
<tr class="even">
<td style="text-align: left;">RENJONG LRT STATION</td>
<td style="text-align: left;">Exit A</td>
<td style="text-align: right;">2506</td>
<td style="text-align: left;">POINT (34353.45 40959.61)</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We now have the number of tap outs from station, that we can use as propulsive variable on the exits.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>We will <strong>not distribute</strong> these trips to the number of exits as we cannot be accurate on the volume of people taking specific exits. We can consider the people tapping out from a station <strong>as potential passengers</strong> of bus stop from the nearby exits.</p>
</div>
</div>
</div>
</section>
<section id="aggregating-trips-by-hexagon-level" class="level4">
<h4 class="anchored" data-anchor-id="aggregating-trips-by-hexagon-level">Aggregating TRIPS by Hexagon level</h4>
<p>Finally, we can aggregate the trips on a hexagon level. We will do an <code>st_join()</code> of <code>honeycomb</code> and <code>tap_out_exit</code> as they are both of class <code>sf</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>od_train_hex <span class="ot">&lt;-</span> honeycomb <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(od_train_exits,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">left =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(HEX_ID) <span class="sc">%&gt;%</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TRIPS))</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(od_train_hex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">HEX_ID</th>
<th style="text-align: right;">TRIPS</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">H0028</td>
<td style="text-align: right;">6390</td>
<td style="text-align: left;">POLYGON ((6220.122 35142.35…</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0032</td>
<td style="text-align: right;">5962</td>
<td style="text-align: left;">POLYGON ((6595.122 34492.84…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0038</td>
<td style="text-align: right;">2676</td>
<td style="text-align: left;">POLYGON ((7345.122 33193.8,…</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0051</td>
<td style="text-align: right;">3290</td>
<td style="text-align: left;">POLYGON ((8845.122 33193.8,…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0065</td>
<td style="text-align: right;">23920</td>
<td style="text-align: left;">POLYGON ((10720.12 33843.32…</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0100</td>
<td style="text-align: right;">46780</td>
<td style="text-align: left;">POLYGON ((12970.12 35142.35…</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-46-contents" aria-controls="callout-46" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-46" class="callout-46-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s save <code>od_train_hex</code> as it contains the data for propulsiveness variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(od_train_hex, <span class="st">"data/rds/od_train_hex202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-47-contents" aria-controls="callout-47" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-47" class="callout-47-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We do not need the intermediate data used to derive <code>od_train_hex</code> so we can remove them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(train_exits)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(od_train_exits)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(od_train_trips)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(od_train_trips_with_name)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(station_codes_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="deriving-hdb-population" class="level3">
<h3 class="anchored" data-anchor-id="deriving-hdb-population">Deriving HDB population</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-48-contents" aria-controls="callout-48" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-48" class="callout-48-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can run from this point by loading these data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/mpsz.rds"</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>honeycomb <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/honeycomb.rds"</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>attractiveness <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/attractiveness_no_hdb.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Next, we will derive the population data for each zone. We will use aspatial dataset provided, <code>hdb.csv</code>.</p>
<p>We will initialize data to store <code>hdb_vars</code> from <code>honeycomb</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>hdb_vars <span class="ot">&lt;-</span> honeycomb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="importing-the-data" class="level4">
<h4 class="anchored" data-anchor-id="importing-the-data">Importing the data</h4>
<p>We will import the aspatial <code>hdb.csv</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>hdb_csv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/hdb.csv"</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(hdb_csv))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 6%">
<col style="width: 13%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">…1</th>
<th style="text-align: left;">blk_no</th>
<th style="text-align: left;">street</th>
<th style="text-align: right;">max_floor_lvl</th>
<th style="text-align: right;">year_completed</th>
<th style="text-align: left;">residential</th>
<th style="text-align: left;">commercial</th>
<th style="text-align: left;">market_hawker</th>
<th style="text-align: left;">miscellaneous</th>
<th style="text-align: left;">multistorey_carpark</th>
<th style="text-align: left;">precinct_pavilion</th>
<th style="text-align: left;">bldg_contract_town</th>
<th style="text-align: right;">total_dwelling_units</th>
<th style="text-align: right;">1room_sold</th>
<th style="text-align: right;">2room_sold</th>
<th style="text-align: right;">3room_sold</th>
<th style="text-align: right;">4room_sold</th>
<th style="text-align: right;">5room_sold</th>
<th style="text-align: right;">exec_sold</th>
<th style="text-align: right;">multigen_sold</th>
<th style="text-align: right;">studio_apartment_sold</th>
<th style="text-align: right;">1room_rental</th>
<th style="text-align: right;">2room_rental</th>
<th style="text-align: right;">3room_rental</th>
<th style="text-align: right;">other_room_rental</th>
<th style="text-align: right;">lat</th>
<th style="text-align: right;">lng</th>
<th style="text-align: left;">building</th>
<th style="text-align: left;">addr</th>
<th style="text-align: left;">postal</th>
<th style="text-align: right;">SUBZONE_NO</th>
<th style="text-align: left;">SUBZONE_N</th>
<th style="text-align: left;">SUBZONE_C</th>
<th style="text-align: left;">PLN_AREA_N</th>
<th style="text-align: left;">PLN_AREA_C</th>
<th style="text-align: left;">REGION_N</th>
<th style="text-align: left;">REGION_C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">BEACH RD</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">1970</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">KWN</td>
<td style="text-align: right;">142</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.295097</td>
<td style="text-align: right;">103.8541</td>
<td style="text-align: left;">RAFFLES HOTEL</td>
<td style="text-align: left;">1 BEACH ROAD RAFFLES HOTEL SINGAPORE 189673</td>
<td style="text-align: left;">189673</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">CITY HALL</td>
<td style="text-align: left;">DTSZ02</td>
<td style="text-align: left;">DOWNTOWN CORE</td>
<td style="text-align: left;">DT</td>
<td style="text-align: left;">CENTRAL REGION</td>
<td style="text-align: left;">CR</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">BEDOK STH AVE 1</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">1975</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">BD</td>
<td style="text-align: right;">206</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">204</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.320852</td>
<td style="text-align: right;">103.9337</td>
<td style="text-align: left;">NIL</td>
<td style="text-align: left;">1 BEDOK SOUTH AVENUE 1 SINGAPORE 460001</td>
<td style="text-align: left;">460001</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">BEDOK SOUTH</td>
<td style="text-align: left;">BDSZ06</td>
<td style="text-align: left;">BEDOK</td>
<td style="text-align: left;">BD</td>
<td style="text-align: left;">EAST REGION</td>
<td style="text-align: left;">ER</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">CANTONMENT RD</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2010</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">CT</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.275488</td>
<td style="text-align: right;">103.8414</td>
<td style="text-align: left;">PINNACLE @ DUXTON</td>
<td style="text-align: left;">1 CANTONMENT ROAD PINNACLE @ DUXTON SINGAPORE 080001</td>
<td style="text-align: left;">080001</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">CHINATOWN</td>
<td style="text-align: left;">OTSZ03</td>
<td style="text-align: left;">OUTRAM</td>
<td style="text-align: left;">OT</td>
<td style="text-align: left;">CENTRAL REGION</td>
<td style="text-align: left;">CR</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">CHAI CHEE RD</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">1982</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">BD</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.327969</td>
<td style="text-align: right;">103.9227</td>
<td style="text-align: left;">PING YI GARDENS</td>
<td style="text-align: left;">1 CHAI CHEE ROAD PING YI GARDENS SINGAPORE 461001</td>
<td style="text-align: left;">461001</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">KEMBANGAN</td>
<td style="text-align: left;">BDSZ03</td>
<td style="text-align: left;">BEDOK</td>
<td style="text-align: left;">BD</td>
<td style="text-align: left;">EAST REGION</td>
<td style="text-align: left;">ER</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">CHANGI VILLAGE RD</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1975</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">PRC</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.388610</td>
<td style="text-align: right;">103.9881</td>
<td style="text-align: left;">OCBC CHANGI VILLAGE ROAD - 7 ELEVEN</td>
<td style="text-align: left;">1 CHANGI VILLAGE ROAD OCBC CHANGI VILLAGE ROAD - 7 ELEVEN SINGAPORE 500001</td>
<td style="text-align: left;">500001</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">CHANGI POINT</td>
<td style="text-align: left;">CHSZ01</td>
<td style="text-align: left;">CHANGI</td>
<td style="text-align: left;">CH</td>
<td style="text-align: left;">EAST REGION</td>
<td style="text-align: left;">ER</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">DELTA AVE</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1982</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">BM</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.292075</td>
<td style="text-align: right;">103.8286</td>
<td style="text-align: left;">NIL</td>
<td style="text-align: left;">1 DELTA AVENUE SINGAPORE 160001</td>
<td style="text-align: left;">160001</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">BUKIT HO SWEE</td>
<td style="text-align: left;">BMSZ09</td>
<td style="text-align: left;">BUKIT MERAH</td>
<td style="text-align: left;">BM</td>
<td style="text-align: left;">CENTRAL REGION</td>
<td style="text-align: left;">CR</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Despite being an aspatial dataset, there are columns where we can derive geospatial data from, <code>lng</code> and <code>lat</code>.</p>
</div>
</div>
</div>
<p>We will first convert this to a <code>sf</code> data type, which uses <strong>WGS 84</strong> and transform it to <strong>SVY21</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>hdb_sf <span class="ot">&lt;-</span> hdb_csv <span class="sc">%&gt;%</span> <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lng"</span>, <span class="st">"lat"</span>),</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-49-contents" aria-controls="callout-49" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visual inspection
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-49" class="callout-49-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As we haven’t used this dataset before, we will do a quick visual inspection to check if the points are within Singapore.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"green"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(honeycomb) <span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"white"</span>, <span class="at">title =</span> <span class="st">"Hexagons"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Map of HDB Blocks in Singapore"</span>,</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(hdb_sf) <span class="sc">+</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.001</span>, <span class="at">title =</span> <span class="st">"HDB Blocks"</span>) <span class="sc">+</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="adding-hdb_count" class="level4">
<h4 class="anchored" data-anchor-id="adding-hdb_count">Adding <em>HDB_COUNT</em></h4>
<p>This variable will contain the number of <strong>HDB blocks</strong> in a zone. We will use the same methods to count the number locations in the zone, by using <code>lengths()</code> and <code>st_intersects()</code>.</p>
<p>We will use this as attractiveness variable, and will include all HDB block types (commercial, hawker, residential) as all of them are attractive destinations for eating out, meeting family/friends, and errands.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>hdb_vars<span class="sc">$</span>HDB_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hdb_vars, hdb_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will also add this back to <code>attractiveness</code> now that we have finally derived the value. We have to remove the geometry for <code>hdb_vars</code> to enable the join.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>attractiveness <span class="ot">&lt;-</span> <span class="fu">left_join</span>(attractiveness,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">st_drop_geometry</span>(hdb_vars))</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(attractiveness))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">HEX_ID</th>
<th style="text-align: right;">BUS_STOP_COUNT</th>
<th style="text-align: right;">ENTERTN_COUNT</th>
<th style="text-align: right;">F_AND_B_COUNT</th>
<th style="text-align: right;">LEISURE_COUNT</th>
<th style="text-align: right;">RETAIL_COUNT</th>
<th style="text-align: right;">TRAIN_EXITS_COUNT</th>
<th style="text-align: right;">HDB_COUNT</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">H0001</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">POLYGON ((3970.122 27348.13…</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0002</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">POLYGON ((4345.122 27997.65…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0003</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">POLYGON ((4345.122 30595.72…</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0004</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">POLYGON ((4720.122 28647.16…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0005</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">POLYGON ((4720.122 29946.2,…</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0006</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">POLYGON ((4720.122 31245.24…</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="removing-unnecessary-data" class="level4">
<h4 class="anchored" data-anchor-id="removing-unnecessary-data">Removing unnecessary data</h4>
<p>To derive the population, we will only retain the rows and columns relevant to our calculations.</p>
<p>We will only retain the <strong>residential</strong>, the <strong>total_dwelling_units</strong> column, and lastly, the geometry.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>hdb_filtered_sf <span class="ot">&lt;-</span> hdb_sf <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(residential <span class="sc">==</span> <span class="st">"Y"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(total_dwelling_units)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="adding-hdb_resident_count" class="level4">
<h4 class="anchored" data-anchor-id="adding-hdb_resident_count">Adding <em>HDB_RESIDENT_COUNT</em></h4>
<p>While <code>HDB_COUNT</code> can be a population proxy, we need to consider that HDB blocks have different sizes. For example, taller and wider blocks may have more units compared to shorter blocks, and therefore higher population.</p>
<p>As such, we will use <code>total_dwelling_units</code> multiplied by <strong>3.09</strong> to improve our population estimate.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-50-contents" aria-controls="callout-50" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Relevance of 3.09
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-50" class="callout-50-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>According to the <a href="https://www.singstat.gov.sg/find-data/search-by-theme/households/households/latest-data">2022 official statistics</a> from Department of Statistics, the average household size is <strong>3.09 person</strong>.</p>
<p>Although the HDBs have different unit sizes (1 to 5 bedroom), which can provide more accurate population estimate, we do not have data on how many people actually live in each so we will just use the average household size multiplied by dwellings.</p>
<p>We are not able to get a more accurate summary with the data available for us as there are also private residences (condos, landed properties) that are not contained in this dataset.</p>
</div>
</div>
</div>
<p>We need to aggregate the sum of <code>total_dwelling_units</code> per hexagon, and doing a <code>left_join()</code> with <code>hdb_vars</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>hdb_vars <span class="ot">&lt;-</span> hdb_vars <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_intersection</span>(hdb_filtered_sf, hdb_vars) <span class="sc">%&gt;%</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(HEX_ID) <span class="sc">%&gt;%</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">HDB_RESIDENT_COUNT =</span> <span class="fu">sum</span>(total_dwelling_units))</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(hdb_vars[<span class="dv">160</span><span class="sc">:</span><span class="dv">165</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 14%">
<col style="width: 26%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">HEX_ID</th>
<th style="text-align: right;">HDB_COUNT</th>
<th style="text-align: right;">HDB_RESIDENT_COUNT</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">160</td>
<td style="text-align: left;">H0160</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">POLYGON ((17095.12 31894.76…</td>
</tr>
<tr class="even">
<td style="text-align: left;">161</td>
<td style="text-align: left;">H0161</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">952</td>
<td style="text-align: left;">POLYGON ((17095.12 33193.8,…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">162</td>
<td style="text-align: left;">H0162</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">POLYGON ((17095.12 34492.84…</td>
</tr>
<tr class="even">
<td style="text-align: left;">163</td>
<td style="text-align: left;">H0163</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">3114</td>
<td style="text-align: left;">POLYGON ((17095.12 35791.87…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">164</td>
<td style="text-align: left;">H0164</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1136</td>
<td style="text-align: left;">POLYGON ((17095.12 37090.91…</td>
</tr>
<tr class="even">
<td style="text-align: left;">165</td>
<td style="text-align: left;">H0165</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">3652</td>
<td style="text-align: left;">POLYGON ((17095.12 39688.99…</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-51-contents" aria-controls="callout-51" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-51" class="callout-51-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s save <code>hdb_vars</code> as it contains the data for propulsiveness variable. We will also update <code>attractiveness</code> as we added <code>HDB_COUNT</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(hdb_vars, <span class="st">"data/rds/hdb_vars.rds"</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(attractiveness, <span class="st">"data/rds/attractiveness.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-52-contents" aria-controls="callout-52" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-52" class="callout-52-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We do not need the intermediate data used to derive <code>hdb_vars</code> anymore so we can remove them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(hdb_csv)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(hdb_sf)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(hdb_filtered_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="propulsiveness-variables" class="level3">
<h3 class="anchored" data-anchor-id="propulsiveness-variables">Propulsiveness variables</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-53-contents" aria-controls="callout-53" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-53" class="callout-53-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can run from this point by loading these data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>honeycomb <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/honeycomb.rds"</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>hdb_vars <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/hdb_vars.rds"</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>dest_bus_hex <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/dest_bus_hex202310.rds"</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>od_train_hex <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/od_train_hex202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>We will first initiate <code>propulsiveness</code> from <code>honeycomb</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>propulsiveness <span class="ot">&lt;-</span> honeycomb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will then add the passenger/population values we just derived by using a combination of <code>st_drop_geometry</code> and <code>left_join().</code></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">HDB</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Bus</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">Train</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>propulsiveness <span class="ot">&lt;-</span> propulsiveness <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">st_drop_geometry</span>(hdb_vars)) <span class="sc">%&gt;%</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(HEX_ID, HDB_RESIDENT_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>propulsiveness <span class="ot">&lt;-</span> propulsiveness <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">st_drop_geometry</span>(dest_bus_hex)) <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">BUS_ALIGHT_COUNT =</span> TRIPS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>propulsiveness <span class="ot">&lt;-</span> propulsiveness <span class="sc">%&gt;%</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">st_drop_geometry</span>(od_train_hex)) <span class="sc">%&gt;%</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">TRAIN_ALIGHT_COUNT =</span> TRIPS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>At this point, there are some <code>NA</code> values. As these are independent variables, we will set a value for them instead of excluding rows due to empty values. We will set them to <strong>0</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>propulsiveness[<span class="fu">is.na</span>(propulsiveness)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(propulsiveness))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 20%">
<col style="width: 18%">
<col style="width: 20%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">HEX_ID</th>
<th style="text-align: right;">HDB_RESIDENT_COUNT</th>
<th style="text-align: right;">BUS_ALIGHT_COUNT</th>
<th style="text-align: right;">TRAIN_ALIGHT_COUNT</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">H0001</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">POLYGON ((3970.122 27348.13…</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0002</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">POLYGON ((4345.122 27997.65…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0003</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">121</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">POLYGON ((4345.122 30595.72…</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0004</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">POLYGON ((4720.122 28647.16…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0005</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">152</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">POLYGON ((4720.122 29946.2,…</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0006</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">204</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">POLYGON ((4720.122 31245.24…</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-54-contents" aria-controls="callout-54" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-54" class="callout-54-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s save <code>propulsiveness</code> as it contains the data for propulsiveness variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(propulsiveness, <span class="st">"data/rds/propulsiveness202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-55-contents" aria-controls="callout-55" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-55" class="callout-55-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can now remove the data that we use to derive <code>propulsiveness</code> from the environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dest_bus_hex)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(hdb_vars)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(od_train_hex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="generating-distance-table" class="level3">
<h3 class="anchored" data-anchor-id="generating-distance-table">Generating distance table</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-56-contents" aria-controls="callout-56" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-56" class="callout-56-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can run from this point by loading these data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>honeycomb <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/honeycomb.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Now that we have the attractive and propulsive forces, we can finally prepare the data for the <strong>distance decay</strong> component of the model.</p>
<section id="generating-distance-matrix" class="level4">
<h4 class="anchored" data-anchor-id="generating-distance-matrix">Generating distance matrix</h4>
<p>We will use <code>spDists()</code> to generate the matrix from our <code>honeycomb</code>, which requires a <em>Spatial</em> data frame. We also need to name the columns and rows to the corresponding <code>HEX_ID</code> of the hexagons.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>dist_mat <span class="ot">&lt;-</span> <span class="fu">spDists</span>(<span class="fu">as</span>(honeycomb, <span class="st">"Spatial"</span>),</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dist_mat) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(honeycomb<span class="sc">$</span>HEX_ID)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dist_mat) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(honeycomb<span class="sc">$</span>HEX_ID)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(dist_mat, <span class="at">n=</span><span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">8</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">H0001</th>
<th style="text-align: right;">H0002</th>
<th style="text-align: right;">H0003</th>
<th style="text-align: right;">H0004</th>
<th style="text-align: right;">H0005</th>
<th style="text-align: right;">H0006</th>
<th style="text-align: right;">H0007</th>
<th style="text-align: right;">H0008</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">H0001</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">3269.174</td>
<td style="text-align: right;">1500.000</td>
<td style="text-align: right;">2704.163</td>
<td style="text-align: right;">3968.627</td>
<td style="text-align: right;">1299.038</td>
<td style="text-align: right;">2250.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0002</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2598.076</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">1984.313</td>
<td style="text-align: right;">3269.174</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">1500.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0003</td>
<td style="text-align: right;">3269.174</td>
<td style="text-align: right;">2598.076</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1984.313</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">2704.163</td>
<td style="text-align: right;">1500.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0004</td>
<td style="text-align: right;">1500.000</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">1984.313</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1299.038</td>
<td style="text-align: right;">2598.076</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">750.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0005</td>
<td style="text-align: right;">2704.163</td>
<td style="text-align: right;">1984.313</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">1299.038</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1299.038</td>
<td style="text-align: right;">1984.313</td>
<td style="text-align: right;">750.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0006</td>
<td style="text-align: right;">3968.627</td>
<td style="text-align: right;">3269.174</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">2598.076</td>
<td style="text-align: right;">1299.038</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">3269.174</td>
<td style="text-align: right;">1984.313</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0007</td>
<td style="text-align: right;">1299.038</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">2704.163</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">1984.313</td>
<td style="text-align: right;">3269.174</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1299.038</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0008</td>
<td style="text-align: right;">2250.000</td>
<td style="text-align: right;">1500.000</td>
<td style="text-align: right;">1500.000</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">750.000</td>
<td style="text-align: right;">1984.313</td>
<td style="text-align: right;">1299.038</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>As expected, many of the distances are <strong>multiples of 750</strong> as we set our hexagon size to 750m edge-to-edge. This also means that the distance between centroids of adjacent hexagons is <strong>750m</strong>.</p>
</div>
</div>
</div>
</section>
<section id="generating-a-pivot-table" class="level4">
<h4 class="anchored" data-anchor-id="generating-a-pivot-table">Generating a pivot table</h4>
<p>To generate data with the specifications we defined in <a href="#data-outputs">Data Outputs</a>, we must generate a pivot table from our distance matrix, <code>dist_mat</code>.</p>
<p>We will use <code>melt()</code>, for this purpose and rename the columns to names we defined in our modelling data shape.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>dist_tbl <span class="ot">&lt;-</span> <span class="fu">melt</span>(dist_mat) <span class="sc">%&gt;%</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DISTANCE =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ORIG_HEX_ID =</span> Var1) <span class="sc">%&gt;%</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DEST_HEX_ID =</span> Var2)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(dist_tbl))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ORIG_HEX_ID</th>
<th style="text-align: left;">DEST_HEX_ID</th>
<th style="text-align: right;">DISTANCE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">H0001</td>
<td style="text-align: left;">H0001</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0002</td>
<td style="text-align: left;">H0001</td>
<td style="text-align: right;">750.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0003</td>
<td style="text-align: left;">H0001</td>
<td style="text-align: right;">3269.174</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0004</td>
<td style="text-align: left;">H0001</td>
<td style="text-align: right;">1500.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0005</td>
<td style="text-align: left;">H0001</td>
<td style="text-align: right;">2704.163</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0006</td>
<td style="text-align: left;">H0001</td>
<td style="text-align: right;">3968.627</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="setting-intra-zonal-distances" class="level4">
<h4 class="anchored" data-anchor-id="setting-intra-zonal-distances">Setting intra-zonal distances</h4>
<p>Intra-zonal distances are currently <strong>0</strong>. This can be a result of passengers taking a short bus ride to the next stop. We have to set these to a value other than 0.</p>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-57-contents" aria-controls="callout-57" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why can’t we just keep them as 0?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-57" class="callout-57-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As we are going to use <strong>log-based Poisson regression models</strong>, <em>log</em> operations will be applied to all independent variables (including distance).</p>
<p><span class="math inline">\(log(0) = undefined\)</span> so we have to set it to a value <strong>greater than 0</strong>, as distances are <strong>positive</strong> in this context.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-58-contents" aria-controls="callout-58" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What do we use as intra-zonal distance? Answer: 200m
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-58" class="callout-58-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To consider the intra-zonal distance for this context, we need to consider why people board and alight within the same zone.</p>
<p>The most plausible explanation is people riding the bus to the immediate next stop. With this thought process, we can base the intra-zonal distance from some of the closest bus stops within the same route, <strong>School of the Arts</strong> (Stop ID: 08079) and <strong>Peace Ctr</strong> (Stop ID: 07011).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/sota_to_peace_ctr.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Bus routes like <a href="https://www.transitlink.com.sg/eservice/eguide/service_route.php?service=147"><strong>147</strong></a>and <a href="https://www.transitlink.com.sg/eservice/eguide/service_route.php?service=166"><strong>166</strong></a> pass by these bus stops so it is possible for the above scenario to happen here. As these may not be closest bus stops within the same route, we will round the value down to <strong>200m</strong>.</p>
</div>
</div>
</div>
<p>We will set the intra-zonal distances to <strong>200m</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>dist_tbl<span class="sc">$</span>DISTANCE[dist_tbl<span class="sc">$</span>ORIG_HEX_ID <span class="sc">==</span> dist_tbl<span class="sc">$</span>DEST_HEX_ID] <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dist_tbl<span class="sc">$</span>DISTANCE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    200    8250   13269   14119   18929   44680 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-59-contents" aria-controls="callout-59" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-59" class="callout-59-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s save <code>dist_tbl</code> as it contains the data for the distance decay component of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(dist_tbl, <span class="st">"data/rds/dist_tbl.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-60-contents" aria-controls="callout-60" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-60" class="callout-60-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can now remove the data that we use to derive <code>dist_tbl</code> from the environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dist_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="putting-everything-together" class="level3">
<h3 class="anchored" data-anchor-id="putting-everything-together">Putting everything together</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-61-contents" aria-controls="callout-61" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-61" class="callout-61-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will load saved data containing the components of the model data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>honeycomb <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/honeycomb.rds"</span>)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>flowlines <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/flowlines202310.rds"</span>)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>dist_tbl <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/dist_tbl.rds"</span>)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>attractiveness <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/attractiveness.rds"</span>)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>propulsiveness <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/propulsiveness202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Now that we have all the components, we will now generate the geospatial <code>data</code> that contains the following columns:</p>
<ul>
<li><p><code>ORIG_HEX_ID</code>: ID corresponding to the origin zone</p></li>
<li><p><code>DEST_HEX_ID</code>: ID corresponding to the destination zone</p></li>
<li><p><code>DISTANCE</code>: Distance between the (centroids of) origin and destination zones</p></li>
<li><p><code>TRIPS</code>: Number of bus trips between the origin and destination zones</p></li>
<li><p><code>DEST_*_COUNT</code>: Values from [Attractiveness Variables Table (attractiveness)]</p></li>
<li><p><code>ORIG_*_COUNT</code>: Values from [Propulsiveness Variables Table (propulsiveness)]</p></li>
<li><p>Geometry containing the flowlines</p></li>
</ul>
<p>We will join the tables to generate this data.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Flowlines</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Distance</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">Propulsive</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false">Attractive</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(flowlines))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ORIG_HEX_ID</th>
<th style="text-align: left;">DEST_HEX_ID</th>
<th style="text-align: right;">TRIPS</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">H0002</td>
<td style="text-align: left;">H0016</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">LINESTRING (4345.122 28430….</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0002</td>
<td style="text-align: left;">H0017</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">LINESTRING (4345.122 28430….</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0002</td>
<td style="text-align: left;">H0032</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">LINESTRING (4345.122 28430….</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0003</td>
<td style="text-align: left;">H0005</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">LINESTRING (4345.122 31028….</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0003</td>
<td style="text-align: left;">H0022</td>
<td style="text-align: right;">56</td>
<td style="text-align: left;">LINESTRING (4345.122 31028….</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0003</td>
<td style="text-align: left;">H0028</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">LINESTRING (4345.122 31028….</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><code>flowline</code> contains both the geometry of the flow lines and the <code>TRIPS</code> data so we will use it as the base of <code>SIM_data</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> flowlines</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p><code>dist_tbl</code> covers all the pairs of hexagons from <code>honeycomb</code>. We will do a <code>left_join()</code> with <code>SIM_data</code> so we are only left with the pairs that have flows between them</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(dist_tbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<p>Propulsive forces come from the origin zone so we will join <code>propulsiveness</code> with <code>SIM_data</code> on <code>ORIG_HEX_ID</code>. We will also add the <code>ORIG_</code> prefix to the columns added in by <code>propulsiveness</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  SIM_data,</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  propulsiveness <span class="sc">%&gt;%</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename_with</span>(<span class="sc">~</span><span class="fu">paste</span>(<span class="st">"ORIG_"</span>, .x, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-11-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<p>Attractive forces come from the destination zone so we will join <code>attractiveness</code> with <code>SIM_data</code> on <code>DEST_HEX_ID</code>. We will also add the <code>DEST_</code> prefix to the columns added in by <code>attractiveness</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  SIM_data,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  attractiveness <span class="sc">%&gt;%</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename_with</span>(<span class="sc">~</span><span class="fu">paste</span>(<span class="st">"DEST_"</span>, .x, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-62-contents" aria-controls="callout-62" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-62" class="callout-62-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can now remove the data that we use to derive <code>SIM_data</code> from the environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(attractiveness)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(propulsiveness)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dist_tbl)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(flowlines)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="finishing-touches" class="level3">
<h3 class="anchored" data-anchor-id="finishing-touches">Finishing touches</h3>
<p>Let’s take a look at our <code>SIM_data</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ORIG_HEX_ID     DEST_HEX_ID        TRIPS             DISTANCE    
 H0515  :  307   H0515  :  314   Min.   :    1.00   Min.   :  200  
 H0725  :  291   H0537  :  300   1st Qu.:    3.00   1st Qu.: 2704  
 H0518  :  285   H0527  :  297   Median :   12.00   Median : 5250  
 H0527  :  282   H0725  :  297   Mean   :   95.78   Mean   : 6118  
 H0488  :  278   H0518  :  290   3rd Qu.:   48.00   3rd Qu.: 8518  
 H0648  :  268   H0447  :  280   Max.   :12377.00   Max.   :24784  
 (Other):58124   (Other):58057                                     
 ORIG_HDB_RESIDENT_COUNT ORIG_BUS_ALIGHT_COUNT ORIG_TRAIN_ALIGHT_COUNT
 Min.   :   0            Min.   :     0        Min.   :      0        
 1st Qu.:   0            1st Qu.:  3459        1st Qu.:      0        
 Median : 932            Median :  8693        Median :      0        
 Mean   :1850            Mean   : 14147        Mean   :  59925        
 3rd Qu.:3351            3rd Qu.: 16757        3rd Qu.:  29508        
 Max.   :7946            Max.   :108111        Max.   :2229188        
                                                                      
 DEST_BUS_STOP_COUNT DEST_ENTERTN_COUNT DEST_F_AND_B_COUNT DEST_LEISURE_COUNT
 Min.   : 1.00       Min.   :0.0000     Min.   :  0.000    Min.   : 0.000    
 1st Qu.: 5.00       1st Qu.:0.0000     1st Qu.:  0.000    1st Qu.: 0.000    
 Median : 8.00       Median :0.0000     Median :  0.000    Median : 1.000    
 Mean   : 7.96       Mean   :0.3443     Mean   :  5.697    Mean   : 2.337    
 3rd Qu.:10.00       3rd Qu.:0.0000     3rd Qu.:  2.000    3rd Qu.: 3.000    
 Max.   :19.00       Max.   :9.0000     Max.   :133.000    Max.   :41.000    
                                                                             
 DEST_RETAIL_COUNT DEST_TRAIN_EXITS_COUNT DEST_HDB_COUNT  
 Min.   :   0.00   Min.   : 0.000         Min.   :  0.00  
 1st Qu.:   7.00   1st Qu.: 0.000         1st Qu.:  0.00  
 Median :  31.00   Median : 0.000         Median : 12.00  
 Mean   :  98.33   Mean   : 1.375         Mean   : 20.81  
 3rd Qu.: 110.00   3rd Qu.: 2.000         3rd Qu.: 36.00  
 Max.   :1678.00   Max.   :13.000         Max.   :103.00  
                                                          
          geometry    
 LINESTRING   :59835  
 epsg:3414    :    0  
 +proj=tmer...:    0  
                      
                      
                      
                      </code></pre>
</div>
</div>
<p>We will make finishing touches on <code>SIM_data</code>, so that they are compatible with modelling. We need to remove the 0’s as we will apply <em>log</em> function to them, which will result to <em>undefined</em>. We will set them to <strong>0.99</strong> so we are aware that <strong>.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>replace_zeroes <span class="ot">&lt;-</span> <span class="cf">function</span>(data, col_name) {</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  data[[col_name]][data[[col_name]] <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fl">0.99</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  data</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_zeroes</span>(<span class="st">"ORIG_HDB_RESIDENT_COUNT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_zeroes</span>(<span class="st">"ORIG_BUS_ALIGHT_COUNT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_zeroes</span>(<span class="st">"ORIG_TRAIN_ALIGHT_COUNT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_zeroes</span>(<span class="st">"DEST_ENTERTN_COUNT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_zeroes</span>(<span class="st">"DEST_F_AND_B_COUNT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_zeroes</span>(<span class="st">"DEST_LEISURE_COUNT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_zeroes</span>(<span class="st">"DEST_RETAIL_COUNT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_zeroes</span>(<span class="st">"DEST_TRAIN_EXITS_COUNT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_zeroes</span>(<span class="st">"DEST_HDB_COUNT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s check the data again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ORIG_HEX_ID     DEST_HEX_ID        TRIPS             DISTANCE    
 H0515  :  307   H0515  :  314   Min.   :    1.00   Min.   :  200  
 H0725  :  291   H0537  :  300   1st Qu.:    3.00   1st Qu.: 2704  
 H0518  :  285   H0527  :  297   Median :   12.00   Median : 5250  
 H0527  :  282   H0725  :  297   Mean   :   95.78   Mean   : 6118  
 H0488  :  278   H0518  :  290   3rd Qu.:   48.00   3rd Qu.: 8518  
 H0648  :  268   H0447  :  280   Max.   :12377.00   Max.   :24784  
 (Other):58124   (Other):58057                                     
 ORIG_HDB_RESIDENT_COUNT ORIG_BUS_ALIGHT_COUNT ORIG_TRAIN_ALIGHT_COUNT
 Min.   :   0.99         Min.   :     0.99     Min.   :      1        
 1st Qu.:   0.99         1st Qu.:  3459.00     1st Qu.:      1        
 Median : 932.00         Median :  8693.00     Median :      1        
 Mean   :1850.69         Mean   : 14146.88     Mean   :  59926        
 3rd Qu.:3351.00         3rd Qu.: 16757.00     3rd Qu.:  29508        
 Max.   :7946.00         Max.   :108111.00     Max.   :2229188        
                                                                      
 DEST_BUS_STOP_COUNT DEST_ENTERTN_COUNT DEST_F_AND_B_COUNT DEST_LEISURE_COUNT
 Min.   : 1.00       Min.   :0.990      Min.   :  0.990    Min.   : 0.990    
 1st Qu.: 5.00       1st Qu.:0.990      1st Qu.:  0.990    1st Qu.: 0.990    
 Median : 8.00       Median :0.990      Median :  0.990    Median : 1.000    
 Mean   : 7.96       Mean   :1.187      Mean   :  6.215    Mean   : 2.726    
 3rd Qu.:10.00       3rd Qu.:0.990      3rd Qu.:  2.000    3rd Qu.: 3.000    
 Max.   :19.00       Max.   :9.000      Max.   :133.000    Max.   :41.000    
                                                                             
 DEST_RETAIL_COUNT DEST_TRAIN_EXITS_COUNT DEST_HDB_COUNT  
 Min.   :   0.99   Min.   : 0.990         Min.   :  0.99  
 1st Qu.:   7.00   1st Qu.: 0.990         1st Qu.:  0.99  
 Median :  31.00   Median : 0.990         Median : 12.00  
 Mean   :  98.39   Mean   : 1.981         Mean   : 21.14  
 3rd Qu.: 110.00   3rd Qu.: 2.000         3rd Qu.: 36.00  
 Max.   :1678.00   Max.   :13.000         Max.   :103.00  
                                                          
          geometry    
 LINESTRING   :59835  
 epsg:3414    :    0  
 +proj=tmer...:    0  
                      
                      
                      
                      </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-63-contents" aria-controls="callout-63" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-63" class="callout-63-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s save <code>SIM_data</code> as it contains the data we need for our models. Take note that this contains <strong>intra-zonal pairs</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(SIM_data, <span class="st">"data/rds/SIM_data202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-64-contents" aria-controls="callout-64" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-64" class="callout-64-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We won’t need the <code>SIM_data</code> for a while so we can remove it from the environment. We will also remove the helper function <code>replace_zeroes()</code> as we don’t need it anymore.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(SIM_data)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(replace_zeroes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="visualizing-spatial-interactions" class="level1">
<h1>Visualizing Spatial Interactions</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-65-contents" aria-controls="callout-65" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-65" class="callout-65-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can start from this point by loading the relevant datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/mpsz.rds"</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>honeycomb <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/honeycomb.rds"</span>)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>flowlines <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/flowlines202310.rds"</span>)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/SIM_data202310.rds"</span>)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>propulsiveness <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/propulsiveness202310.rds"</span>)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>attractiveness <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/attractiveness.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<section id="visualizing-flow-lines-again" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-flow-lines-again">Visualizing flow lines again</h2>
<p>We already did initial visualization of the flow lines in <a href="#initial-inspection-of-the-flow-lines">Initial inspection of the flow lines</a>. However, there plot is very messy because of the number of lines.</p>
<p>We will remove intra-zonal flows to reduce the number of flow lines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>flowlines_no_intra <span class="ot">&lt;-</span> flowlines <span class="sc">%&gt;%</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ORIG_HEX_ID <span class="sc">!=</span> DEST_HEX_ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We need to look at the busiest zone pairs more closely so we will filter those with lower traffic.</p>
<p>We will use <code>quantile()</code> to find and appropriate cut-off number.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(flowlines_no_intra<span class="sc">$</span>TRIPS,</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     80%      90%      95%      99%     100% 
   66.00   171.00   376.25  1510.00 12377.00 </code></pre>
</div>
</div>
<p>Trying these values, showing <em>5%</em> of the flow lines revealed important details.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"green"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(honeycomb) <span class="sc">+</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"white"</span>, <span class="at">title =</span> <span class="st">"Hexagons"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(flowlines_no_intra <span class="sc">%&gt;%</span> <span class="fu">filter</span>(TRIPS <span class="sc">&gt;</span> <span class="dv">376</span>)) <span class="sc">+</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"TRIPS"</span>,</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>),</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">title.lwd =</span> <span class="st">"# of bus trips"</span>,</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Top 5% Bus Passenger flow for Weekends/Holidays 11 AM - 2PM (October 2023)"</span>,</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-119-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is notable that the thickest flow lines are for relatively short distances, like the bus rides to and from <strong>Woodlands Checkpoint</strong> to <strong>Kranji Station</strong>. We can notice these thick lines on busy zones where lines converge as well.</p>
<p>Although not as thick, we can notice longer long lines on the map. This can indicate people more willing to travel longer distances over the weekend for recreation and meeting family and friends. This also means that a location being close by is not the only motivator for people to visit a place. Spatial interaction model can reveal more patterns to this.</p>
</div>
</div>
</section>
<section id="sec-plotting-trips-vs-distance" class="level2">
<h2 class="anchored" data-anchor-id="sec-plotting-trips-vs-distance">Plotting <em>TRIPS</em> vs.&nbsp;<em>DISTANCE</em></h2>
<p>From the previous map, we can see that longer distances do not deter people from coming to a place. To verify that there is no correlation, let us plot the distance vs.&nbsp;the number vs trips.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(SIM_data,</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> DISTANCE, <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">376.25</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">20000</span>,</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">600</span>, <span class="at">label =</span> <span class="st">"95th percentile"</span>,</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1510</span>, <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">20000</span>,</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">1800</span>, <span class="at">label =</span> <span class="st">"99th percentile"</span>,</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Trips as a Function of Distance"</span>,</span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Distance (m)"</span>,</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Trips"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-120-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Plotting it in a <em>log</em> scale shows a more linear relationship.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(SIM_data,</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(DISTANCE), <span class="at">y =</span> <span class="fu">log</span>(TRIPS))) <span class="sc">+</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <em>maximum number of trips</em> <strong>exponentially decrease</strong> as the distance increases, which means that generally, the farther the distance, the less trips there are.</p>
<p>However, some outliers can be observed like some zone pairs with almost 20km distance between them having close to 99th percentile of <code>TRIP</code> values. In these zone pairs, there could be strong propulsive or attractive forces attracting passengers to ride the bus between those zones.</p>
</div>
</div>
<p>In <strong>doubly constrained model</strong>, we will observe this relationship more closely as we will build the model <strong>without attractive and propulsive</strong> forces.</p>
</section>
<section id="visualizing-propulsive-forces" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-propulsive-forces">Visualizing propulsive forces</h2>
<p>We will plot the propulsive forces in their own choropleth maps so we can see if the top 5% busiest flows correspond to areas we hypothesize to have high propulsive forces, of influence the number of trips started from the origin.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>We will use tabsets so that we can compare each map by switching tabs.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-68-contents" aria-controls="callout-68" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Helper function
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-68" class="callout-68-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will use the following function to plot the maps in this section.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>plot_propulsive <span class="ot">&lt;-</span> <span class="cf">function</span>(var_name, title_comp) {</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"green"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>) <span class="sc">+</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding this layer underneath propulsiveness as we removed 0s. from the map</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># so it won't skew the legend</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(honeycomb) <span class="sc">+</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(propulsiveness <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">if_any</span>(var_name, <span class="sc">~</span>. <span class="sc">&gt;=</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(var_name, <span class="at">palette =</span> <span class="st">"Blues"</span>, <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(flowlines_no_intra <span class="sc">%&gt;%</span> <span class="fu">filter</span>(TRIPS <span class="sc">&gt;</span> <span class="dv">376</span>)) <span class="sc">+</span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"TRIPS"</span>,</span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">title.lwd =</span> <span class="st">"# of bus trips"</span>,</span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Top 5% Bus Passenger Flows and"</span>, title_comp),</span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">bg.color =</span> <span class="st">"white"</span>,</span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">bg.alpha =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb138-33"><a href="#cb138-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_credits</span>(<span class="st">"*Passenger data from weekend/holidays 11AM - 2PM</span><span class="sc">\n</span><span class="st">(October 2023)"</span>,</span>
<span id="cb138-34"><a href="#cb138-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb138-35"><a href="#cb138-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"bottom"</span>))</span>
<span id="cb138-36"><a href="#cb138-36" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">HDB Residents</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Transfers from Train</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">Transfers from Bus</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_propulsive</span>(<span class="st">"HDB_RESIDENT_COUNT"</span>, <span class="st">"HDB Population"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-123-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_propulsive</span>(<span class="st">"TRAIN_ALIGHT_COUNT"</span>, <span class="st">"Potential Transfers from Train"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-124-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_propulsive</span>(<span class="st">"BUS_ALIGHT_COUNT"</span>, <span class="st">"Potential Transfers from Bus"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-125-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights
</div>
</div>
<div class="callout-body-container callout-body">
<p>Upon visual inspection, HDB population and bus alights from zones correspond more closely with our flowlines. Residential areas have a lot of potential passengers in those areas.</p>
<p>There are less train station exits than bus stops but it can be observed that flowlines also converge on some zones where train stations are.</p>
<p>Lastly, we get bus alight data from the same data source or flowlines so they are expected to correspond more closely. We should be aware that flow line includes the <strong>destination</strong> so the correspondence may due on the destination, not the origin as we hypothesized.</p>
</div>
</div>
<p>In <strong>destination constrained model</strong>, the effects of propulsive forces will be highlighted as we will model the interaction <strong>without the attractive forces</strong>.</p>
</section>
<section id="visualizing-attractive-forces" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-attractive-forces">Visualizing attractive forces</h2>
<p>We will plot the attractive forces in their own choropleth maps so we can see if the top 5% busiest flows correspond to areas we hypothesize have high attractive forces, influencing passengers to make trip to those zonoe..</p>
<p>We will use tabsets so that we can compare each map by switching tabs.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-70-contents" aria-controls="callout-70" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Helper function
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-70" class="callout-70-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will use the following function to plot the maps in this section.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>plot_attractive <span class="ot">&lt;-</span> <span class="cf">function</span>(var_name, title_comp) {</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"green"</span>, <span class="at">title =</span> <span class="st">"Singapore Boundary"</span>) <span class="sc">+</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding this layer underneath attractiveness as we removed 0s. from the map</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># so it won't skew the legend</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(honeycomb) <span class="sc">+</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(attractiveness <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">if_any</span>(var_name, <span class="sc">~</span>. <span class="sc">&gt;=</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(var_name, <span class="at">palette =</span> <span class="st">"Purples"</span>, <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(flowlines_no_intra <span class="sc">%&gt;%</span> <span class="fu">filter</span>(TRIPS <span class="sc">&gt;</span> <span class="dv">376</span>)) <span class="sc">+</span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"TRIPS"</span>,</span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">title.lwd =</span> <span class="st">"# of bus trips"</span>,</span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Top 5% Bus Passenger Flows and"</span>, title_comp),</span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.0</span>,</span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-29"><a href="#cb142-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb142-30"><a href="#cb142-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">bg.color =</span> <span class="st">"white"</span>,</span>
<span id="cb142-31"><a href="#cb142-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">bg.alpha =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb142-32"><a href="#cb142-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb142-33"><a href="#cb142-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_credits</span>(<span class="st">"*Passenger data from weekend/holidays 11AM - 2PM</span><span class="sc">\n</span><span class="st">(October 2023)"</span>,</span>
<span id="cb142-34"><a href="#cb142-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">bg.color =</span> <span class="st">"white"</span>, <span class="at">bg.alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb142-35"><a href="#cb142-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"bottom"</span>))</span>
<span id="cb142-36"><a href="#cb142-36" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Bus Stops</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Train Stations</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">HDBs</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false">Entertainment</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-5" role="tab" aria-controls="tabset-13-5" aria-selected="false">F&amp;B</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-6" role="tab" aria-controls="tabset-13-6" aria-selected="false">Leisure &amp; Recreaction</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-7" role="tab" aria-controls="tabset-13-7" aria-selected="false">Retail</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_attractive</span>(<span class="st">"BUS_STOP_COUNT"</span>, <span class="st">"Number of Bus Stops"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-127-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_attractive</span>(<span class="st">"TRAIN_EXITS_COUNT"</span>, <span class="st">"Number of Train Stations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-128-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_attractive</span>(<span class="st">"HDB_COUNT"</span>, <span class="st">"Number of HDB blocks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-129-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_attractive</span>(<span class="st">"ENTERTN_COUNT"</span>, <span class="st">"Number of Entertainment Locations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-130-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_attractive</span>(<span class="st">"F_AND_B_COUNT"</span>, <span class="st">"Number of F&amp;B Outlets"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-131-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_attractive</span>(<span class="st">"LEISURE_COUNT"</span>, <span class="st">"Number of Leisure &amp; Recreation Locations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-132-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_attractive</span>(<span class="st">"RETAIL_COUNT"</span>, <span class="st">"Number of Retail Outlets"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-133-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are less location types than the others, like entertainment and leisure locations.</p>
<p>There are also location types that are heavily concentrated in some zones, like the entertainment and F&amp;B, which are heavily concentrated around the <strong>Orchard area</strong>. Conversely, there are much less HDBs in Orchard area. Even though the flowlines are not thick in this area, there are many flowlines, although thin. This means people are coming from various parts of Singapore.</p>
</div>
</div>
<p>In <strong>origin constrained model</strong>, the effects of attractive forces will be highlighted as we will model the interaction <strong>without the propulsive forces</strong>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-72-contents" aria-controls="callout-72" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-72" class="callout-72-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s save <code>flowlines_no_intra</code> as we will use it for modelling,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(SIM_data, <span class="st">"data/rds/flowlines_no_intra202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-73-contents" aria-controls="callout-73" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-73" class="callout-73-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will clear the data we do not need for the Spatial Interaction Modelling.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(flowlines)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(attractiveness)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(propulsiveness)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(plot_attractive)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(plot_propulsive)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="spatial-interaction-modelling-3" class="level1">
<h1>Spatial Interaction Modelling</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-74-contents" aria-controls="callout-74" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-74" class="callout-74-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can start from this point by loading the relevant datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/SIM_data202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>For our spatial interaction modelling, we will use <em>log-</em>based Poisson gravity models. There are 4 components in our models:</p>
<ul>
<li><p><strong>attractive forces</strong>: forces that influence bus passengers to alight at a bus stops</p></li>
<li><p><strong>propulsive forces</strong>: forces that influence bus passengers to board from specific bus stops</p></li>
<li><p><strong>distance decay</strong>: this corresponds to the cost of making the trip. In theory, the longer the distance to travel, the less appealing a trip is.</p></li>
<li><p><strong>trips</strong>: this is the dependent variable and what we want to model.</p></li>
</ul>
<p>As we generate the models, we will compare the <strong>actual value</strong> of the trips (from the data we have processed so far) with the values that the models generate.</p>
<section id="about-the-models" class="level2">
<h2 class="anchored" data-anchor-id="about-the-models">About the models</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">Unconstrained</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Origin constrained</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">Destination constrained</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false">Doubly constrained</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<p>This will model the <code>TRIPS</code> using all the idependent model components — attractive forces, propulsive forces, distance decay.</p>
<p>In this model, we will see if all the forces we identified influence the number of trips made between zone pairs.</p>
<p>The general formula is:</p>
<p><span class="math display">\[
\lambda_{ij} = exp(k + \mu lnV_i + \alpha lnW_j + \beta ln d_{ij})
\]</span></p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><span class="math inline">\(\lambda_{ij}\)</span>: Independent variable, corresponding to <code>TRIPS</code> in our context</p>
<p><span class="math inline">\(\mu lnV_i\)</span>: Propulsive forces (unconstrained)</p>
<p><span class="math inline">\(\alpha lnW_j\)</span>: Attractive forces (unconstrained)</p>
<p><span class="math inline">\(\beta ln d_{ij}\)</span>: Distance decay</p>
</div>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<p>This will model the <code>TRIPS</code> <strong>without the attractive forces</strong>.</p>
<p>In this model, we will see the highlighted effects of the propulsive forces.</p>
<p>The general formula is:</p>
<p><span class="math display">\[
\lambda_{ij} = exp(k + \mu_i + \alpha lnW_j + \beta ln d_{ij})
\]</span></p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><span class="math inline">\(\lambda_{ij}\)</span>: Independent variable, corresponding to <code>TRIPS</code> in our context</p>
<p><span class="math inline">\(\mu_i\)</span>: Propulsive parameter (constrained)</p>
<p><span class="math inline">\(\alpha lnW_j\)</span>: Attractive forces (unconstrained)</p>
<p><span class="math inline">\(\beta ln d_{ij}\)</span>: Distance decay</p>
</div>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<p>This will model the <code>TRIPS</code> <strong>without the propulsive forces</strong>.</p>
<p>In this model, we will see the highlighted effects of the attractive forces.</p>
<p>The general formula is:</p>
<p><span class="math display">\[
\lambda_{ij} = exp(k + \mu lnV_i + \alpha_j + \beta ln d_{ij})
\]</span></p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><span class="math inline">\(\lambda_{ij}\)</span>: Independent variable, corresponding to <code>TRIPS</code> in our context</p>
<p><span class="math inline">\(\mu lnV_i\)</span>: Propulsive forces (unconstrained)</p>
<p><span class="math inline">\(\alpha_j\)</span>: Attractive parameter (constrained)</p>
<p><span class="math inline">\(\beta ln d_{ij}\)</span>: Distance decay</p>
</div>
</div>
</div>
</div>
<div id="tabset-14-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<p>This will model the <code>TRIPS</code> <strong>without the attractive and propulsive forces</strong>.</p>
<p>In this model, we will see the effects of the distance alone to the trips.</p>
<p>The general formula is:</p>
<p><span class="math display">\[
\lambda_{ij} = exp(k + \mu_i + \alpha_j + \beta ln d_{ij})
\]</span></p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><span class="math inline">\(\lambda_{ij}\)</span>: Independent variable, corresponding to <code>TRIPS</code> in our context</p>
<p><span class="math inline">\(\mu_i\)</span>: Propulsive parameter (constrained)</p>
<p><span class="math inline">\(\alpha_j\)</span>: Attractive parameter (constrained)</p>
<p><span class="math inline">\(\beta ln d_{ij}\)</span>: Distance decay</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="generating-the-models" class="level2">
<h2 class="anchored" data-anchor-id="generating-the-models">Generating the models</h2>
<p>Using the formula we defined above, we will generate the models based on <code>SIM_data</code>. We will use <code>glm()</code> which generate linear models, specifying <code>family = poisson</code> as we are using Poisson gravity models.</p>
<p>First, we need to <strong>remove intra-zonal zones pairs</strong> from <code>SIM_data</code> as it currently includes those.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>SIM_data_no_intra <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ORIG_HEX_ID <span class="sc">!=</span> DEST_HEX_ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will check the coefficients for each explanatory variable to see if the relationships (whether attractive or propulsive is as we hypothesized.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>It is quite expensive to generate these models so we will save them right after generation. <code>eval</code> is set to <code>false</code> by default on these code chunks.</p>
<p>We will trigger these code chunks manually if we want to regenerate the files.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">Unconstrained</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Origin constrained</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">Destination constrained</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false">Doubly constrained</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>uncSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIG_HDB_RESIDENT_COUNT) <span class="sc">+</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIG_BUS_ALIGHT_COUNT) <span class="sc">+</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIG_TRAIN_ALIGHT_COUNT) <span class="sc">+</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_BUS_STOP_COUNT) <span class="sc">+</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_ENTERTN_COUNT) <span class="sc">+</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_F_AND_B_COUNT) <span class="sc">+</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_LEISURE_COUNT) <span class="sc">+</span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_RETAIL_COUNT) <span class="sc">+</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_TRAIN_EXITS_COUNT) <span class="sc">+</span></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_HDB_COUNT) <span class="sc">+</span></span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DISTANCE),</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data_no_intra,</span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(uncSIM, <span class="st">"data/rds/uncSIM202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Coefficients for our explanatory variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>uncSIM <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/uncSIM202310.rds"</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">tail</span>(uncSIM<span class="sc">$</span>coefficients, <span class="at">n =</span> <span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">log(ORIG_HDB_RESIDENT_COUNT)</td>
<td style="text-align: right;">0.0145926</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(ORIG_BUS_ALIGHT_COUNT)</td>
<td style="text-align: right;">0.6199899</td>
</tr>
<tr class="odd">
<td style="text-align: left;">log(ORIG_TRAIN_ALIGHT_COUNT)</td>
<td style="text-align: right;">-0.0179809</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(DEST_BUS_STOP_COUNT)</td>
<td style="text-align: right;">0.2193359</td>
</tr>
<tr class="odd">
<td style="text-align: left;">log(DEST_ENTERTN_COUNT)</td>
<td style="text-align: right;">-0.0712323</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(DEST_F_AND_B_COUNT)</td>
<td style="text-align: right;">-0.0300056</td>
</tr>
<tr class="odd">
<td style="text-align: left;">log(DEST_LEISURE_COUNT)</td>
<td style="text-align: right;">-0.0834338</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(DEST_RETAIL_COUNT)</td>
<td style="text-align: right;">0.1213487</td>
</tr>
<tr class="odd">
<td style="text-align: left;">log(DEST_TRAIN_EXITS_COUNT)</td>
<td style="text-align: right;">0.5843653</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(DEST_HDB_COUNT)</td>
<td style="text-align: right;">0.1857971</td>
</tr>
<tr class="odd">
<td style="text-align: left;">log(DISTANCE)</td>
<td style="text-align: right;">-1.4838140</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-75-contents" aria-controls="callout-75" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Full model output
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-75" class="callout-75-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>uncSIM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = TRIPS ~ log(ORIG_HDB_RESIDENT_COUNT) + log(ORIG_BUS_ALIGHT_COUNT) + 
    log(ORIG_TRAIN_ALIGHT_COUNT) + log(DEST_BUS_STOP_COUNT) + 
    log(DEST_ENTERTN_COUNT) + log(DEST_F_AND_B_COUNT) + log(DEST_LEISURE_COUNT) + 
    log(DEST_RETAIL_COUNT) + log(DEST_TRAIN_EXITS_COUNT) + log(DEST_HDB_COUNT) + 
    log(DISTANCE), family = poisson(link = "log"), data = SIM_data_no_intra, 
    na.action = na.exclude)

Coefficients:
                 (Intercept)  log(ORIG_HDB_RESIDENT_COUNT)  
                     9.13202                       0.01459  
  log(ORIG_BUS_ALIGHT_COUNT)  log(ORIG_TRAIN_ALIGHT_COUNT)  
                     0.61999                      -0.01798  
    log(DEST_BUS_STOP_COUNT)       log(DEST_ENTERTN_COUNT)  
                     0.21934                      -0.07123  
     log(DEST_F_AND_B_COUNT)       log(DEST_LEISURE_COUNT)  
                    -0.03001                      -0.08343  
      log(DEST_RETAIL_COUNT)   log(DEST_TRAIN_EXITS_COUNT)  
                     0.12135                       0.58437  
         log(DEST_HDB_COUNT)                 log(DISTANCE)  
                     0.18580                      -1.48381  

Degrees of Freedom: 59275 Total (i.e. Null);  59264 Residual
Null Deviance:      19980000 
Residual Deviance: 7198000  AIC: 7466000</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="insights-5" class="level4 callout-tips" data-collapse="true" data-appearance="minimal">
<h4 class="anchored" data-anchor-id="insights-5">Insights</h4>
<p><code>ORIG_TRAIN_ALIGHT_COUNT</code>, <code>DEST_ENTERTN_COUNT</code>, and <code>DEST_LEISURE_COUNT</code> have <strong>negative</strong> coefficients.</p>
<p>This can mean that instead of having a propulsive effect on bus trips, <code>ORIG_TRAIN_ALIGHT_COUNT</code> has the opposite effect, i.e., the more people alighting from the train, the less bus trips there are. It is quite contradictory and counter-intuitive from the hypothesis we had that it will influence more bus rides as there are more potential passengers.</p>
<p>The same goes for <code>DEST_ENTERTN_COUNT</code>, and <code>DEST_LEISURE_COUNT</code> in terms of attractive forces.</p>
<p>In the <strong>origin constrained</strong> and <strong>destination constrained</strong> models, we will confirm if this pattern is consistent.</p>
</section>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>orcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>                ORIG_HEX_ID <span class="sc">+</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_BUS_STOP_COUNT) <span class="sc">+</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_ENTERTN_COUNT) <span class="sc">+</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_F_AND_B_COUNT) <span class="sc">+</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_LEISURE_COUNT) <span class="sc">+</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_RETAIL_COUNT) <span class="sc">+</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_TRAIN_EXITS_COUNT) <span class="sc">+</span></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DEST_HDB_COUNT) <span class="sc">+</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DISTANCE),</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data_no_intra,</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(orcSIM, <span class="st">"data/rds/orcSIM202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Coefficients for our explanatory variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>orcSIM <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/orcSIM202310.rds"</span>)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">tail</span>(orcSIM<span class="sc">$</span>coefficients, <span class="at">n=</span><span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">log(DEST_BUS_STOP_COUNT)</td>
<td style="text-align: right;">0.1652865</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(DEST_ENTERTN_COUNT)</td>
<td style="text-align: right;">-0.0870175</td>
</tr>
<tr class="odd">
<td style="text-align: left;">log(DEST_F_AND_B_COUNT)</td>
<td style="text-align: right;">0.0098688</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(DEST_LEISURE_COUNT)</td>
<td style="text-align: right;">-0.0160531</td>
</tr>
<tr class="odd">
<td style="text-align: left;">log(DEST_RETAIL_COUNT)</td>
<td style="text-align: right;">0.1646430</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(DEST_TRAIN_EXITS_COUNT)</td>
<td style="text-align: right;">0.5947195</td>
</tr>
<tr class="odd">
<td style="text-align: left;">log(DEST_HDB_COUNT)</td>
<td style="text-align: right;">0.1840518</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(DISTANCE)</td>
<td style="text-align: right;">-1.4956178</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-76-contents" aria-controls="callout-76" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Full model output
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-76" class="callout-76-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>orcSIM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = TRIPS ~ ORIG_HEX_ID + log(DEST_BUS_STOP_COUNT) + 
    log(DEST_ENTERTN_COUNT) + log(DEST_F_AND_B_COUNT) + log(DEST_LEISURE_COUNT) + 
    log(DEST_RETAIL_COUNT) + log(DEST_TRAIN_EXITS_COUNT) + log(DEST_HDB_COUNT) + 
    log(DISTANCE), family = poisson(link = "log"), data = SIM_data_no_intra, 
    na.action = na.exclude)

Coefficients:
                (Intercept)             ORIG_HEX_IDH0003  
                  13.239370                     0.581421  
           ORIG_HEX_IDH0004             ORIG_HEX_IDH0005  
                  -0.543051                     1.410644  
           ORIG_HEX_IDH0006             ORIG_HEX_IDH0007  
                  -0.252447                     0.880993  
           ORIG_HEX_IDH0008             ORIG_HEX_IDH0009  
                   1.973396                     2.494808  
           ORIG_HEX_IDH0010             ORIG_HEX_IDH0011  
                  -1.176420                     0.606645  
           ORIG_HEX_IDH0012             ORIG_HEX_IDH0013  
                   0.799229                     1.347020  
           ORIG_HEX_IDH0014             ORIG_HEX_IDH0015  
                   3.449320                    -0.616269  
           ORIG_HEX_IDH0016             ORIG_HEX_IDH0017  
                   2.745581                     1.398921  
           ORIG_HEX_IDH0018             ORIG_HEX_IDH0019  
                   0.341135                     0.729546  
           ORIG_HEX_IDH0020             ORIG_HEX_IDH0021  
                  -0.172340                    -0.042274  
           ORIG_HEX_IDH0022             ORIG_HEX_IDH0023  
                  -0.151724                     3.520822  
           ORIG_HEX_IDH0024             ORIG_HEX_IDH0025  
                   1.053763                     0.556302  
           ORIG_HEX_IDH0026             ORIG_HEX_IDH0027  
                   0.839167                     1.403748  
           ORIG_HEX_IDH0028             ORIG_HEX_IDH0029  
                  -1.378708                     0.060454  
           ORIG_HEX_IDH0030             ORIG_HEX_IDH0031  
                   1.547247                    -0.234317  
           ORIG_HEX_IDH0032             ORIG_HEX_IDH0033  
                  -0.536943                     1.247681  
           ORIG_HEX_IDH0034             ORIG_HEX_IDH0035  
                   0.470901                    -0.255768  
           ORIG_HEX_IDH0036             ORIG_HEX_IDH0037  
                  -0.699266                     0.424776  
           ORIG_HEX_IDH0038             ORIG_HEX_IDH0039  
                   0.197185                     0.778262  
           ORIG_HEX_IDH0040             ORIG_HEX_IDH0041  
                   0.854449                    -0.340189  
           ORIG_HEX_IDH0042             ORIG_HEX_IDH0043  
                  -0.012863                     1.035740  
           ORIG_HEX_IDH0044             ORIG_HEX_IDH0045  
                  -1.130918                     0.227737  
           ORIG_HEX_IDH0046             ORIG_HEX_IDH0047  
                   2.257653                     0.661800  
           ORIG_HEX_IDH0048             ORIG_HEX_IDH0049  
                   0.414596                    -0.552703  
           ORIG_HEX_IDH0050             ORIG_HEX_IDH0051  
                   0.388262                    -0.310583  
           ORIG_HEX_IDH0052             ORIG_HEX_IDH0053  
                   0.612552                     1.035032  
           ORIG_HEX_IDH0054             ORIG_HEX_IDH0055  
                   0.447089                     1.964760  
           ORIG_HEX_IDH0056             ORIG_HEX_IDH0057  
                   0.859333                     0.462880  
           ORIG_HEX_IDH0058             ORIG_HEX_IDH0059  
                   1.362463                     0.440691  
           ORIG_HEX_IDH0060             ORIG_HEX_IDH0061  
                   1.219319                     0.105014  
           ORIG_HEX_IDH0062             ORIG_HEX_IDH0063  
                  -1.016509                     1.514194  
           ORIG_HEX_IDH0064             ORIG_HEX_IDH0065  
                   1.586848                     1.900607  
           ORIG_HEX_IDH0066             ORIG_HEX_IDH0067  
                   1.190218                     1.998433  
           ORIG_HEX_IDH0068             ORIG_HEX_IDH0069  
                  -0.605354                     0.514030  
           ORIG_HEX_IDH0070             ORIG_HEX_IDH0071  
                  -0.129095                     1.144009  
           ORIG_HEX_IDH0072             ORIG_HEX_IDH0073  
                   1.402911                     0.453344  
           ORIG_HEX_IDH0074             ORIG_HEX_IDH0075  
                  -0.795977                    -0.474581  
           ORIG_HEX_IDH0076             ORIG_HEX_IDH0077  
                   1.547330                     1.033363  
           ORIG_HEX_IDH0079             ORIG_HEX_IDH0080  
                   0.997395                    -0.236272  
           ORIG_HEX_IDH0081             ORIG_HEX_IDH0082  
                   2.285880                     2.195524  
           ORIG_HEX_IDH0084             ORIG_HEX_IDH0085  
                  -0.088427                    -2.739095  
           ORIG_HEX_IDH0086             ORIG_HEX_IDH0087  
                   0.924769                     0.903994  
           ORIG_HEX_IDH0088             ORIG_HEX_IDH0089  
                  -2.098199                     1.305281  
           ORIG_HEX_IDH0090             ORIG_HEX_IDH0091  
                   0.348550                     1.053456  
           ORIG_HEX_IDH0092             ORIG_HEX_IDH0093  
                  -0.170532                     2.541419  
           ORIG_HEX_IDH0094             ORIG_HEX_IDH0095  
                  -0.213161                     0.960126  
           ORIG_HEX_IDH0096             ORIG_HEX_IDH0097  
                  -0.833135                     0.266589  
           ORIG_HEX_IDH0098             ORIG_HEX_IDH0099  
                   0.728541                     0.178937  
           ORIG_HEX_IDH0100             ORIG_HEX_IDH0101  
                   2.332344                     2.570029  
           ORIG_HEX_IDH0102             ORIG_HEX_IDH0103  
                   0.431122                    -1.078089  
           ORIG_HEX_IDH0104             ORIG_HEX_IDH0106  
                  -1.573694                    -0.575297  
           ORIG_HEX_IDH0107             ORIG_HEX_IDH0108  
                   0.322959                    -0.327706  
           ORIG_HEX_IDH0109             ORIG_HEX_IDH0110  
                   2.007423                     1.633986  
           ORIG_HEX_IDH0111             ORIG_HEX_IDH0112  
                   0.405854                     0.294865  
           ORIG_HEX_IDH0114             ORIG_HEX_IDH0115  
                  -0.796650                     0.140898  
           ORIG_HEX_IDH0116             ORIG_HEX_IDH0117  
                   0.847932                     3.526604  
           ORIG_HEX_IDH0118             ORIG_HEX_IDH0119  
                   1.760370                    -2.324810  
           ORIG_HEX_IDH0120             ORIG_HEX_IDH0121  
                  -0.274869                     0.163083  
           ORIG_HEX_IDH0122             ORIG_HEX_IDH0123  
                   1.088430                    -0.994004  
           ORIG_HEX_IDH0124             ORIG_HEX_IDH0125  
                   0.260416                     0.256682  
           ORIG_HEX_IDH0126             ORIG_HEX_IDH0127  
                   1.539196                    -0.778805  
           ORIG_HEX_IDH0128             ORIG_HEX_IDH0129  
                  -0.175888                    -0.305470  
           ORIG_HEX_IDH0130             ORIG_HEX_IDH0131  
                  -0.841405                     0.156265  
           ORIG_HEX_IDH0132             ORIG_HEX_IDH0133  
                  -0.642138                     2.283062  
           ORIG_HEX_IDH0134             ORIG_HEX_IDH0135  
                  -0.905197                    -0.492006  
           ORIG_HEX_IDH0136             ORIG_HEX_IDH0137  
                   2.020140                     0.520976  
           ORIG_HEX_IDH0138             ORIG_HEX_IDH0139  
                   0.960973                     1.502460  
           ORIG_HEX_IDH0140             ORIG_HEX_IDH0141  
                   2.841008                     2.716361  
           ORIG_HEX_IDH0142             ORIG_HEX_IDH0143  
                   1.017512                    -1.105330  
           ORIG_HEX_IDH0144             ORIG_HEX_IDH0145  
                   2.379221                     2.324187  
           ORIG_HEX_IDH0146             ORIG_HEX_IDH0147  
                   1.047511                     0.712283  
           ORIG_HEX_IDH0148             ORIG_HEX_IDH0149  
                   1.749621                     1.236994  
           ORIG_HEX_IDH0150             ORIG_HEX_IDH0151  
                   2.441120                     0.063861  
           ORIG_HEX_IDH0152             ORIG_HEX_IDH0154  
                  -0.080911                    -0.309928  
           ORIG_HEX_IDH0155             ORIG_HEX_IDH0156  
                   0.208718                     0.322412  
           ORIG_HEX_IDH0157             ORIG_HEX_IDH0158  
                  -0.448975                     1.868422  
           ORIG_HEX_IDH0159             ORIG_HEX_IDH0160  
                   1.499833                     0.992445  
           ORIG_HEX_IDH0161             ORIG_HEX_IDH0162  
                   1.650291                    -1.085624  
           ORIG_HEX_IDH0163             ORIG_HEX_IDH0164  
                   2.512737                     1.240122  
           ORIG_HEX_IDH0165             ORIG_HEX_IDH0166  
                   2.453132                     0.913378  
           ORIG_HEX_IDH0167             ORIG_HEX_IDH0168  
                  -1.098530                     1.413586  
           ORIG_HEX_IDH0169             ORIG_HEX_IDH0170  
                   0.805996                     1.435156  
           ORIG_HEX_IDH0171             ORIG_HEX_IDH0172  
                   1.643888                     0.401820  
           ORIG_HEX_IDH0173             ORIG_HEX_IDH0174  
                  -0.708641                     2.277750  
           ORIG_HEX_IDH0175             ORIG_HEX_IDH0176  
                   2.316085                     1.572323  
           ORIG_HEX_IDH0177             ORIG_HEX_IDH0178  
                   2.083912                     0.419804  
           ORIG_HEX_IDH0179             ORIG_HEX_IDH0180  
                   2.125676                     1.396954  
           ORIG_HEX_IDH0181             ORIG_HEX_IDH0182  
                   0.630122                     0.123830  
           ORIG_HEX_IDH0183             ORIG_HEX_IDH0184  
                  -0.352493                     1.774941  
           ORIG_HEX_IDH0185             ORIG_HEX_IDH0186  
                   1.913682                     1.617018  
           ORIG_HEX_IDH0187             ORIG_HEX_IDH0188  
                   1.392620                     3.113661  
           ORIG_HEX_IDH0189             ORIG_HEX_IDH0190  
                   2.733917                    -1.113636  
           ORIG_HEX_IDH0191             ORIG_HEX_IDH0192  
                  -0.578547                     1.540823  
           ORIG_HEX_IDH0193             ORIG_HEX_IDH0194  
                   1.337727                     1.335828  
           ORIG_HEX_IDH0195             ORIG_HEX_IDH0196  
                   0.412518                     1.758447  
           ORIG_HEX_IDH0197             ORIG_HEX_IDH0198  
                   1.805023                     1.264485  
           ORIG_HEX_IDH0199             ORIG_HEX_IDH0200  
                   2.886205                    -0.547588  
           ORIG_HEX_IDH0201             ORIG_HEX_IDH0202  
                  -1.044339                     0.954410  
           ORIG_HEX_IDH0203             ORIG_HEX_IDH0204  
                   0.902847                     0.702598  
           ORIG_HEX_IDH0205             ORIG_HEX_IDH0206  
                   0.942937                     1.921394  
           ORIG_HEX_IDH0207             ORIG_HEX_IDH0208  
                   2.569666                     2.452033  
           ORIG_HEX_IDH0209             ORIG_HEX_IDH0210  
                  -0.101045                     0.274770  
           ORIG_HEX_IDH0211             ORIG_HEX_IDH0212  
                   0.434586                    -1.308030  
           ORIG_HEX_IDH0213             ORIG_HEX_IDH0214  
                  -1.412407                     1.383166  
           ORIG_HEX_IDH0215             ORIG_HEX_IDH0216  
                   0.339631                     0.952244  
           ORIG_HEX_IDH0217             ORIG_HEX_IDH0218  
                  -1.165112                     1.981188  
           ORIG_HEX_IDH0219             ORIG_HEX_IDH0220  
                   0.539538                     1.953941  
           ORIG_HEX_IDH0221             ORIG_HEX_IDH0222  
                  -0.384937                     0.285731  
           ORIG_HEX_IDH0223             ORIG_HEX_IDH0224  
                  -0.807764                    -0.904223  
           ORIG_HEX_IDH0225             ORIG_HEX_IDH0226  
                   0.373026                     1.038873  
           ORIG_HEX_IDH0227             ORIG_HEX_IDH0228  
                   1.338677                    -1.399692  
           ORIG_HEX_IDH0229             ORIG_HEX_IDH0230  
                   1.271345                     1.846333  
           ORIG_HEX_IDH0231             ORIG_HEX_IDH0232  
                   1.611319                     2.013921  
           ORIG_HEX_IDH0233             ORIG_HEX_IDH0234  
                  -0.300245                     0.643545  
           ORIG_HEX_IDH0235             ORIG_HEX_IDH0236  
                   0.678910                     1.581401  
           ORIG_HEX_IDH0237             ORIG_HEX_IDH0238  
                   2.511567                    -0.773743  
           ORIG_HEX_IDH0239             ORIG_HEX_IDH0240  
                  -0.117308                     1.454164  
           ORIG_HEX_IDH0241             ORIG_HEX_IDH0242  
                  -1.269761                     3.085014  
           ORIG_HEX_IDH0243             ORIG_HEX_IDH0244  
                  -1.685426                     2.990652  
           ORIG_HEX_IDH0245             ORIG_HEX_IDH0246  
                   0.201129                     0.808359  
           ORIG_HEX_IDH0247             ORIG_HEX_IDH0248  
                   2.665356                     2.895948  
           ORIG_HEX_IDH0249             ORIG_HEX_IDH0250  
                   0.389071                     0.879360  
           ORIG_HEX_IDH0251             ORIG_HEX_IDH0252  
                  -0.698217                     1.777783  
           ORIG_HEX_IDH0253             ORIG_HEX_IDH0254  
                  -0.329920                     1.725115  
           ORIG_HEX_IDH0255             ORIG_HEX_IDH0256  
                  -0.187745                    -0.609152  
           ORIG_HEX_IDH0258             ORIG_HEX_IDH0259  
                   1.205871                     1.885045  
           ORIG_HEX_IDH0260             ORIG_HEX_IDH0262  
                   1.684616                     1.063708  
           ORIG_HEX_IDH0263             ORIG_HEX_IDH0264  
                   0.391204                     0.459675  
           ORIG_HEX_IDH0265             ORIG_HEX_IDH0266  
                   2.016048                     1.603378  
           ORIG_HEX_IDH0267             ORIG_HEX_IDH0268  
                  -0.521655                     3.708939  
           ORIG_HEX_IDH0269             ORIG_HEX_IDH0270  
                   1.308383                     1.303935  
           ORIG_HEX_IDH0271             ORIG_HEX_IDH0272  
                   0.566079                     0.380294  
           ORIG_HEX_IDH0273             ORIG_HEX_IDH0274  
                   2.003417                     0.916092  
           ORIG_HEX_IDH0275             ORIG_HEX_IDH0276  
                   0.020778                     2.185177  
           ORIG_HEX_IDH0277             ORIG_HEX_IDH0278  
                   2.077983                     0.033988  
           ORIG_HEX_IDH0279             ORIG_HEX_IDH0280  
                   2.565498                     2.750569  
           ORIG_HEX_IDH0281             ORIG_HEX_IDH0282  
                   0.063522                     0.790977  
           ORIG_HEX_IDH0283             ORIG_HEX_IDH0284  
                   0.386743                     0.478563  
           ORIG_HEX_IDH0285             ORIG_HEX_IDH0286  
                  -0.181663                     1.863448  
           ORIG_HEX_IDH0287             ORIG_HEX_IDH0288  
                   1.186081                     2.747835  
           ORIG_HEX_IDH0289             ORIG_HEX_IDH0290  
                   0.849082                     2.151014  
           ORIG_HEX_IDH0291             ORIG_HEX_IDH0292  
                  -0.590427                     0.770105  
           ORIG_HEX_IDH0293             ORIG_HEX_IDH0294  
                   1.220277                     1.352473  
           ORIG_HEX_IDH0295             ORIG_HEX_IDH0296  
                   1.481105                     1.451916  
           ORIG_HEX_IDH0297             ORIG_HEX_IDH0298  
                   1.507652                     2.211544  
           ORIG_HEX_IDH0299             ORIG_HEX_IDH0300  
                   2.224299                     1.025267  
           ORIG_HEX_IDH0301             ORIG_HEX_IDH0302  
                   0.306381                     1.612447  
           ORIG_HEX_IDH0303             ORIG_HEX_IDH0304  
                   0.819981                    -0.331567  
           ORIG_HEX_IDH0305             ORIG_HEX_IDH0306  
                   2.269209                     1.507669  
           ORIG_HEX_IDH0307             ORIG_HEX_IDH0308  
                   1.181094                    -0.631585  
           ORIG_HEX_IDH0309             ORIG_HEX_IDH0310  
                   0.534569                     0.427153  
           ORIG_HEX_IDH0311             ORIG_HEX_IDH0312  
                   1.480400                    -0.847030  
           ORIG_HEX_IDH0313             ORIG_HEX_IDH0314  
                   1.402167                     0.232367  
           ORIG_HEX_IDH0315             ORIG_HEX_IDH0316  
                  -0.563437                    -0.480739  
           ORIG_HEX_IDH0317             ORIG_HEX_IDH0318  
                  -0.575299                     2.158069  
           ORIG_HEX_IDH0319             ORIG_HEX_IDH0320  
                  -0.227348                     1.321316  
           ORIG_HEX_IDH0321             ORIG_HEX_IDH0322  
                   2.079504                    -1.487168  
           ORIG_HEX_IDH0323             ORIG_HEX_IDH0324  
                   0.011032                     3.524333  
           ORIG_HEX_IDH0325             ORIG_HEX_IDH0326  
                   1.701882                     0.368992  
           ORIG_HEX_IDH0327             ORIG_HEX_IDH0328  
                   0.001864                    -0.873830  
           ORIG_HEX_IDH0329             ORIG_HEX_IDH0330  
                   0.720289                     0.373827  
           ORIG_HEX_IDH0331             ORIG_HEX_IDH0332  
                   1.974940                     2.084907  
           ORIG_HEX_IDH0333             ORIG_HEX_IDH0334  
                   2.381294                     0.147911  
           ORIG_HEX_IDH0335             ORIG_HEX_IDH0336  
                  -0.937628                     1.383165  
           ORIG_HEX_IDH0337             ORIG_HEX_IDH0338  
                   1.133012                    -0.361080  
           ORIG_HEX_IDH0339             ORIG_HEX_IDH0340  
                   0.734601                     2.025497  
           ORIG_HEX_IDH0341             ORIG_HEX_IDH0343  
                   1.329828                     0.050767  
           ORIG_HEX_IDH0344             ORIG_HEX_IDH0345  
                   0.982870                     1.855309  
           ORIG_HEX_IDH0346             ORIG_HEX_IDH0347  
                   2.307051                     2.434914  
           ORIG_HEX_IDH0348             ORIG_HEX_IDH0349  
                   0.794755                    -1.793603  
           ORIG_HEX_IDH0350             ORIG_HEX_IDH0351  
                   0.765729                     1.132422  
           ORIG_HEX_IDH0352             ORIG_HEX_IDH0353  
                   1.813700                     0.813328  
           ORIG_HEX_IDH0354             ORIG_HEX_IDH0355  
                   0.436365                    -0.515947  
           ORIG_HEX_IDH0356             ORIG_HEX_IDH0357  
                   1.920497                     1.587431  
           ORIG_HEX_IDH0358             ORIG_HEX_IDH0360  
                   1.166782                     0.769644  
           ORIG_HEX_IDH0361             ORIG_HEX_IDH0362  
                   1.162854                     1.465114  
           ORIG_HEX_IDH0363             ORIG_HEX_IDH0364  
                   0.452525                     0.921308  
           ORIG_HEX_IDH0365             ORIG_HEX_IDH0366  
                   1.995042                    -0.117641  
           ORIG_HEX_IDH0367             ORIG_HEX_IDH0368  
                   0.355132                     1.611304  
           ORIG_HEX_IDH0369             ORIG_HEX_IDH0370  
                   1.394570                     1.004519  
           ORIG_HEX_IDH0371             ORIG_HEX_IDH0372  
                   0.178468                     0.607284  
           ORIG_HEX_IDH0373             ORIG_HEX_IDH0374  
                  -0.268845                     0.368200  
           ORIG_HEX_IDH0375             ORIG_HEX_IDH0376  
                  -0.049116                     0.809858  
           ORIG_HEX_IDH0377             ORIG_HEX_IDH0378  
                   0.656728                     0.762063  
           ORIG_HEX_IDH0379             ORIG_HEX_IDH0380  
                   1.417452                     1.168426  
           ORIG_HEX_IDH0381             ORIG_HEX_IDH0382  
                   0.779389                     1.939935  
           ORIG_HEX_IDH0383             ORIG_HEX_IDH0384  
                   1.087509                     0.300900  
           ORIG_HEX_IDH0385             ORIG_HEX_IDH0386  
                   1.661247                     0.619124  
           ORIG_HEX_IDH0387             ORIG_HEX_IDH0388  
                   0.603502                     0.944266  
           ORIG_HEX_IDH0389             ORIG_HEX_IDH0390  
                   0.634973                    -1.510667  
           ORIG_HEX_IDH0391             ORIG_HEX_IDH0392  
                   0.708618                     2.108902  
           ORIG_HEX_IDH0393             ORIG_HEX_IDH0394  
                   0.642514                     2.335915  
           ORIG_HEX_IDH0395             ORIG_HEX_IDH0396  
                   1.504310                     2.040327  
           ORIG_HEX_IDH0397             ORIG_HEX_IDH0398  
                   0.736913                     0.185020  
           ORIG_HEX_IDH0399             ORIG_HEX_IDH0400  
                  -0.569068                     1.690476  
           ORIG_HEX_IDH0401             ORIG_HEX_IDH0402  
                   0.490821                     0.888836  
           ORIG_HEX_IDH0403             ORIG_HEX_IDH0404  
                   1.744789                     1.842187  
           ORIG_HEX_IDH0405             ORIG_HEX_IDH0406  
                   1.484759                    -0.813786  
           ORIG_HEX_IDH0407             ORIG_HEX_IDH0408  
                   1.178860                    -1.438092  
           ORIG_HEX_IDH0409             ORIG_HEX_IDH0410  
                  -1.018279                    -0.079036  
           ORIG_HEX_IDH0411             ORIG_HEX_IDH0412  
                  -0.852059                     2.490497  
           ORIG_HEX_IDH0413             ORIG_HEX_IDH0415  
                   1.135738                    -0.244014  
           ORIG_HEX_IDH0416             ORIG_HEX_IDH0417  
                   1.388099                     1.261242  
           ORIG_HEX_IDH0418             ORIG_HEX_IDH0419  
                   0.615767                     1.074789  
           ORIG_HEX_IDH0420             ORIG_HEX_IDH0421  
                   0.668648                    -1.981178  
           ORIG_HEX_IDH0422             ORIG_HEX_IDH0423  
                   0.266116                     0.637781  
           ORIG_HEX_IDH0424             ORIG_HEX_IDH0425  
                   0.847728                    -1.089411  
           ORIG_HEX_IDH0426             ORIG_HEX_IDH0427  
                  -1.359772                    -2.219729  
           ORIG_HEX_IDH0428             ORIG_HEX_IDH0429  
                   2.743527                     1.519422  
           ORIG_HEX_IDH0430             ORIG_HEX_IDH0431  
                  -3.506926                     1.484290  
           ORIG_HEX_IDH0432             ORIG_HEX_IDH0433  
                   2.203171                     1.088208  
           ORIG_HEX_IDH0434             ORIG_HEX_IDH0435  
                   1.560363                     0.373025  
           ORIG_HEX_IDH0436             ORIG_HEX_IDH0437  
                   1.171556                    -0.058561  
           ORIG_HEX_IDH0438             ORIG_HEX_IDH0439  
                   0.936698                    -0.530512  
           ORIG_HEX_IDH0440             ORIG_HEX_IDH0441  
                   1.108028                     1.370502  
           ORIG_HEX_IDH0442             ORIG_HEX_IDH0443  
                   1.313254                     2.245124  
           ORIG_HEX_IDH0444             ORIG_HEX_IDH0445  
                  -1.037377                     0.199638  
           ORIG_HEX_IDH0446             ORIG_HEX_IDH0447  
                  -0.104375                     2.017589  
           ORIG_HEX_IDH0448             ORIG_HEX_IDH0449  
                   0.789881                    -0.539134  
           ORIG_HEX_IDH0450             ORIG_HEX_IDH0451  
                  -1.013441                    -0.077514  
           ORIG_HEX_IDH0452             ORIG_HEX_IDH0453  
                   1.125547                     0.225326  
           ORIG_HEX_IDH0455             ORIG_HEX_IDH0456  
                  -0.807411                     2.535687  
           ORIG_HEX_IDH0457             ORIG_HEX_IDH0458  
                   2.351880                     1.699838  
           ORIG_HEX_IDH0459             ORIG_HEX_IDH0460  
                  -0.378716                     0.627805  
           ORIG_HEX_IDH0461             ORIG_HEX_IDH0462  
                   0.237916                     0.799867  
           ORIG_HEX_IDH0463             ORIG_HEX_IDH0464  
                   0.763630                     0.540557  
           ORIG_HEX_IDH0465             ORIG_HEX_IDH0466  
                  -0.773592                     1.525925  
           ORIG_HEX_IDH0467             ORIG_HEX_IDH0468  
                   1.066042                     1.606136  
           ORIG_HEX_IDH0469             ORIG_HEX_IDH0470  
                   1.217886                     0.442555  
           ORIG_HEX_IDH0471             ORIG_HEX_IDH0472  
                   0.986645                     1.791981  
           ORIG_HEX_IDH0473             ORIG_HEX_IDH0474  
                   2.105941                     2.622660  
           ORIG_HEX_IDH0475             ORIG_HEX_IDH0476  
                   1.139994                     0.262347  
           ORIG_HEX_IDH0477             ORIG_HEX_IDH0478  
                   1.626766                     1.518505  
           ORIG_HEX_IDH0479             ORIG_HEX_IDH0480  
                   0.758775                     0.402260  
           ORIG_HEX_IDH0481             ORIG_HEX_IDH0482  
                   0.540495                     0.930300  
           ORIG_HEX_IDH0483             ORIG_HEX_IDH0484  
                   1.512402                     0.869027  
           ORIG_HEX_IDH0485             ORIG_HEX_IDH0486  
                   1.559101                     2.507588  
           ORIG_HEX_IDH0487             ORIG_HEX_IDH0488  
                   0.899452                     2.010931  
           ORIG_HEX_IDH0489             ORIG_HEX_IDH0490  
                   1.314228                    -0.262571  
           ORIG_HEX_IDH0491             ORIG_HEX_IDH0492  
                   1.717455                     1.280478  
           ORIG_HEX_IDH0493             ORIG_HEX_IDH0494  
                  -0.828099                     1.704112  
           ORIG_HEX_IDH0495             ORIG_HEX_IDH0496  
                   1.766248                     1.884507  
           ORIG_HEX_IDH0497             ORIG_HEX_IDH0498  
                  -0.465744                     1.053767  
           ORIG_HEX_IDH0499             ORIG_HEX_IDH0500  
                   2.291692                     1.928148  
           ORIG_HEX_IDH0501             ORIG_HEX_IDH0502  
                   0.714150                     0.855211  
           ORIG_HEX_IDH0503             ORIG_HEX_IDH0504  
                   0.287326                     0.519414  
           ORIG_HEX_IDH0505             ORIG_HEX_IDH0506  
                   1.522405                     1.699966  
           ORIG_HEX_IDH0507             ORIG_HEX_IDH0508  
                   2.306238                     1.348655  
           ORIG_HEX_IDH0509             ORIG_HEX_IDH0510  
                   1.106660                    -0.027006  
           ORIG_HEX_IDH0511             ORIG_HEX_IDH0512  
                   2.311777                     2.004744  
           ORIG_HEX_IDH0513             ORIG_HEX_IDH0514  
                  -0.981916                     0.066241  
           ORIG_HEX_IDH0515             ORIG_HEX_IDH0516  
                   1.567243                     2.093189  
           ORIG_HEX_IDH0517             ORIG_HEX_IDH0518  
                   1.067575                     2.701499  
           ORIG_HEX_IDH0519             ORIG_HEX_IDH0520  
                   0.594412                     0.802318  
           ORIG_HEX_IDH0521             ORIG_HEX_IDH0522  
                   2.761807                    -0.126188  
           ORIG_HEX_IDH0523             ORIG_HEX_IDH0524  
                   0.014738                     1.892902  
           ORIG_HEX_IDH0525             ORIG_HEX_IDH0526  
                  -0.213980                     0.641397  
           ORIG_HEX_IDH0527             ORIG_HEX_IDH0528  
                   2.026084                     1.559123  
           ORIG_HEX_IDH0529             ORIG_HEX_IDH0530  
                   1.615162                     1.809464  
           ORIG_HEX_IDH0531             ORIG_HEX_IDH0532  
                   1.675204                     1.970945  
           ORIG_HEX_IDH0533             ORIG_HEX_IDH0534  
                   1.429213                    -2.316821  
           ORIG_HEX_IDH0535             ORIG_HEX_IDH0536  
                  -4.128582                    -0.036802  
           ORIG_HEX_IDH0537             ORIG_HEX_IDH0538  
                   1.465690                     0.962446  
           ORIG_HEX_IDH0539             ORIG_HEX_IDH0540  
                   0.957267                     1.814010  
           ORIG_HEX_IDH0541             ORIG_HEX_IDH0542  
                   1.108872                    -0.673241  
           ORIG_HEX_IDH0543             ORIG_HEX_IDH0544  
                   2.016956                     0.774051  
           ORIG_HEX_IDH0545             ORIG_HEX_IDH0546  
                   0.708057                     0.031046  
           ORIG_HEX_IDH0547             ORIG_HEX_IDH0548  
                   0.979685                     0.132924  
           ORIG_HEX_IDH0549             ORIG_HEX_IDH0550  
                   0.278716                     1.172093  
           ORIG_HEX_IDH0551             ORIG_HEX_IDH0552  
                   1.176722                     1.306090  
           ORIG_HEX_IDH0553             ORIG_HEX_IDH0554  
                   2.574582                    -0.036000  
           ORIG_HEX_IDH0555             ORIG_HEX_IDH0556  
                   0.412334                     1.262716  
           ORIG_HEX_IDH0557             ORIG_HEX_IDH0558  
                  -0.843535                    -0.415230  
           ORIG_HEX_IDH0559             ORIG_HEX_IDH0560  
                   0.139165                    -0.719637  
           ORIG_HEX_IDH0561             ORIG_HEX_IDH0562  
                   1.482597                     1.803995  
           ORIG_HEX_IDH0563             ORIG_HEX_IDH0564  
                   1.530700                    -0.683933  
           ORIG_HEX_IDH0565             ORIG_HEX_IDH0566  
                   0.580500                     0.033190  
           ORIG_HEX_IDH0567             ORIG_HEX_IDH0568  
                  -0.230111                    -0.532720  
           ORIG_HEX_IDH0569             ORIG_HEX_IDH0570  
                  -1.521148                    -0.862405  
           ORIG_HEX_IDH0571             ORIG_HEX_IDH0572  
                  -2.550784                     0.266663  
           ORIG_HEX_IDH0573             ORIG_HEX_IDH0574  
                  -1.029828                     1.486229  
           ORIG_HEX_IDH0575             ORIG_HEX_IDH0576  
                   0.060572                     0.109503  
           ORIG_HEX_IDH0577             ORIG_HEX_IDH0578  
                   1.605130                    -0.050492  
           ORIG_HEX_IDH0579             ORIG_HEX_IDH0580  
                  -0.330272                    -1.129136  
           ORIG_HEX_IDH0581             ORIG_HEX_IDH0582  
                   1.929010                     0.759708  
           ORIG_HEX_IDH0583             ORIG_HEX_IDH0584  
                   1.215358                     1.683858  
           ORIG_HEX_IDH0585             ORIG_HEX_IDH0586  
                   0.454597                     1.621602  
           ORIG_HEX_IDH0587             ORIG_HEX_IDH0588  
                   1.530702                     0.086089  
           ORIG_HEX_IDH0589             ORIG_HEX_IDH0590  
                   1.769534                     1.493894  
           ORIG_HEX_IDH0591             ORIG_HEX_IDH0592  
                  -1.119226                     1.522503  
           ORIG_HEX_IDH0593             ORIG_HEX_IDH0594  
                   1.503291                     0.584476  
           ORIG_HEX_IDH0595             ORIG_HEX_IDH0596  
                   1.473210                     2.752181  
           ORIG_HEX_IDH0597             ORIG_HEX_IDH0598  
                   0.652374                     2.123306  
           ORIG_HEX_IDH0599             ORIG_HEX_IDH0600  
                   0.635910                     0.898100  
           ORIG_HEX_IDH0601             ORIG_HEX_IDH0602  
                  -1.717897                    -0.206870  
           ORIG_HEX_IDH0603             ORIG_HEX_IDH0604  
                   1.388035                    -0.373429  
           ORIG_HEX_IDH0605             ORIG_HEX_IDH0606  
                   0.902810                     0.392468  
           ORIG_HEX_IDH0607             ORIG_HEX_IDH0608  
                   1.349683                     1.401171  
           ORIG_HEX_IDH0609             ORIG_HEX_IDH0610  
                   1.823264                     1.756283  
           ORIG_HEX_IDH0611             ORIG_HEX_IDH0612  
                  -1.601199                     1.714304  
           ORIG_HEX_IDH0613             ORIG_HEX_IDH0614  
                   0.628400                     1.458310  
           ORIG_HEX_IDH0615             ORIG_HEX_IDH0616  
                   1.356052                     2.098165  
           ORIG_HEX_IDH0617             ORIG_HEX_IDH0618  
                   2.354680                     1.395295  
           ORIG_HEX_IDH0619             ORIG_HEX_IDH0620  
                   0.804601                     1.354159  
           ORIG_HEX_IDH0621             ORIG_HEX_IDH0622  
                   1.147527                     0.689082  
           ORIG_HEX_IDH0623             ORIG_HEX_IDH0624  
                   0.759186                     0.217802  
           ORIG_HEX_IDH0625             ORIG_HEX_IDH0626  
                   0.687428                     1.567081  
           ORIG_HEX_IDH0627             ORIG_HEX_IDH0628  
                   0.640190                     1.343468  
           ORIG_HEX_IDH0629             ORIG_HEX_IDH0630  
                   1.023597                     1.500313  
           ORIG_HEX_IDH0631             ORIG_HEX_IDH0632  
                   0.752884                     1.648935  
           ORIG_HEX_IDH0633             ORIG_HEX_IDH0634  
                   2.360134                     2.235537  
           ORIG_HEX_IDH0635             ORIG_HEX_IDH0636  
                  -0.762664                     2.034632  
           ORIG_HEX_IDH0637             ORIG_HEX_IDH0638  
                  -1.758109                     1.253821  
           ORIG_HEX_IDH0639             ORIG_HEX_IDH0640  
                   1.737491                     0.763866  
           ORIG_HEX_IDH0641             ORIG_HEX_IDH0642  
                  -0.574527                     1.528045  
           ORIG_HEX_IDH0643             ORIG_HEX_IDH0644  
                   1.750478                     1.260964  
           ORIG_HEX_IDH0645             ORIG_HEX_IDH0646  
                   1.410668                     2.228134  
           ORIG_HEX_IDH0647             ORIG_HEX_IDH0648  
                   0.692531                     1.993907  
           ORIG_HEX_IDH0649             ORIG_HEX_IDH0650  
                   0.581619                    -0.101580  
           ORIG_HEX_IDH0651             ORIG_HEX_IDH0652  
                   1.737977                     2.441822  
           ORIG_HEX_IDH0653             ORIG_HEX_IDH0654  
                   1.521505                     1.220995  
           ORIG_HEX_IDH0655             ORIG_HEX_IDH0656  
                  -0.767992                    -0.162880  
           ORIG_HEX_IDH0657             ORIG_HEX_IDH0658  
                   1.088197                     1.922922  
           ORIG_HEX_IDH0659             ORIG_HEX_IDH0660  
                   0.127469                     0.464748  
           ORIG_HEX_IDH0661             ORIG_HEX_IDH0662  
                   1.575951                     0.995999  
           ORIG_HEX_IDH0663             ORIG_HEX_IDH0664  
                   2.508869                     1.598368  
           ORIG_HEX_IDH0665             ORIG_HEX_IDH0666  
                   1.042795                     2.238471  
           ORIG_HEX_IDH0667             ORIG_HEX_IDH0668  
                   1.779654                     0.992053  
           ORIG_HEX_IDH0669             ORIG_HEX_IDH0670  
                   0.429495                    -0.057982  
           ORIG_HEX_IDH0671             ORIG_HEX_IDH0672  
                  -1.481011                     1.726499  
           ORIG_HEX_IDH0673             ORIG_HEX_IDH0674  
                   1.655550                     1.581462  
           ORIG_HEX_IDH0675             ORIG_HEX_IDH0676  
                   0.755683                     0.056055  
           ORIG_HEX_IDH0677             ORIG_HEX_IDH0678  
                   1.553284                     2.163029  
           ORIG_HEX_IDH0679             ORIG_HEX_IDH0680  
                   1.502654                     1.360097  
           ORIG_HEX_IDH0681             ORIG_HEX_IDH0682  
                   1.497882                     2.380422  
           ORIG_HEX_IDH0683             ORIG_HEX_IDH0684  
                  -0.652265                     2.599336  
           ORIG_HEX_IDH0685             ORIG_HEX_IDH0686  
                   1.182732                     1.025283  
           ORIG_HEX_IDH0687             ORIG_HEX_IDH0688  
                   0.334966                    -0.879691  
           ORIG_HEX_IDH0689             ORIG_HEX_IDH0690  
                   0.952548                     2.429918  
           ORIG_HEX_IDH0691             ORIG_HEX_IDH0692  
                   0.134394                     2.115191  
           ORIG_HEX_IDH0693             ORIG_HEX_IDH0694  
                   1.388767                     1.688450  
           ORIG_HEX_IDH0695             ORIG_HEX_IDH0696  
                   1.632654                     0.307494  
           ORIG_HEX_IDH0697             ORIG_HEX_IDH0698  
                   1.669476                     1.555202  
           ORIG_HEX_IDH0700             ORIG_HEX_IDH0701  
                   1.751498                    -0.093846  
           ORIG_HEX_IDH0702             ORIG_HEX_IDH0703  
                   1.785123                     1.282341  
           ORIG_HEX_IDH0704             ORIG_HEX_IDH0705  
                  -0.557060                     1.672078  
           ORIG_HEX_IDH0706             ORIG_HEX_IDH0707  
                   1.143084                     1.682248  
           ORIG_HEX_IDH0708             ORIG_HEX_IDH0709  
                   1.180516                     1.032924  
           ORIG_HEX_IDH0710             ORIG_HEX_IDH0711  
                  -1.974603                    -0.988595  
           ORIG_HEX_IDH0712             ORIG_HEX_IDH0713  
                   0.708800                    -1.217776  
           ORIG_HEX_IDH0714             ORIG_HEX_IDH0715  
                   0.924397                     1.990878  
           ORIG_HEX_IDH0716             ORIG_HEX_IDH0717  
                   1.410809                    -0.184937  
           ORIG_HEX_IDH0718             ORIG_HEX_IDH0719  
                   0.860347                     1.280498  
           ORIG_HEX_IDH0720             ORIG_HEX_IDH0721  
                   1.833920                     1.887627  
           ORIG_HEX_IDH0722             ORIG_HEX_IDH0723  
                  -0.748910                    -1.474319  
           ORIG_HEX_IDH0724             ORIG_HEX_IDH0725  
                   1.048358                     3.181377  
           ORIG_HEX_IDH0726             ORIG_HEX_IDH0727  
                   1.015057                     1.764978  
           ORIG_HEX_IDH0728             ORIG_HEX_IDH0729  
                  -0.275565                     1.082345  
           ORIG_HEX_IDH0730             ORIG_HEX_IDH0731  
                  -0.671483                     1.494087  
           ORIG_HEX_IDH0732             ORIG_HEX_IDH0733  
                   0.909821                     1.900795  
           ORIG_HEX_IDH0734             ORIG_HEX_IDH0735  
                   0.797225                     0.964506  
           ORIG_HEX_IDH0736             ORIG_HEX_IDH0737  
                   1.442531                     1.872142  
           ORIG_HEX_IDH0738             ORIG_HEX_IDH0739  
                   1.646715                     2.528650  
           ORIG_HEX_IDH0740             ORIG_HEX_IDH0741  
                   1.790227                     1.140099  
           ORIG_HEX_IDH0742             ORIG_HEX_IDH0743  
                  -0.242696                     2.115409  
           ORIG_HEX_IDH0744             ORIG_HEX_IDH0745  
                   2.075912                     1.657315  
           ORIG_HEX_IDH0746             ORIG_HEX_IDH0747  
                   1.452087                     0.171096  
           ORIG_HEX_IDH0748             ORIG_HEX_IDH0749  
                   2.226224                     1.176994  
           ORIG_HEX_IDH0750             ORIG_HEX_IDH0751  
                   1.706012                    -0.990633  
           ORIG_HEX_IDH0752             ORIG_HEX_IDH0753  
                   2.092574                     1.410063  
           ORIG_HEX_IDH0754             ORIG_HEX_IDH0755  
                   1.686521                     0.754442  
           ORIG_HEX_IDH0756             ORIG_HEX_IDH0757  
                   1.729084                     0.786793  
           ORIG_HEX_IDH0758             ORIG_HEX_IDH0759  
                   0.529331                     3.187662  
           ORIG_HEX_IDH0760             ORIG_HEX_IDH0761  
                   1.452064                     1.772854  
           ORIG_HEX_IDH0762             ORIG_HEX_IDH0763  
                   0.750151                     1.858394  
           ORIG_HEX_IDH0764             ORIG_HEX_IDH0765  
                   1.091628                     1.663524  
           ORIG_HEX_IDH0766             ORIG_HEX_IDH0767  
                   1.017792                     2.734841  
           ORIG_HEX_IDH0768             ORIG_HEX_IDH0769  
                  -0.537205                     0.462824  
           ORIG_HEX_IDH0770             ORIG_HEX_IDH0771  
                  -0.349634                     0.751583  
           ORIG_HEX_IDH0772             ORIG_HEX_IDH0773  
                   1.717079                     1.341776  
           ORIG_HEX_IDH0774             ORIG_HEX_IDH0775  
                   0.797872                    -1.831558  
           ORIG_HEX_IDH0776             ORIG_HEX_IDH0777  
                   0.915831                     0.264887  
           ORIG_HEX_IDH0778             ORIG_HEX_IDH0779  
                   1.975267                     2.005203  
           ORIG_HEX_IDH0780             ORIG_HEX_IDH0781  
                   1.568992                     1.603424  
           ORIG_HEX_IDH0782             ORIG_HEX_IDH0783  
                  -0.502321                     1.737254  
           ORIG_HEX_IDH0784             ORIG_HEX_IDH0785  
                   2.142789                     2.357574  
           ORIG_HEX_IDH0786             ORIG_HEX_IDH0787  
                   1.758550                     1.032741  
           ORIG_HEX_IDH0788             ORIG_HEX_IDH0789  
                   0.848135                     1.130576  
           ORIG_HEX_IDH0790             ORIG_HEX_IDH0791  
                   1.606572                     0.645323  
           ORIG_HEX_IDH0792             ORIG_HEX_IDH0793  
                   0.507880                     1.060802  
           ORIG_HEX_IDH0794             ORIG_HEX_IDH0795  
                   1.704988                     1.002134  
           ORIG_HEX_IDH0796             ORIG_HEX_IDH0797  
                   0.162811                    -1.074828  
           ORIG_HEX_IDH0798             ORIG_HEX_IDH0799  
                   0.391365                     1.306507  
           ORIG_HEX_IDH0800             ORIG_HEX_IDH0801  
                   0.218627                    -0.085040  
           ORIG_HEX_IDH0802             ORIG_HEX_IDH0803  
                   0.135434                     0.489869  
           ORIG_HEX_IDH0804             ORIG_HEX_IDH0805  
                  -0.570831                    -0.501477  
           ORIG_HEX_IDH0806             ORIG_HEX_IDH0807  
                  -0.107072                     0.102031  
           ORIG_HEX_IDH0808             ORIG_HEX_IDH0809  
                  -0.043920                     0.153911  
           ORIG_HEX_IDH0810             ORIG_HEX_IDH0811  
                  -0.280204                     0.542699  
           ORIG_HEX_IDH0812             ORIG_HEX_IDH0813  
                  -0.072057                    -0.540465  
           ORIG_HEX_IDH0814             ORIG_HEX_IDH0815  
                   1.584817                    -1.982673  
           ORIG_HEX_IDH0816             ORIG_HEX_IDH0817  
                  -0.257897                    -0.417384  
           ORIG_HEX_IDH0818             ORIG_HEX_IDH0819  
                   1.740058                     2.329872  
           ORIG_HEX_IDH0820             ORIG_HEX_IDH0821  
                   3.354225                     2.276231  
           ORIG_HEX_IDH0822             ORIG_HEX_IDH0823  
                   1.236703                     1.470725  
           ORIG_HEX_IDH0824             ORIG_HEX_IDH0825  
                  -0.150258                     0.599674  
           ORIG_HEX_IDH0826             ORIG_HEX_IDH0827  
                   1.474999                     1.106341  
           ORIG_HEX_IDH0828             ORIG_HEX_IDH0829  
                   0.226996                     1.786456  
           ORIG_HEX_IDH0830             ORIG_HEX_IDH0831  
                   1.094371                     1.669683  
   log(DEST_BUS_STOP_COUNT)      log(DEST_ENTERTN_COUNT)  
                   0.165286                    -0.087018  
    log(DEST_F_AND_B_COUNT)      log(DEST_LEISURE_COUNT)  
                   0.009869                    -0.016053  
     log(DEST_RETAIL_COUNT)  log(DEST_TRAIN_EXITS_COUNT)  
                   0.164643                     0.594719  
        log(DEST_HDB_COUNT)                log(DISTANCE)  
                   0.184052                    -1.495618  

Degrees of Freedom: 59275 Total (i.e. Null);  58450 Residual
Null Deviance:      19980000 
Residual Deviance: 6263000  AIC: 6532000</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="insights-6" class="level4 callout-tips" data-collapse="true" data-appearance="minimal">
<h4 class="anchored" data-anchor-id="insights-6">Insights</h4>
<p><code>DEST_ENTERTN_COUNT</code>, and <code>DEST_LEISURE_COUNT</code> have <strong>negative</strong> coefficients, consistent with those in <strong>unconstrained</strong> model.</p>
<p>Instead of attracting passengers to their location, their presence <strong>deters passengers</strong> from going to their locations. This is counter-intuitive to real world context as <strong>entertainment and leisure</strong> are generally desirable activities. We expect this pattern in contexts such as crime rate, which are negative.</p>
<p>This result could be because there variables are correlated to other explanatory variables, i.e.&nbsp;they could be within malls, which also have high <strong>retail</strong> numbers.</p>
<p>When improving the model, we can plot a correlation matrix to identify valid explanatory variables.</p>
</section>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>decSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>                DEST_HEX_ID <span class="sc">+</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIG_HDB_RESIDENT_COUNT) <span class="sc">+</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIG_BUS_ALIGHT_COUNT) <span class="sc">+</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIG_TRAIN_ALIGHT_COUNT) <span class="sc">+</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DISTANCE),</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data_no_intra,</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(decSIM, <span class="st">"data/rds/decSIM202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Coefficients for our explanatory variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>decSIM <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/decSIM202310.rds"</span>)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">tail</span>(decSIM<span class="sc">$</span>coefficients, <span class="at">n=</span><span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">log(ORIG_HDB_RESIDENT_COUNT)</td>
<td style="text-align: right;">0.0132947</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(ORIG_BUS_ALIGHT_COUNT)</td>
<td style="text-align: right;">0.6361913</td>
</tr>
<tr class="odd">
<td style="text-align: left;">log(ORIG_TRAIN_ALIGHT_COUNT)</td>
<td style="text-align: right;">-0.0084564</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(DISTANCE)</td>
<td style="text-align: right;">-1.5292228</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-77-contents" aria-controls="callout-77" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Full model output
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-77" class="callout-77-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>decSIM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = TRIPS ~ DEST_HEX_ID + log(ORIG_HDB_RESIDENT_COUNT) + 
    log(ORIG_BUS_ALIGHT_COUNT) + log(ORIG_TRAIN_ALIGHT_COUNT) + 
    log(DISTANCE), family = poisson(link = "log"), data = SIM_data_no_intra, 
    na.action = na.exclude)

Coefficients:
                 (Intercept)              DEST_HEX_IDH0003  
                   10.382296                      0.790285  
            DEST_HEX_IDH0004              DEST_HEX_IDH0005  
                    0.973909                     -0.146217  
            DEST_HEX_IDH0006              DEST_HEX_IDH0007  
                    0.699822                      1.381732  
            DEST_HEX_IDH0009              DEST_HEX_IDH0010  
                    1.252447                      0.610912  
            DEST_HEX_IDH0011              DEST_HEX_IDH0012  
                   -1.419009                     -0.894387  
            DEST_HEX_IDH0013              DEST_HEX_IDH0014  
                   -3.302724                      2.881189  
            DEST_HEX_IDH0015              DEST_HEX_IDH0016  
                   -2.573675                      2.989652  
            DEST_HEX_IDH0017              DEST_HEX_IDH0018  
                    0.423972                      0.633229  
            DEST_HEX_IDH0019              DEST_HEX_IDH0020  
                   -1.287529                      0.151026  
            DEST_HEX_IDH0021              DEST_HEX_IDH0022  
                   -1.654542                      2.233043  
            DEST_HEX_IDH0023              DEST_HEX_IDH0024  
                    0.335785                     -0.745916  
            DEST_HEX_IDH0025              DEST_HEX_IDH0026  
                    0.305865                      0.095572  
            DEST_HEX_IDH0027              DEST_HEX_IDH0028  
                   -0.424250                      0.542756  
            DEST_HEX_IDH0029              DEST_HEX_IDH0030  
                   -1.797255                     -0.191744  
            DEST_HEX_IDH0031              DEST_HEX_IDH0032  
                   -1.507482                      1.824410  
            DEST_HEX_IDH0033              DEST_HEX_IDH0034  
                   -1.715805                     -2.547767  
            DEST_HEX_IDH0035              DEST_HEX_IDH0036  
                   -1.790145                     -2.040431  
            DEST_HEX_IDH0037              DEST_HEX_IDH0038  
                   -0.358649                      1.895970  
            DEST_HEX_IDH0039              DEST_HEX_IDH0040  
                   -0.621106                     -2.681731  
            DEST_HEX_IDH0041              DEST_HEX_IDH0042  
                   -1.605256                     -0.194191  
            DEST_HEX_IDH0043              DEST_HEX_IDH0044  
                   -0.052214                     -2.029554  
            DEST_HEX_IDH0045              DEST_HEX_IDH0046  
                   -1.799794                      0.193989  
            DEST_HEX_IDH0047              DEST_HEX_IDH0048  
                   -0.856804                     -0.727942  
            DEST_HEX_IDH0050              DEST_HEX_IDH0051  
                   -1.180869                      0.267098  
            DEST_HEX_IDH0052              DEST_HEX_IDH0053  
                   -0.187513                     -1.901892  
            DEST_HEX_IDH0054              DEST_HEX_IDH0055  
                   -0.703979                      0.937633  
            DEST_HEX_IDH0056              DEST_HEX_IDH0057  
                   -0.804256                     -1.135671  
            DEST_HEX_IDH0058              DEST_HEX_IDH0059  
                   -0.431459                     -1.494516  
            DEST_HEX_IDH0060              DEST_HEX_IDH0061  
                    0.087864                     -1.137004  
            DEST_HEX_IDH0062              DEST_HEX_IDH0063  
                   -3.632092                      0.152300  
            DEST_HEX_IDH0064              DEST_HEX_IDH0065  
                   -1.485737                      1.929849  
            DEST_HEX_IDH0066              DEST_HEX_IDH0067  
                   -0.010796                      1.219716  
            DEST_HEX_IDH0068              DEST_HEX_IDH0069  
                   -2.070439                     -2.202029  
            DEST_HEX_IDH0070              DEST_HEX_IDH0071  
                   -1.310037                     -0.778905  
            DEST_HEX_IDH0072              DEST_HEX_IDH0073  
                    0.115865                     -1.076903  
            DEST_HEX_IDH0074              DEST_HEX_IDH0075  
                   -2.603488                     -3.070799  
            DEST_HEX_IDH0076              DEST_HEX_IDH0077  
                    0.086525                     -0.288053  
            DEST_HEX_IDH0079              DEST_HEX_IDH0080  
                   -1.132326                     -2.000701  
            DEST_HEX_IDH0081              DEST_HEX_IDH0082  
                    0.982854                      0.225287  
            DEST_HEX_IDH0084              DEST_HEX_IDH0085  
                   -1.132209                     -3.243027  
            DEST_HEX_IDH0086              DEST_HEX_IDH0087  
                   -0.743009                     -0.639468  
            DEST_HEX_IDH0088              DEST_HEX_IDH0089  
                   -4.049868                     -0.259624  
            DEST_HEX_IDH0090              DEST_HEX_IDH0091  
                   -1.207080                     -1.646603  
            DEST_HEX_IDH0092              DEST_HEX_IDH0093  
                   -0.961169                      0.971336  
            DEST_HEX_IDH0094              DEST_HEX_IDH0095  
                   -1.827619                     -1.751865  
            DEST_HEX_IDH0096              DEST_HEX_IDH0097  
                   -1.902656                     -1.598723  
            DEST_HEX_IDH0098              DEST_HEX_IDH0099  
                   -0.650696                     -1.816809  
            DEST_HEX_IDH0100              DEST_HEX_IDH0101  
                    1.527634                      1.053877  
            DEST_HEX_IDH0102              DEST_HEX_IDH0103  
                   -0.602520                     -2.336039  
            DEST_HEX_IDH0104              DEST_HEX_IDH0105  
                   -2.362065                      0.482690  
            DEST_HEX_IDH0106              DEST_HEX_IDH0107  
                   -2.383203                     -2.382888  
            DEST_HEX_IDH0108              DEST_HEX_IDH0109  
                   -2.105850                      0.448401  
            DEST_HEX_IDH0110              DEST_HEX_IDH0111  
                   -0.030362                     -0.717900  
            DEST_HEX_IDH0112              DEST_HEX_IDH0113  
                   -3.257421                     -2.269941  
            DEST_HEX_IDH0114              DEST_HEX_IDH0115  
                   -4.518070                     -0.546073  
            DEST_HEX_IDH0116              DEST_HEX_IDH0117  
                   -1.383716                      2.740649  
            DEST_HEX_IDH0118              DEST_HEX_IDH0119  
                    0.282080                     -3.154135  
            DEST_HEX_IDH0120              DEST_HEX_IDH0121  
                   -2.355304                     -1.453287  
            DEST_HEX_IDH0122              DEST_HEX_IDH0123  
                   -0.699859                     -2.857598  
            DEST_HEX_IDH0124              DEST_HEX_IDH0125  
                   -1.276041                     -2.348740  
            DEST_HEX_IDH0126              DEST_HEX_IDH0127  
                    0.178510                     -3.328691  
            DEST_HEX_IDH0128              DEST_HEX_IDH0129  
                   -2.313218                     -1.957633  
            DEST_HEX_IDH0130              DEST_HEX_IDH0131  
                   -2.685899                     -1.841349  
            DEST_HEX_IDH0132              DEST_HEX_IDH0133  
                   -2.043909                      0.724329  
            DEST_HEX_IDH0134              DEST_HEX_IDH0135  
                   -1.820025                     -2.524670  
            DEST_HEX_IDH0136              DEST_HEX_IDH0137  
                    0.614120                     -1.933671  
            DEST_HEX_IDH0138              DEST_HEX_IDH0139  
                   -0.528162                      0.041018  
            DEST_HEX_IDH0140              DEST_HEX_IDH0141  
                    1.272349                      1.448056  
            DEST_HEX_IDH0142              DEST_HEX_IDH0143  
                   -1.610654                     -2.917649  
            DEST_HEX_IDH0144              DEST_HEX_IDH0145  
                    0.876300                      1.659778  
            DEST_HEX_IDH0146              DEST_HEX_IDH0147  
                   -0.511478                     -1.307963  
            DEST_HEX_IDH0148              DEST_HEX_IDH0149  
                    0.488564                     -0.732482  
            DEST_HEX_IDH0150              DEST_HEX_IDH0151  
                    0.976305                     -2.192256  
            DEST_HEX_IDH0152              DEST_HEX_IDH0154  
                   -1.219245                     -1.979235  
            DEST_HEX_IDH0155              DEST_HEX_IDH0156  
                   -0.589360                     -0.091310  
            DEST_HEX_IDH0157              DEST_HEX_IDH0158  
                   -1.480876                      0.498496  
            DEST_HEX_IDH0159              DEST_HEX_IDH0160  
                    0.113839                     -1.395618  
            DEST_HEX_IDH0161              DEST_HEX_IDH0162  
                   -0.079658                     -1.789186  
            DEST_HEX_IDH0163              DEST_HEX_IDH0164  
                    1.165913                     -1.068730  
            DEST_HEX_IDH0165              DEST_HEX_IDH0166  
                    1.049380                      0.439061  
            DEST_HEX_IDH0167              DEST_HEX_IDH0168  
                   -2.280976                      0.145083  
            DEST_HEX_IDH0169              DEST_HEX_IDH0170  
                   -0.501410                     -0.449804  
            DEST_HEX_IDH0171              DEST_HEX_IDH0172  
                    0.256682                     -0.928779  
            DEST_HEX_IDH0173              DEST_HEX_IDH0174  
                   -2.968684                      0.891171  
            DEST_HEX_IDH0175              DEST_HEX_IDH0176  
                    1.805630                      0.066831  
            DEST_HEX_IDH0177              DEST_HEX_IDH0178  
                    0.906318                     -1.480549  
            DEST_HEX_IDH0179              DEST_HEX_IDH0180  
                    0.908658                      0.296115  
            DEST_HEX_IDH0181              DEST_HEX_IDH0182  
                    0.327790                     -1.955969  
            DEST_HEX_IDH0183              DEST_HEX_IDH0184  
                   -1.565103                      0.395923  
            DEST_HEX_IDH0185              DEST_HEX_IDH0186  
                    0.492171                      0.334836  
            DEST_HEX_IDH0187              DEST_HEX_IDH0188  
                   -0.064210                      2.254864  
            DEST_HEX_IDH0189              DEST_HEX_IDH0190  
                    1.845267                     -2.364287  
            DEST_HEX_IDH0191              DEST_HEX_IDH0192  
                   -3.183920                      0.252708  
            DEST_HEX_IDH0193              DEST_HEX_IDH0194  
                    0.903534                     -0.012116  
            DEST_HEX_IDH0195              DEST_HEX_IDH0196  
                   -0.710085                      0.474519  
            DEST_HEX_IDH0197              DEST_HEX_IDH0198  
                    0.422082                      0.019680  
            DEST_HEX_IDH0199              DEST_HEX_IDH0200  
                    1.993161                     -1.916137  
            DEST_HEX_IDH0201              DEST_HEX_IDH0202  
                   -2.422086                     -0.715195  
            DEST_HEX_IDH0203              DEST_HEX_IDH0204  
                   -1.244417                     -0.971070  
            DEST_HEX_IDH0205              DEST_HEX_IDH0206  
                   -0.604545                      0.161051  
            DEST_HEX_IDH0207              DEST_HEX_IDH0208  
                    1.688709                      1.490580  
            DEST_HEX_IDH0209              DEST_HEX_IDH0210  
                   -1.542576                      0.018776  
            DEST_HEX_IDH0211              DEST_HEX_IDH0212  
                   -0.917817                     -2.574847  
            DEST_HEX_IDH0213              DEST_HEX_IDH0214  
                   -2.424022                     -0.421448  
            DEST_HEX_IDH0215              DEST_HEX_IDH0216  
                   -0.830233                     -0.578691  
            DEST_HEX_IDH0217              DEST_HEX_IDH0218  
                   -2.526788                      0.609277  
            DEST_HEX_IDH0219              DEST_HEX_IDH0220  
                   -0.421367                      0.737162  
            DEST_HEX_IDH0221              DEST_HEX_IDH0222  
                   -1.485094                     -1.103193  
            DEST_HEX_IDH0223              DEST_HEX_IDH0224  
                   -2.148484                     -1.056538  
            DEST_HEX_IDH0225              DEST_HEX_IDH0226  
                   -1.180716                     -0.448350  
            DEST_HEX_IDH0227              DEST_HEX_IDH0228  
                   -0.273084                     -3.025649  
            DEST_HEX_IDH0229              DEST_HEX_IDH0230  
                   -0.291073                      0.400187  
            DEST_HEX_IDH0231              DEST_HEX_IDH0232  
                    0.403568                      0.516344  
            DEST_HEX_IDH0233              DEST_HEX_IDH0234  
                   -2.992607                     -1.052653  
            DEST_HEX_IDH0235              DEST_HEX_IDH0236  
                   -0.254465                      0.211855  
            DEST_HEX_IDH0237              DEST_HEX_IDH0238  
                    1.129947                     -2.316766  
            DEST_HEX_IDH0239              DEST_HEX_IDH0240  
                   -1.769268                     -0.026357  
            DEST_HEX_IDH0241              DEST_HEX_IDH0242  
                   -2.548594                      2.244059  
            DEST_HEX_IDH0243              DEST_HEX_IDH0244  
                   -3.341831                      2.108375  
            DEST_HEX_IDH0245              DEST_HEX_IDH0246  
                   -3.605962                     -0.426559  
            DEST_HEX_IDH0247              DEST_HEX_IDH0248  
                    1.156349                      2.007398  
            DEST_HEX_IDH0249              DEST_HEX_IDH0250  
                   -2.022829                     -0.545181  
            DEST_HEX_IDH0251              DEST_HEX_IDH0252  
                   -1.864968                      1.001726  
            DEST_HEX_IDH0253              DEST_HEX_IDH0254  
                   -1.190006                      0.691013  
            DEST_HEX_IDH0255              DEST_HEX_IDH0256  
                   -1.731131                     -1.918208  
            DEST_HEX_IDH0257              DEST_HEX_IDH0258  
                    2.235644                     -0.176790  
            DEST_HEX_IDH0259              DEST_HEX_IDH0260  
                    0.567402                      0.317560  
            DEST_HEX_IDH0262              DEST_HEX_IDH0263  
                   -0.275585                     -0.890715  
            DEST_HEX_IDH0264              DEST_HEX_IDH0265  
                   -1.047786                      0.600368  
            DEST_HEX_IDH0266              DEST_HEX_IDH0267  
                    0.462198                     -1.801778  
            DEST_HEX_IDH0269              DEST_HEX_IDH0270  
                    0.016106                      0.074611  
            DEST_HEX_IDH0271              DEST_HEX_IDH0272  
                   -0.834322                     -0.605632  
            DEST_HEX_IDH0273              DEST_HEX_IDH0274  
                    0.123794                     -0.570222  
            DEST_HEX_IDH0275              DEST_HEX_IDH0276  
                   -1.343404                      1.090627  
            DEST_HEX_IDH0277              DEST_HEX_IDH0278  
                    0.517975                     -1.075881  
            DEST_HEX_IDH0279              DEST_HEX_IDH0280  
                    1.372744                      1.542906  
            DEST_HEX_IDH0281              DEST_HEX_IDH0282  
                   -1.732133                     -0.072820  
            DEST_HEX_IDH0283              DEST_HEX_IDH0284  
                   -1.068430                     -1.105049  
            DEST_HEX_IDH0285              DEST_HEX_IDH0286  
                   -1.814433                      1.307721  
            DEST_HEX_IDH0287              DEST_HEX_IDH0288  
                   -0.513805                      0.965468  
            DEST_HEX_IDH0289              DEST_HEX_IDH0290  
                   -0.343128                      0.436907  
            DEST_HEX_IDH0291              DEST_HEX_IDH0292  
                   -1.722802                     -0.885500  
            DEST_HEX_IDH0293              DEST_HEX_IDH0294  
                   -0.086213                      0.369718  
            DEST_HEX_IDH0295              DEST_HEX_IDH0296  
                    0.227305                      0.280903  
            DEST_HEX_IDH0297              DEST_HEX_IDH0298  
                    0.571866                      0.744678  
            DEST_HEX_IDH0299              DEST_HEX_IDH0300  
                    0.591608                      0.735837  
            DEST_HEX_IDH0301              DEST_HEX_IDH0302  
                   -0.438701                      0.343720  
            DEST_HEX_IDH0303              DEST_HEX_IDH0304  
                   -0.559544                     -2.834518  
            DEST_HEX_IDH0305              DEST_HEX_IDH0306  
                    1.267851                      1.295785  
            DEST_HEX_IDH0307              DEST_HEX_IDH0308  
                   -0.179821                     -1.466969  
            DEST_HEX_IDH0309              DEST_HEX_IDH0310  
                   -1.224047                     -0.771908  
            DEST_HEX_IDH0311              DEST_HEX_IDH0312  
                    0.574280                     -2.676358  
            DEST_HEX_IDH0313              DEST_HEX_IDH0314  
                    0.107905                     -1.514835  
            DEST_HEX_IDH0315              DEST_HEX_IDH0316  
                   -2.233886                     -1.594280  
            DEST_HEX_IDH0317              DEST_HEX_IDH0318  
                   -1.730281                      0.992577  
            DEST_HEX_IDH0319              DEST_HEX_IDH0320  
                   -1.593182                     -0.138439  
            DEST_HEX_IDH0321              DEST_HEX_IDH0322  
                    2.021850                     -2.680706  
            DEST_HEX_IDH0323              DEST_HEX_IDH0324  
                   -0.028830                      2.619908  
            DEST_HEX_IDH0325              DEST_HEX_IDH0326  
                   -0.547230                     -0.899600  
            DEST_HEX_IDH0327              DEST_HEX_IDH0328  
                   -1.073278                     -0.742604  
            DEST_HEX_IDH0329              DEST_HEX_IDH0330  
                   -0.385207                     -0.824010  
            DEST_HEX_IDH0331              DEST_HEX_IDH0332  
                    0.570849                      0.434933  
            DEST_HEX_IDH0333              DEST_HEX_IDH0334  
                    0.713452                     -1.114899  
            DEST_HEX_IDH0335              DEST_HEX_IDH0336  
                   -1.608353                      0.410465  
            DEST_HEX_IDH0337              DEST_HEX_IDH0338  
                   -0.054080                     -2.437313  
            DEST_HEX_IDH0339              DEST_HEX_IDH0340  
                   -0.777149                      0.613230  
            DEST_HEX_IDH0341              DEST_HEX_IDH0343  
                   -0.357169                     -1.253191  
            DEST_HEX_IDH0344              DEST_HEX_IDH0345  
                   -0.072134                      0.924415  
            DEST_HEX_IDH0346              DEST_HEX_IDH0347  
                    1.011533                      1.726631  
            DEST_HEX_IDH0348              DEST_HEX_IDH0350  
                   -0.988993                     -0.179210  
            DEST_HEX_IDH0351              DEST_HEX_IDH0352  
                    0.497133                      0.696468  
            DEST_HEX_IDH0353              DEST_HEX_IDH0354  
                   -0.261781                     -1.092644  
            DEST_HEX_IDH0355              DEST_HEX_IDH0356  
                   -0.649887                      0.367864  
            DEST_HEX_IDH0357              DEST_HEX_IDH0358  
                   -0.037958                     -1.354799  
            DEST_HEX_IDH0360              DEST_HEX_IDH0361  
                   -0.382717                      0.318738  
            DEST_HEX_IDH0362              DEST_HEX_IDH0363  
                   -0.049146                     -0.679067  
            DEST_HEX_IDH0364              DEST_HEX_IDH0365  
                   -2.151120                      0.445607  
            DEST_HEX_IDH0366              DEST_HEX_IDH0367  
                   -3.115878                     -1.281995  
            DEST_HEX_IDH0368              DEST_HEX_IDH0369  
                    0.367994                      0.300979  
            DEST_HEX_IDH0370              DEST_HEX_IDH0371  
                   -0.114858                     -0.563315  
            DEST_HEX_IDH0372              DEST_HEX_IDH0373  
                   -0.339774                     -1.080986  
            DEST_HEX_IDH0374              DEST_HEX_IDH0375  
                   -1.217987                     -1.855625  
            DEST_HEX_IDH0376              DEST_HEX_IDH0377  
                   -0.394870                     -0.822520  
            DEST_HEX_IDH0378              DEST_HEX_IDH0379  
                   -0.386030                      0.280561  
            DEST_HEX_IDH0380              DEST_HEX_IDH0381  
                    0.048583                     -0.699764  
            DEST_HEX_IDH0382              DEST_HEX_IDH0383  
                    0.050278                     -0.686957  
            DEST_HEX_IDH0384              DEST_HEX_IDH0385  
                   -1.241378                      0.617815  
            DEST_HEX_IDH0386              DEST_HEX_IDH0387  
                   -0.737906                     -0.587431  
            DEST_HEX_IDH0388              DEST_HEX_IDH0389  
                   -0.287042                     -0.662963  
            DEST_HEX_IDH0390              DEST_HEX_IDH0391  
                   -3.057418                     -0.209004  
            DEST_HEX_IDH0392              DEST_HEX_IDH0393  
                    1.107257                     -1.074413  
            DEST_HEX_IDH0394              DEST_HEX_IDH0395  
                    1.910391                      0.274647  
            DEST_HEX_IDH0396              DEST_HEX_IDH0397  
                    0.806884                     -1.017502  
            DEST_HEX_IDH0398              DEST_HEX_IDH0399  
                   -2.433288                     -3.012063  
            DEST_HEX_IDH0400              DEST_HEX_IDH0401  
                    0.802270                     -1.370056  
            DEST_HEX_IDH0402              DEST_HEX_IDH0403  
                   -0.275661                      0.517502  
            DEST_HEX_IDH0404              DEST_HEX_IDH0405  
                    0.558294                      0.296669  
            DEST_HEX_IDH0406              DEST_HEX_IDH0407  
                   -0.944694                      0.189850  
            DEST_HEX_IDH0408              DEST_HEX_IDH0409  
                   -3.635797                     -2.015791  
            DEST_HEX_IDH0410              DEST_HEX_IDH0411  
                   -1.377426                     -1.950526  
            DEST_HEX_IDH0412              DEST_HEX_IDH0413  
                    1.624132                     -0.701755  
            DEST_HEX_IDH0414              DEST_HEX_IDH0415  
                    0.686505                     -1.374983  
            DEST_HEX_IDH0416              DEST_HEX_IDH0417  
                    0.220122                      0.076059  
            DEST_HEX_IDH0418              DEST_HEX_IDH0419  
                   -0.476678                     -0.233611  
            DEST_HEX_IDH0420              DEST_HEX_IDH0421  
                    0.577999                     -3.315958  
            DEST_HEX_IDH0422              DEST_HEX_IDH0423  
                   -1.021325                     -0.490900  
            DEST_HEX_IDH0424              DEST_HEX_IDH0425  
                   -0.832885                     -2.587718  
            DEST_HEX_IDH0426              DEST_HEX_IDH0427  
                   -1.882585                     -4.093529  
            DEST_HEX_IDH0428              DEST_HEX_IDH0429  
                    1.280356                      0.605878  
            DEST_HEX_IDH0430              DEST_HEX_IDH0431  
                   -4.513139                     -0.216807  
            DEST_HEX_IDH0432              DEST_HEX_IDH0433  
                    1.315922                      0.127683  
            DEST_HEX_IDH0434              DEST_HEX_IDH0435  
                    0.817259                     -1.242467  
            DEST_HEX_IDH0436              DEST_HEX_IDH0437  
                    0.569524                     -1.494054  
            DEST_HEX_IDH0438              DEST_HEX_IDH0439  
                   -0.419466                     -1.831108  
            DEST_HEX_IDH0440              DEST_HEX_IDH0441  
                    1.192634                     -0.002727  
            DEST_HEX_IDH0442              DEST_HEX_IDH0443  
                   -0.449666                      0.798421  
            DEST_HEX_IDH0444              DEST_HEX_IDH0445  
                   -2.924821                     -0.647105  
            DEST_HEX_IDH0446              DEST_HEX_IDH0447  
                   -0.899169                      1.495998  
            DEST_HEX_IDH0448              DEST_HEX_IDH0449  
                   -0.618135                     -1.675334  
            DEST_HEX_IDH0450              DEST_HEX_IDH0451  
                   -2.189595                     -0.995105  
            DEST_HEX_IDH0452              DEST_HEX_IDH0453  
                    0.262153                     -1.176452  
            DEST_HEX_IDH0455              DEST_HEX_IDH0456  
                   -1.919648                      1.332227  
            DEST_HEX_IDH0457              DEST_HEX_IDH0458  
                    1.918172                      0.901950  
            DEST_HEX_IDH0459              DEST_HEX_IDH0460  
                   -1.329130                     -0.215930  
            DEST_HEX_IDH0461              DEST_HEX_IDH0462  
                   -0.590488                     -0.291165  
            DEST_HEX_IDH0463              DEST_HEX_IDH0464  
                    0.411210                     -0.587622  
            DEST_HEX_IDH0465              DEST_HEX_IDH0466  
                   -2.105754                      0.191339  
            DEST_HEX_IDH0467              DEST_HEX_IDH0468  
                    0.135016                      0.514704  
            DEST_HEX_IDH0469              DEST_HEX_IDH0470  
                    0.340381                     -0.839904  
            DEST_HEX_IDH0471              DEST_HEX_IDH0472  
                   -0.242418                      1.109763  
            DEST_HEX_IDH0473              DEST_HEX_IDH0474  
                    0.299672                      1.246826  
            DEST_HEX_IDH0475              DEST_HEX_IDH0476  
                    0.656501                     -0.549056  
            DEST_HEX_IDH0477              DEST_HEX_IDH0478  
                    1.140609                      0.164890  
            DEST_HEX_IDH0479              DEST_HEX_IDH0480  
                   -0.537443                     -0.615519  
            DEST_HEX_IDH0481              DEST_HEX_IDH0482  
                   -0.396871                     -0.554124  
            DEST_HEX_IDH0483              DEST_HEX_IDH0484  
                    0.178551                     -0.367942  
            DEST_HEX_IDH0485              DEST_HEX_IDH0486  
                    0.206290                      0.578248  
            DEST_HEX_IDH0487              DEST_HEX_IDH0488  
                    0.047823                      1.615660  
            DEST_HEX_IDH0489              DEST_HEX_IDH0490  
                    0.721276                     -1.460553  
            DEST_HEX_IDH0491              DEST_HEX_IDH0492  
                    0.678536                      0.143218  
            DEST_HEX_IDH0493              DEST_HEX_IDH0494  
                   -2.178521                      0.324675  
            DEST_HEX_IDH0495              DEST_HEX_IDH0496  
                    0.870914                      0.946352  
            DEST_HEX_IDH0497              DEST_HEX_IDH0498  
                   -1.773379                     -0.545453  
            DEST_HEX_IDH0499              DEST_HEX_IDH0500  
                    0.430095                     -0.401274  
            DEST_HEX_IDH0501              DEST_HEX_IDH0502  
                    0.175385                      0.306909  
            DEST_HEX_IDH0503              DEST_HEX_IDH0504  
                   -0.511218                     -0.637789  
            DEST_HEX_IDH0505              DEST_HEX_IDH0506  
                    0.191910                      0.818885  
            DEST_HEX_IDH0507              DEST_HEX_IDH0508  
                    1.656179                     -0.265123  
            DEST_HEX_IDH0509              DEST_HEX_IDH0510  
                    0.594341                     -0.970359  
            DEST_HEX_IDH0511              DEST_HEX_IDH0512  
                    0.540222                      0.175130  
            DEST_HEX_IDH0513              DEST_HEX_IDH0514  
                   -0.932979                     -0.346525  
            DEST_HEX_IDH0515              DEST_HEX_IDH0516  
                    0.901986                      1.095957  
            DEST_HEX_IDH0517              DEST_HEX_IDH0518  
                   -0.319422                      1.790243  
            DEST_HEX_IDH0519              DEST_HEX_IDH0520  
                   -0.615147                     -0.504652  
            DEST_HEX_IDH0521              DEST_HEX_IDH0522  
                    1.699636                     -1.490054  
            DEST_HEX_IDH0523              DEST_HEX_IDH0524  
                   -1.326905                     -0.581863  
            DEST_HEX_IDH0525              DEST_HEX_IDH0526  
                   -0.992375                      0.166071  
            DEST_HEX_IDH0527              DEST_HEX_IDH0528  
                    1.310329                      0.398100  
            DEST_HEX_IDH0529              DEST_HEX_IDH0530  
                    0.134082                      0.594348  
            DEST_HEX_IDH0531              DEST_HEX_IDH0532  
                    0.126676                      0.427852  
            DEST_HEX_IDH0533              DEST_HEX_IDH0534  
                    0.241757                     -2.590213  
            DEST_HEX_IDH0535              DEST_HEX_IDH0536  
                   -2.533985                     -0.893911  
            DEST_HEX_IDH0537              DEST_HEX_IDH0538  
                    0.956867                      0.728837  
            DEST_HEX_IDH0539              DEST_HEX_IDH0540  
                   -0.235660                      0.407309  
            DEST_HEX_IDH0541              DEST_HEX_IDH0542  
                   -0.199082                     -2.173861  
            DEST_HEX_IDH0543              DEST_HEX_IDH0544  
                    0.762588                     -0.791667  
            DEST_HEX_IDH0545              DEST_HEX_IDH0546  
                   -0.357526                     -1.329613  
            DEST_HEX_IDH0547              DEST_HEX_IDH0548  
                   -0.532033                     -0.537087  
            DEST_HEX_IDH0549              DEST_HEX_IDH0550  
                    0.333035                      0.543523  
            DEST_HEX_IDH0551              DEST_HEX_IDH0552  
                    0.153785                      0.088228  
            DEST_HEX_IDH0553              DEST_HEX_IDH0554  
                    0.785165                     -1.382014  
            DEST_HEX_IDH0555              DEST_HEX_IDH0556  
                   -0.840259                     -0.351756  
            DEST_HEX_IDH0557              DEST_HEX_IDH0558  
                   -2.468208                      0.882427  
            DEST_HEX_IDH0559              DEST_HEX_IDH0560  
                    0.375011                      0.176072  
            DEST_HEX_IDH0561              DEST_HEX_IDH0562  
                    0.548912                      0.766926  
            DEST_HEX_IDH0563              DEST_HEX_IDH0564  
                    0.104668                     -2.382528  
            DEST_HEX_IDH0565              DEST_HEX_IDH0566  
                   -0.627894                     -1.711885  
            DEST_HEX_IDH0567              DEST_HEX_IDH0568  
                   -1.582364                     -1.743225  
            DEST_HEX_IDH0569              DEST_HEX_IDH0570  
                   -3.293771                     -1.852080  
            DEST_HEX_IDH0571              DEST_HEX_IDH0572  
                   -1.592607                     -1.092612  
            DEST_HEX_IDH0573              DEST_HEX_IDH0574  
                   -1.929518                      0.356136  
            DEST_HEX_IDH0575              DEST_HEX_IDH0576  
                   -0.702861                     -0.819818  
            DEST_HEX_IDH0577              DEST_HEX_IDH0578  
                    0.353772                     -1.721394  
            DEST_HEX_IDH0579              DEST_HEX_IDH0580  
                   -1.454181                     -2.182767  
            DEST_HEX_IDH0581              DEST_HEX_IDH0582  
                    0.414210                     -0.226494  
            DEST_HEX_IDH0583              DEST_HEX_IDH0584  
                   -0.031205                      0.768722  
            DEST_HEX_IDH0585              DEST_HEX_IDH0586  
                   -0.799293                      0.321606  
            DEST_HEX_IDH0587              DEST_HEX_IDH0588  
                    0.266054                     -1.564981  
            DEST_HEX_IDH0589              DEST_HEX_IDH0590  
                    0.644320                      0.529880  
            DEST_HEX_IDH0591              DEST_HEX_IDH0592  
                   -1.812881                      0.583079  
            DEST_HEX_IDH0593              DEST_HEX_IDH0594  
                    0.659932                     -0.723317  
            DEST_HEX_IDH0595              DEST_HEX_IDH0596  
                    0.575915                      2.024891  
            DEST_HEX_IDH0597              DEST_HEX_IDH0598  
                   -0.796467                      0.870620  
            DEST_HEX_IDH0599              DEST_HEX_IDH0600  
                   -0.649037                     -0.282431  
            DEST_HEX_IDH0601              DEST_HEX_IDH0602  
                   -3.165597                     -1.431076  
            DEST_HEX_IDH0603              DEST_HEX_IDH0604  
                    0.237544                     -0.825486  
            DEST_HEX_IDH0605              DEST_HEX_IDH0606  
                   -0.260362                     -0.458146  
            DEST_HEX_IDH0607              DEST_HEX_IDH0608  
                    0.158635                     -0.039751  
            DEST_HEX_IDH0609              DEST_HEX_IDH0610  
                    0.250282                      0.720942  
            DEST_HEX_IDH0611              DEST_HEX_IDH0612  
                   -2.987963                      0.606478  
            DEST_HEX_IDH0613              DEST_HEX_IDH0614  
                   -0.514296                     -1.715381  
            DEST_HEX_IDH0615              DEST_HEX_IDH0616  
                    0.133916                      0.735593  
            DEST_HEX_IDH0617              DEST_HEX_IDH0618  
                    0.709310                      0.266725  
            DEST_HEX_IDH0619              DEST_HEX_IDH0620  
                   -0.661137                      0.084681  
            DEST_HEX_IDH0621              DEST_HEX_IDH0622  
                   -0.140161                     -0.366176  
            DEST_HEX_IDH0623              DEST_HEX_IDH0624  
                   -0.986144                     -1.057974  
            DEST_HEX_IDH0625              DEST_HEX_IDH0626  
                   -0.855630                      0.287513  
            DEST_HEX_IDH0627              DEST_HEX_IDH0628  
                   -0.437735                     -0.090149  
            DEST_HEX_IDH0629              DEST_HEX_IDH0630  
                   -0.310697                      0.081880  
            DEST_HEX_IDH0631              DEST_HEX_IDH0632  
                   -0.285830                      0.251034  
            DEST_HEX_IDH0633              DEST_HEX_IDH0634  
                    1.337195                      0.733458  
            DEST_HEX_IDH0635              DEST_HEX_IDH0636  
                   -1.559890                      0.562477  
            DEST_HEX_IDH0637              DEST_HEX_IDH0638  
                   -4.261790                      0.204007  
            DEST_HEX_IDH0639              DEST_HEX_IDH0640  
                    0.529597                     -0.273620  
            DEST_HEX_IDH0641              DEST_HEX_IDH0642  
                   -2.155596                      0.116591  
            DEST_HEX_IDH0643              DEST_HEX_IDH0644  
                    0.391672                     -0.154811  
            DEST_HEX_IDH0645              DEST_HEX_IDH0646  
                    0.602266                      1.053299  
            DEST_HEX_IDH0647              DEST_HEX_IDH0648  
                   -0.579601                      1.192656  
            DEST_HEX_IDH0649              DEST_HEX_IDH0650  
                   -0.296750                     -1.453718  
            DEST_HEX_IDH0651              DEST_HEX_IDH0652  
                    0.505407                      1.669845  
            DEST_HEX_IDH0653              DEST_HEX_IDH0654  
                    0.756263                      0.153634  
            DEST_HEX_IDH0655              DEST_HEX_IDH0656  
                   -2.116932                     -2.524383  
            DEST_HEX_IDH0657              DEST_HEX_IDH0658  
                   -0.216999                     -0.019894  
            DEST_HEX_IDH0659              DEST_HEX_IDH0660  
                   -0.582749                     -1.205878  
            DEST_HEX_IDH0661              DEST_HEX_IDH0662  
                   -0.022655                     -0.352192  
            DEST_HEX_IDH0663              DEST_HEX_IDH0664  
                    1.674879                      0.344017  
            DEST_HEX_IDH0665              DEST_HEX_IDH0666  
                   -0.185964                      0.985143  
            DEST_HEX_IDH0667              DEST_HEX_IDH0668  
                    0.698871                     -0.085760  
            DEST_HEX_IDH0669              DEST_HEX_IDH0670  
                   -0.856773                     -2.693955  
            DEST_HEX_IDH0671              DEST_HEX_IDH0672  
                   -2.439825                      0.329412  
            DEST_HEX_IDH0673              DEST_HEX_IDH0674  
                    0.349950                      0.402584  
            DEST_HEX_IDH0675              DEST_HEX_IDH0676  
                   -0.207295                     -0.037937  
            DEST_HEX_IDH0677              DEST_HEX_IDH0678  
                    0.014631                      1.074862  
            DEST_HEX_IDH0679              DEST_HEX_IDH0680  
                    0.362978                      0.070479  
            DEST_HEX_IDH0681              DEST_HEX_IDH0682  
                    0.302744                      1.848989  
            DEST_HEX_IDH0683              DEST_HEX_IDH0684  
                   -0.862326                      1.505071  
            DEST_HEX_IDH0685              DEST_HEX_IDH0686  
                   -0.280385                     -0.268918  
            DEST_HEX_IDH0687              DEST_HEX_IDH0688  
                   -1.074198                     -3.070152  
            DEST_HEX_IDH0689              DEST_HEX_IDH0690  
                   -0.173775                      1.364047  
            DEST_HEX_IDH0691              DEST_HEX_IDH0692  
                   -0.475215                      1.329807  
            DEST_HEX_IDH0693              DEST_HEX_IDH0694  
                    0.014393                      0.376420  
            DEST_HEX_IDH0695              DEST_HEX_IDH0696  
                    0.490737                     -2.505414  
            DEST_HEX_IDH0697              DEST_HEX_IDH0698  
                    0.536225                      0.212710  
            DEST_HEX_IDH0700              DEST_HEX_IDH0701  
                    0.400689                     -1.473095  
            DEST_HEX_IDH0702              DEST_HEX_IDH0703  
                    0.297366                      0.199912  
            DEST_HEX_IDH0704              DEST_HEX_IDH0705  
                   -2.783079                      0.508959  
            DEST_HEX_IDH0706              DEST_HEX_IDH0707  
                    0.083767                     -0.058548  
            DEST_HEX_IDH0708              DEST_HEX_IDH0709  
                   -0.561000                     -0.963447  
            DEST_HEX_IDH0710              DEST_HEX_IDH0711  
                   -3.410460                     -3.186207  
            DEST_HEX_IDH0712              DEST_HEX_IDH0713  
                   -0.071617                     -2.041950  
            DEST_HEX_IDH0714              DEST_HEX_IDH0715  
                   -0.482467                      0.500021  
            DEST_HEX_IDH0716              DEST_HEX_IDH0717  
                    0.666160                     -2.183745  
            DEST_HEX_IDH0718              DEST_HEX_IDH0719  
                   -0.141041                     -0.034067  
            DEST_HEX_IDH0720              DEST_HEX_IDH0721  
                    0.440568                      0.482173  
            DEST_HEX_IDH0722              DEST_HEX_IDH0723  
                   -1.817255                     -3.217229  
            DEST_HEX_IDH0724              DEST_HEX_IDH0725  
                   -0.343437                      2.149084  
            DEST_HEX_IDH0726              DEST_HEX_IDH0727  
                   -0.407568                      0.226993  
            DEST_HEX_IDH0728              DEST_HEX_IDH0729  
                   -1.720457                     -0.300803  
            DEST_HEX_IDH0730              DEST_HEX_IDH0731  
                   -1.979054                      0.100878  
            DEST_HEX_IDH0732              DEST_HEX_IDH0733  
                   -1.191069                      0.348106  
            DEST_HEX_IDH0734              DEST_HEX_IDH0735  
                   -0.900338                     -0.332181  
            DEST_HEX_IDH0736              DEST_HEX_IDH0737  
                    0.018247                      0.525413  
            DEST_HEX_IDH0738              DEST_HEX_IDH0739  
                    0.561117                      0.838880  
            DEST_HEX_IDH0740              DEST_HEX_IDH0741  
                    0.201339                      0.739092  
            DEST_HEX_IDH0742              DEST_HEX_IDH0743  
                   -1.828719                      0.433385  
            DEST_HEX_IDH0744              DEST_HEX_IDH0745  
                    0.687164                      0.318169  
            DEST_HEX_IDH0746              DEST_HEX_IDH0747  
                   -0.035230                     -0.837292  
            DEST_HEX_IDH0748              DEST_HEX_IDH0749  
                    0.721308                     -0.237105  
            DEST_HEX_IDH0750              DEST_HEX_IDH0751  
                    0.320425                     -2.375035  
            DEST_HEX_IDH0752              DEST_HEX_IDH0753  
                    1.036600                     -0.147715  
            DEST_HEX_IDH0754              DEST_HEX_IDH0755  
                    0.082484                     -1.828676  
            DEST_HEX_IDH0756              DEST_HEX_IDH0757  
                    0.247435                     -0.551584  
            DEST_HEX_IDH0758              DEST_HEX_IDH0759  
                   -2.285919                      2.287398  
            DEST_HEX_IDH0760              DEST_HEX_IDH0761  
                   -0.020853                      0.289492  
            DEST_HEX_IDH0762              DEST_HEX_IDH0763  
                   -0.428609                      1.120728  
            DEST_HEX_IDH0764              DEST_HEX_IDH0765  
                   -0.006426                      0.181661  
            DEST_HEX_IDH0766              DEST_HEX_IDH0767  
                   -0.557177                      1.923412  
            DEST_HEX_IDH0768              DEST_HEX_IDH0769  
                   -0.774517                     -0.860167  
            DEST_HEX_IDH0770              DEST_HEX_IDH0771  
                   -1.865981                     -0.838658  
            DEST_HEX_IDH0772              DEST_HEX_IDH0773  
                    0.778089                     -0.007445  
            DEST_HEX_IDH0774              DEST_HEX_IDH0775  
                   -0.705372                     -2.360796  
            DEST_HEX_IDH0776              DEST_HEX_IDH0777  
                   -0.876324                     -0.894508  
            DEST_HEX_IDH0778              DEST_HEX_IDH0779  
                    0.638183                      0.637244  
            DEST_HEX_IDH0780              DEST_HEX_IDH0781  
                    0.591195                     -0.187705  
            DEST_HEX_IDH0782              DEST_HEX_IDH0783  
                   -1.644665                      0.500735  
            DEST_HEX_IDH0784              DEST_HEX_IDH0785  
                    1.154434                      0.791636  
            DEST_HEX_IDH0786              DEST_HEX_IDH0787  
                    0.180312                      0.496277  
            DEST_HEX_IDH0788              DEST_HEX_IDH0789  
                   -0.725127                     -0.262927  
            DEST_HEX_IDH0790              DEST_HEX_IDH0791  
                    0.089542                      0.148080  
            DEST_HEX_IDH0792              DEST_HEX_IDH0793  
                   -0.974020                     -0.384126  
            DEST_HEX_IDH0794              DEST_HEX_IDH0795  
                    0.432271                     -1.057464  
            DEST_HEX_IDH0796              DEST_HEX_IDH0797  
                   -1.242587                     -2.375035  
            DEST_HEX_IDH0798              DEST_HEX_IDH0799  
                   -1.686066                      0.098656  
            DEST_HEX_IDH0800              DEST_HEX_IDH0801  
                   -1.108089                     -1.303432  
            DEST_HEX_IDH0802              DEST_HEX_IDH0803  
                    0.365040                     -0.639763  
            DEST_HEX_IDH0804              DEST_HEX_IDH0805  
                   -1.795104                     -3.145391  
            DEST_HEX_IDH0806              DEST_HEX_IDH0807  
                   -2.318863                     -1.258466  
            DEST_HEX_IDH0808              DEST_HEX_IDH0809  
                   -1.670844                     -1.680395  
            DEST_HEX_IDH0810              DEST_HEX_IDH0811  
                   -1.707874                     -1.402727  
            DEST_HEX_IDH0812              DEST_HEX_IDH0813  
                   -1.550349                     -1.738124  
            DEST_HEX_IDH0814              DEST_HEX_IDH0815  
                   -0.486595                     -1.812091  
            DEST_HEX_IDH0816              DEST_HEX_IDH0817  
                   -1.311502                      0.508802  
            DEST_HEX_IDH0818              DEST_HEX_IDH0819  
                    1.570009                      1.336435  
            DEST_HEX_IDH0820              DEST_HEX_IDH0821  
                    1.945125                      2.111503  
            DEST_HEX_IDH0822              DEST_HEX_IDH0823  
                    0.220132                     -0.110647  
            DEST_HEX_IDH0824              DEST_HEX_IDH0825  
                   -0.429357                     -0.348288  
            DEST_HEX_IDH0826              DEST_HEX_IDH0827  
                   -0.178559                     -0.048440  
            DEST_HEX_IDH0828              DEST_HEX_IDH0829  
                   -1.889403                     -0.300993  
            DEST_HEX_IDH0830              DEST_HEX_IDH0831  
                   -0.500570                      0.176718  
log(ORIG_HDB_RESIDENT_COUNT)    log(ORIG_BUS_ALIGHT_COUNT)  
                    0.013295                      0.636191  
log(ORIG_TRAIN_ALIGHT_COUNT)                 log(DISTANCE)  
                   -0.008456                     -1.529223  

Degrees of Freedom: 59275 Total (i.e. Null);  58454 Residual
Null Deviance:      19980000 
Residual Deviance: 5004000  AIC: 5274000</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="insights-7" class="level4 callout-tips" data-collapse="true" data-appearance="minimal">
<h4 class="anchored" data-anchor-id="insights-7">Insights</h4>
<p><code>ORIG_TRAIN_ALIGHT_COUNT</code>, has <strong>negative</strong> coefficients, consistent with that of <strong>unconstrained</strong> model.</p>
<p>Instead of having more bus trips as a result of higher number of potential passengers, the <strong>higher number of passengers alighting from train, results in less bus trips</strong>. This result is contradictory to our hypothesis that <em>higher potential passengers result in higher bus trips.</em></p>
<p>A possible explanation to this is that passengers alighting from trains in a zone <strong>indicates the presence of train exits</strong>. As such, it could mean that this is an <strong>intervening force</strong>, i.e., <em>passengers prefer riding the trains instead of buses</em>.</p>
</section>
</div>
<div id="tabset-15-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>dbcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>                ORIG_HEX_ID <span class="sc">+</span> </span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>                DEST_HEX_ID <span class="sc">+</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DISTANCE),</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data_no_intra,</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(dbcSIM, <span class="st">"data/rds/dbcSIM202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Coefficients for our explanatory variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>dbcSIM <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/dbcSIM202310.rds"</span>)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">tail</span>(dbcSIM<span class="sc">$</span>coefficients, <span class="at">n=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">log(DISTANCE)</td>
<td style="text-align: right;">-1.566532</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-78-contents" aria-controls="callout-78" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Full model output
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-78" class="callout-78-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>dbcSIM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = TRIPS ~ ORIG_HEX_ID + DEST_HEX_ID + log(DISTANCE), 
    family = poisson(link = "log"), data = SIM_data_no_intra, 
    na.action = na.exclude)

Coefficients:
     (Intercept)  ORIG_HEX_IDH0003  ORIG_HEX_IDH0004  ORIG_HEX_IDH0005  
       10.342860          3.295132          2.196642          2.796487  
ORIG_HEX_IDH0006  ORIG_HEX_IDH0007  ORIG_HEX_IDH0008  ORIG_HEX_IDH0009  
        0.252549          0.916978          2.756927          3.907060  
ORIG_HEX_IDH0010  ORIG_HEX_IDH0011  ORIG_HEX_IDH0012  ORIG_HEX_IDH0013  
        1.601415          2.239640          1.398398          1.251016  
ORIG_HEX_IDH0014  ORIG_HEX_IDH0015  ORIG_HEX_IDH0016  ORIG_HEX_IDH0017  
        6.316357          0.270915          5.732339          2.187543  
ORIG_HEX_IDH0018  ORIG_HEX_IDH0019  ORIG_HEX_IDH0020  ORIG_HEX_IDH0021  
        1.713006          1.022628          1.295207          1.054855  
ORIG_HEX_IDH0022  ORIG_HEX_IDH0023  ORIG_HEX_IDH0024  ORIG_HEX_IDH0025  
        2.601969          5.888930          2.117606          2.140295  
ORIG_HEX_IDH0026  ORIG_HEX_IDH0027  ORIG_HEX_IDH0028  ORIG_HEX_IDH0029  
        2.951607          3.241226         -0.207266          0.999067  
ORIG_HEX_IDH0030  ORIG_HEX_IDH0031  ORIG_HEX_IDH0032  ORIG_HEX_IDH0033  
        2.982898          1.309840          1.344651          2.751572  
ORIG_HEX_IDH0034  ORIG_HEX_IDH0035  ORIG_HEX_IDH0036  ORIG_HEX_IDH0037  
        1.911046          1.325402          1.703653          2.642891  
ORIG_HEX_IDH0038  ORIG_HEX_IDH0039  ORIG_HEX_IDH0040  ORIG_HEX_IDH0041  
        2.681662          2.318596          2.126402          1.047504  
ORIG_HEX_IDH0042  ORIG_HEX_IDH0043  ORIG_HEX_IDH0044  ORIG_HEX_IDH0045  
        0.957136          3.217479          0.539115          1.607349  
ORIG_HEX_IDH0046  ORIG_HEX_IDH0047  ORIG_HEX_IDH0048  ORIG_HEX_IDH0049  
        4.875713          2.746578          2.057329          0.258010  
ORIG_HEX_IDH0050  ORIG_HEX_IDH0051  ORIG_HEX_IDH0052  ORIG_HEX_IDH0053  
        2.167910          1.740997          3.006085          2.167412  
ORIG_HEX_IDH0054  ORIG_HEX_IDH0055  ORIG_HEX_IDH0056  ORIG_HEX_IDH0057  
        1.479132          4.638471          3.254987          2.024130  
ORIG_HEX_IDH0058  ORIG_HEX_IDH0059  ORIG_HEX_IDH0060  ORIG_HEX_IDH0061  
        3.241607          1.551328          3.673176          1.308314  
ORIG_HEX_IDH0062  ORIG_HEX_IDH0063  ORIG_HEX_IDH0064  ORIG_HEX_IDH0065  
       -0.290845          3.696026          2.646070          4.172782  
ORIG_HEX_IDH0066  ORIG_HEX_IDH0067  ORIG_HEX_IDH0068  ORIG_HEX_IDH0069  
        2.614319          3.503384          1.462584          1.945864  
ORIG_HEX_IDH0070  ORIG_HEX_IDH0071  ORIG_HEX_IDH0072  ORIG_HEX_IDH0073  
        1.339897          2.475099          2.471205          2.271569  
ORIG_HEX_IDH0074  ORIG_HEX_IDH0075  ORIG_HEX_IDH0076  ORIG_HEX_IDH0077  
        0.825005          0.962726          3.203931          2.296958  
ORIG_HEX_IDH0079  ORIG_HEX_IDH0080  ORIG_HEX_IDH0081  ORIG_HEX_IDH0082  
        2.790192          1.332294          3.905149          3.575181  
ORIG_HEX_IDH0084  ORIG_HEX_IDH0085  ORIG_HEX_IDH0086  ORIG_HEX_IDH0087  
        1.748431         -1.295894          2.672017          2.432210  
ORIG_HEX_IDH0088  ORIG_HEX_IDH0089  ORIG_HEX_IDH0090  ORIG_HEX_IDH0091  
       -0.892603          2.900029          2.269109          2.636259  
ORIG_HEX_IDH0092  ORIG_HEX_IDH0093  ORIG_HEX_IDH0094  ORIG_HEX_IDH0095  
        1.492204          4.067545          1.110344          2.341789  
ORIG_HEX_IDH0096  ORIG_HEX_IDH0097  ORIG_HEX_IDH0098  ORIG_HEX_IDH0099  
        1.122621          1.870021          2.682657          1.889762  
ORIG_HEX_IDH0100  ORIG_HEX_IDH0101  ORIG_HEX_IDH0102  ORIG_HEX_IDH0103  
        3.871815          4.162910          2.249232          0.463556  
ORIG_HEX_IDH0104  ORIG_HEX_IDH0106  ORIG_HEX_IDH0107  ORIG_HEX_IDH0108  
        0.023125          1.303463          1.648774          1.071444  
ORIG_HEX_IDH0109  ORIG_HEX_IDH0110  ORIG_HEX_IDH0111  ORIG_HEX_IDH0112  
        3.413718          3.113541          2.091324          2.316196  
ORIG_HEX_IDH0114  ORIG_HEX_IDH0115  ORIG_HEX_IDH0116  ORIG_HEX_IDH0117  
        0.733658          2.111656          2.731059          5.451570  
ORIG_HEX_IDH0118  ORIG_HEX_IDH0119  ORIG_HEX_IDH0120  ORIG_HEX_IDH0121  
        3.317871         -0.978821          1.518374          2.048766  
ORIG_HEX_IDH0122  ORIG_HEX_IDH0123  ORIG_HEX_IDH0124  ORIG_HEX_IDH0125  
        2.929837          0.870948          1.831403          1.679878  
ORIG_HEX_IDH0126  ORIG_HEX_IDH0127  ORIG_HEX_IDH0128  ORIG_HEX_IDH0129  
        2.968007          0.769610          1.592742          1.519147  
ORIG_HEX_IDH0130  ORIG_HEX_IDH0131  ORIG_HEX_IDH0132  ORIG_HEX_IDH0133  
        0.885971          1.560675          0.601014          3.849947  
ORIG_HEX_IDH0134  ORIG_HEX_IDH0135  ORIG_HEX_IDH0136  ORIG_HEX_IDH0137  
        0.329524          0.976084          3.615036          2.430344  
ORIG_HEX_IDH0138  ORIG_HEX_IDH0139  ORIG_HEX_IDH0140  ORIG_HEX_IDH0141  
        2.721727          3.026662          4.524037          4.699229  
ORIG_HEX_IDH0142  ORIG_HEX_IDH0143  ORIG_HEX_IDH0144  ORIG_HEX_IDH0145  
        3.071854          0.574326          4.164597          4.097194  
ORIG_HEX_IDH0146  ORIG_HEX_IDH0147  ORIG_HEX_IDH0148  ORIG_HEX_IDH0149  
        2.526050          2.475151          3.481929          2.711296  
ORIG_HEX_IDH0150  ORIG_HEX_IDH0151  ORIG_HEX_IDH0152  ORIG_HEX_IDH0154  
        4.127005          1.436347          1.437688          1.224691  
ORIG_HEX_IDH0155  ORIG_HEX_IDH0156  ORIG_HEX_IDH0157  ORIG_HEX_IDH0158  
        1.575174          2.199306          1.280635          3.609992  
ORIG_HEX_IDH0159  ORIG_HEX_IDH0160  ORIG_HEX_IDH0161  ORIG_HEX_IDH0162  
        2.850979          2.688910          3.243202          0.567981  
ORIG_HEX_IDH0163  ORIG_HEX_IDH0164  ORIG_HEX_IDH0165  ORIG_HEX_IDH0166  
        4.320906          2.847953          4.313799          2.729087  
ORIG_HEX_IDH0167  ORIG_HEX_IDH0168  ORIG_HEX_IDH0169  ORIG_HEX_IDH0170  
        0.384690          3.136811          2.583338          3.127405  
ORIG_HEX_IDH0171  ORIG_HEX_IDH0172  ORIG_HEX_IDH0173  ORIG_HEX_IDH0174  
        3.461223          2.131074          0.898070          4.024263  
ORIG_HEX_IDH0175  ORIG_HEX_IDH0176  ORIG_HEX_IDH0177  ORIG_HEX_IDH0178  
        4.140412          3.339288          4.056493          2.257020  
ORIG_HEX_IDH0179  ORIG_HEX_IDH0180  ORIG_HEX_IDH0181  ORIG_HEX_IDH0182  
        3.937167          3.162736          2.585504          1.913811  
ORIG_HEX_IDH0183  ORIG_HEX_IDH0184  ORIG_HEX_IDH0185  ORIG_HEX_IDH0186  
        1.217113          3.431342          3.711728          3.441597  
ORIG_HEX_IDH0187  ORIG_HEX_IDH0188  ORIG_HEX_IDH0189  ORIG_HEX_IDH0190  
        3.227393          5.005891          4.376184          0.740622  
ORIG_HEX_IDH0191  ORIG_HEX_IDH0192  ORIG_HEX_IDH0193  ORIG_HEX_IDH0194  
        1.034566          3.277393          3.045996          3.100123  
ORIG_HEX_IDH0195  ORIG_HEX_IDH0196  ORIG_HEX_IDH0197  ORIG_HEX_IDH0198  
        2.162327          3.577606          3.639748          3.082512  
ORIG_HEX_IDH0199  ORIG_HEX_IDH0200  ORIG_HEX_IDH0201  ORIG_HEX_IDH0202  
        4.892143          1.562793          0.692267          2.708839  
ORIG_HEX_IDH0203  ORIG_HEX_IDH0204  ORIG_HEX_IDH0205  ORIG_HEX_IDH0206  
        2.596629          2.307015          2.458498          3.622007  
ORIG_HEX_IDH0207  ORIG_HEX_IDH0208  ORIG_HEX_IDH0209  ORIG_HEX_IDH0210  
        4.435873          4.357574          1.749356          2.164815  
ORIG_HEX_IDH0211  ORIG_HEX_IDH0212  ORIG_HEX_IDH0213  ORIG_HEX_IDH0214  
        2.014871          1.080550          0.122802          2.685780  
ORIG_HEX_IDH0215  ORIG_HEX_IDH0216  ORIG_HEX_IDH0217  ORIG_HEX_IDH0218  
        2.072178          2.496031          0.370652          3.793188  
ORIG_HEX_IDH0219  ORIG_HEX_IDH0220  ORIG_HEX_IDH0221  ORIG_HEX_IDH0222  
        2.346889          3.770794          1.392246          2.003505  
ORIG_HEX_IDH0223  ORIG_HEX_IDH0224  ORIG_HEX_IDH0225  ORIG_HEX_IDH0226  
        0.552302         -0.016420          1.983476          2.864900  
ORIG_HEX_IDH0227  ORIG_HEX_IDH0228  ORIG_HEX_IDH0229  ORIG_HEX_IDH0230  
        2.872342          0.062817          3.007025          3.661315  
ORIG_HEX_IDH0231  ORIG_HEX_IDH0232  ORIG_HEX_IDH0233  ORIG_HEX_IDH0234  
        3.424969          3.778784          0.753431          1.758576  
ORIG_HEX_IDH0235  ORIG_HEX_IDH0236  ORIG_HEX_IDH0237  ORIG_HEX_IDH0238  
        2.166931          3.169036          4.244174          0.868940  
ORIG_HEX_IDH0239  ORIG_HEX_IDH0240  ORIG_HEX_IDH0241  ORIG_HEX_IDH0242  
        1.475870          3.231336          0.485898          4.964581  
ORIG_HEX_IDH0243  ORIG_HEX_IDH0244  ORIG_HEX_IDH0245  ORIG_HEX_IDH0246  
       -0.130763          4.838529          0.233512          2.368316  
ORIG_HEX_IDH0247  ORIG_HEX_IDH0248  ORIG_HEX_IDH0249  ORIG_HEX_IDH0250  
        4.281059          4.617274          1.768996          2.583095  
ORIG_HEX_IDH0251  ORIG_HEX_IDH0252  ORIG_HEX_IDH0253  ORIG_HEX_IDH0254  
        1.044509          3.641841          1.412922          3.506304  
ORIG_HEX_IDH0255  ORIG_HEX_IDH0256  ORIG_HEX_IDH0258  ORIG_HEX_IDH0259  
        1.525294          0.481739          2.764330          3.495212  
ORIG_HEX_IDH0260  ORIG_HEX_IDH0262  ORIG_HEX_IDH0263  ORIG_HEX_IDH0264  
        3.210538          2.761411          2.103614          2.146337  
ORIG_HEX_IDH0265  ORIG_HEX_IDH0266  ORIG_HEX_IDH0267  ORIG_HEX_IDH0268  
        3.782063          3.437006          0.599723          5.275784  
ORIG_HEX_IDH0269  ORIG_HEX_IDH0270  ORIG_HEX_IDH0271  ORIG_HEX_IDH0272  
        3.020318          2.995048          2.086848          2.007535  
ORIG_HEX_IDH0273  ORIG_HEX_IDH0274  ORIG_HEX_IDH0275  ORIG_HEX_IDH0276  
        3.661769          2.592732          1.498969          3.998973  
ORIG_HEX_IDH0277  ORIG_HEX_IDH0278  ORIG_HEX_IDH0279  ORIG_HEX_IDH0280  
        3.784538          1.558389          4.018000          3.956535  
ORIG_HEX_IDH0281  ORIG_HEX_IDH0282  ORIG_HEX_IDH0283  ORIG_HEX_IDH0284  
        1.467977          2.451959          2.083361          2.144336  
ORIG_HEX_IDH0285  ORIG_HEX_IDH0286  ORIG_HEX_IDH0287  ORIG_HEX_IDH0288  
        1.406675          3.636067          2.757162          4.485255  
ORIG_HEX_IDH0289  ORIG_HEX_IDH0290  ORIG_HEX_IDH0291  ORIG_HEX_IDH0292  
        2.523607          3.637053          0.685245          2.479740  
ORIG_HEX_IDH0293  ORIG_HEX_IDH0294  ORIG_HEX_IDH0295  ORIG_HEX_IDH0296  
        3.010271          3.132051          3.189656          3.118850  
ORIG_HEX_IDH0297  ORIG_HEX_IDH0298  ORIG_HEX_IDH0299  ORIG_HEX_IDH0300  
        3.014229          3.708347          3.642411          2.944357  
ORIG_HEX_IDH0301  ORIG_HEX_IDH0302  ORIG_HEX_IDH0303  ORIG_HEX_IDH0304  
        2.132738          3.432633          2.574134          1.218035  
ORIG_HEX_IDH0305  ORIG_HEX_IDH0306  ORIG_HEX_IDH0307  ORIG_HEX_IDH0308  
        3.724555          2.918088          2.969882          1.068517  
ORIG_HEX_IDH0309  ORIG_HEX_IDH0310  ORIG_HEX_IDH0311  ORIG_HEX_IDH0312  
        2.375528          2.240530          3.230343         -0.497008  
ORIG_HEX_IDH0313  ORIG_HEX_IDH0314  ORIG_HEX_IDH0315  ORIG_HEX_IDH0316  
        2.778172          1.487185          0.776284          1.310257  
ORIG_HEX_IDH0317  ORIG_HEX_IDH0318  ORIG_HEX_IDH0319  ORIG_HEX_IDH0320  
        1.941370          4.052729          1.602946          3.052087  
ORIG_HEX_IDH0321  ORIG_HEX_IDH0322  ORIG_HEX_IDH0323  ORIG_HEX_IDH0324  
        4.014200         -0.722703          1.448506          5.278435  
ORIG_HEX_IDH0325  ORIG_HEX_IDH0326  ORIG_HEX_IDH0327  ORIG_HEX_IDH0328  
        2.905585          2.099861          1.974490          1.170868  
ORIG_HEX_IDH0329  ORIG_HEX_IDH0330  ORIG_HEX_IDH0331  ORIG_HEX_IDH0332  
        2.679696          2.178265          3.334121          3.419436  
ORIG_HEX_IDH0333  ORIG_HEX_IDH0334  ORIG_HEX_IDH0335  ORIG_HEX_IDH0336  
        3.896829          1.878856          0.978889          3.277048  
ORIG_HEX_IDH0337  ORIG_HEX_IDH0338  ORIG_HEX_IDH0339  ORIG_HEX_IDH0340  
        2.920522          0.918337          2.117724          3.440822  
ORIG_HEX_IDH0341  ORIG_HEX_IDH0343  ORIG_HEX_IDH0344  ORIG_HEX_IDH0345  
        2.869798          1.871015          2.818758          3.759545  
ORIG_HEX_IDH0346  ORIG_HEX_IDH0347  ORIG_HEX_IDH0348  ORIG_HEX_IDH0349  
        4.052685          4.175210          2.391794          0.532921  
ORIG_HEX_IDH0350  ORIG_HEX_IDH0351  ORIG_HEX_IDH0352  ORIG_HEX_IDH0353  
        2.579323          2.992305          3.658392          2.669865  
ORIG_HEX_IDH0354  ORIG_HEX_IDH0355  ORIG_HEX_IDH0356  ORIG_HEX_IDH0357  
        2.206066          0.937414          3.311012          3.272658  
ORIG_HEX_IDH0358  ORIG_HEX_IDH0360  ORIG_HEX_IDH0361  ORIG_HEX_IDH0362  
        2.799732          2.473088          2.947367          3.326684  
ORIG_HEX_IDH0363  ORIG_HEX_IDH0364  ORIG_HEX_IDH0365  ORIG_HEX_IDH0366  
        2.217846          2.704065          3.663692          1.206032  
ORIG_HEX_IDH0367  ORIG_HEX_IDH0368  ORIG_HEX_IDH0369  ORIG_HEX_IDH0370  
        2.006614          3.324459          3.166015          2.791819  
ORIG_HEX_IDH0371  ORIG_HEX_IDH0372  ORIG_HEX_IDH0373  ORIG_HEX_IDH0374  
        2.000495          2.401783          1.085137          2.090437  
ORIG_HEX_IDH0375  ORIG_HEX_IDH0376  ORIG_HEX_IDH0377  ORIG_HEX_IDH0378  
        1.654156          2.837141          2.177100          2.465717  
ORIG_HEX_IDH0379  ORIG_HEX_IDH0380  ORIG_HEX_IDH0381  ORIG_HEX_IDH0382  
        3.231397          2.991653          2.477540          3.696246  
ORIG_HEX_IDH0383  ORIG_HEX_IDH0384  ORIG_HEX_IDH0385  ORIG_HEX_IDH0386  
        2.927368          1.815990          3.407415          2.346461  
ORIG_HEX_IDH0387  ORIG_HEX_IDH0388  ORIG_HEX_IDH0389  ORIG_HEX_IDH0390  
        2.388544          2.759174          2.369265         -0.159933  
ORIG_HEX_IDH0391  ORIG_HEX_IDH0392  ORIG_HEX_IDH0393  ORIG_HEX_IDH0394  
        2.425616          3.880957          2.431760          4.149927  
ORIG_HEX_IDH0395  ORIG_HEX_IDH0396  ORIG_HEX_IDH0397  ORIG_HEX_IDH0398  
        3.206396          3.875024          2.411971          1.837230  
ORIG_HEX_IDH0399  ORIG_HEX_IDH0400  ORIG_HEX_IDH0401  ORIG_HEX_IDH0402  
        0.951472          3.560569          2.291590          2.570672  
ORIG_HEX_IDH0403  ORIG_HEX_IDH0404  ORIG_HEX_IDH0405  ORIG_HEX_IDH0406  
        3.394492          3.441321          3.240335          0.773009  
ORIG_HEX_IDH0407  ORIG_HEX_IDH0408  ORIG_HEX_IDH0409  ORIG_HEX_IDH0410  
        2.952870          0.293998          0.807942          1.638186  
ORIG_HEX_IDH0411  ORIG_HEX_IDH0412  ORIG_HEX_IDH0413  ORIG_HEX_IDH0415  
        0.707653          4.228703          2.913800          1.212260  
ORIG_HEX_IDH0416  ORIG_HEX_IDH0417  ORIG_HEX_IDH0418  ORIG_HEX_IDH0419  
        3.136098          3.088120          2.293185          2.767948  
ORIG_HEX_IDH0420  ORIG_HEX_IDH0421  ORIG_HEX_IDH0422  ORIG_HEX_IDH0423  
        2.393205         -0.226322          2.160078          2.570441  
ORIG_HEX_IDH0424  ORIG_HEX_IDH0425  ORIG_HEX_IDH0426  ORIG_HEX_IDH0427  
        2.686948          0.436572          0.164947         -0.504250  
ORIG_HEX_IDH0428  ORIG_HEX_IDH0429  ORIG_HEX_IDH0430  ORIG_HEX_IDH0431  
        4.513434          3.166284         -2.490676          3.234440  
ORIG_HEX_IDH0432  ORIG_HEX_IDH0433  ORIG_HEX_IDH0434  ORIG_HEX_IDH0435  
        4.146609          2.943458          3.276115          2.085662  
ORIG_HEX_IDH0436  ORIG_HEX_IDH0437  ORIG_HEX_IDH0438  ORIG_HEX_IDH0439  
        3.082036          1.826544          2.833826          1.110171  
ORIG_HEX_IDH0440  ORIG_HEX_IDH0441  ORIG_HEX_IDH0442  ORIG_HEX_IDH0443  
        2.943644          3.027968          2.931319          3.883558  
ORIG_HEX_IDH0444  ORIG_HEX_IDH0445  ORIG_HEX_IDH0446  ORIG_HEX_IDH0447  
        0.660942          2.138755          1.694173          3.740154  
ORIG_HEX_IDH0448  ORIG_HEX_IDH0449  ORIG_HEX_IDH0450  ORIG_HEX_IDH0451  
        2.408003          1.098900          0.679056          1.765683  
ORIG_HEX_IDH0452  ORIG_HEX_IDH0453  ORIG_HEX_IDH0455  ORIG_HEX_IDH0456  
        2.967585          2.229173          0.500690          4.358367  
ORIG_HEX_IDH0457  ORIG_HEX_IDH0458  ORIG_HEX_IDH0459  ORIG_HEX_IDH0460  
        4.182128          3.375581          0.951619          2.546837  
ORIG_HEX_IDH0461  ORIG_HEX_IDH0462  ORIG_HEX_IDH0463  ORIG_HEX_IDH0464  
        2.181764          2.577017          2.405478          2.266057  
ORIG_HEX_IDH0465  ORIG_HEX_IDH0466  ORIG_HEX_IDH0467  ORIG_HEX_IDH0468  
        0.964615          3.433325          2.946383          3.521659  
ORIG_HEX_IDH0469  ORIG_HEX_IDH0470  ORIG_HEX_IDH0471  ORIG_HEX_IDH0472  
        3.237890          2.339727          2.626076          3.574085  
ORIG_HEX_IDH0473  ORIG_HEX_IDH0474  ORIG_HEX_IDH0475  ORIG_HEX_IDH0476  
        3.820817          4.064759          3.104317          2.207228  
ORIG_HEX_IDH0477  ORIG_HEX_IDH0478  ORIG_HEX_IDH0479  ORIG_HEX_IDH0480  
        3.409342          3.254389          2.520394          2.145491  
ORIG_HEX_IDH0481  ORIG_HEX_IDH0482  ORIG_HEX_IDH0483  ORIG_HEX_IDH0484  
        2.231326          2.763062          3.320780          2.794452  
ORIG_HEX_IDH0485  ORIG_HEX_IDH0486  ORIG_HEX_IDH0487  ORIG_HEX_IDH0488  
        3.385322          4.306922          2.995723          4.135410  
ORIG_HEX_IDH0489  ORIG_HEX_IDH0490  ORIG_HEX_IDH0491  ORIG_HEX_IDH0492  
        3.192039          1.591742          3.559070          3.033327  
ORIG_HEX_IDH0493  ORIG_HEX_IDH0494  ORIG_HEX_IDH0495  ORIG_HEX_IDH0496  
        0.901217          3.473912          3.633912          3.819687  
ORIG_HEX_IDH0497  ORIG_HEX_IDH0498  ORIG_HEX_IDH0499  ORIG_HEX_IDH0500  
        1.506224          2.914196          4.185715          3.719850  
ORIG_HEX_IDH0501  ORIG_HEX_IDH0502  ORIG_HEX_IDH0503  ORIG_HEX_IDH0504  
        2.763620          2.687636          2.179882          2.443686  
ORIG_HEX_IDH0505  ORIG_HEX_IDH0506  ORIG_HEX_IDH0507  ORIG_HEX_IDH0508  
        3.249042          3.391389          4.202897          3.062739  
ORIG_HEX_IDH0509  ORIG_HEX_IDH0510  ORIG_HEX_IDH0511  ORIG_HEX_IDH0512  
        2.950698          1.967371          4.265224          3.912279  
ORIG_HEX_IDH0513  ORIG_HEX_IDH0514  ORIG_HEX_IDH0515  ORIG_HEX_IDH0516  
        1.200165          2.072117          3.454222          4.051495  
ORIG_HEX_IDH0517  ORIG_HEX_IDH0518  ORIG_HEX_IDH0519  ORIG_HEX_IDH0520  
        2.801520          4.534765          2.315962          2.543671  
ORIG_HEX_IDH0521  ORIG_HEX_IDH0522  ORIG_HEX_IDH0523  ORIG_HEX_IDH0524  
        4.622083          1.693847          1.891076          3.711916  
ORIG_HEX_IDH0525  ORIG_HEX_IDH0526  ORIG_HEX_IDH0527  ORIG_HEX_IDH0528  
        1.892723          2.567911          3.897472          3.450631  
ORIG_HEX_IDH0529  ORIG_HEX_IDH0530  ORIG_HEX_IDH0531  ORIG_HEX_IDH0532  
        3.366605          3.521339          3.405619          3.736464  
ORIG_HEX_IDH0533  ORIG_HEX_IDH0534  ORIG_HEX_IDH0535  ORIG_HEX_IDH0536  
        3.203878         -0.546279         -2.198169          1.828765  
ORIG_HEX_IDH0537  ORIG_HEX_IDH0538  ORIG_HEX_IDH0539  ORIG_HEX_IDH0540  
        3.380790          2.925422          2.778954          3.378176  
ORIG_HEX_IDH0541  ORIG_HEX_IDH0542  ORIG_HEX_IDH0543  ORIG_HEX_IDH0544  
        2.825271          1.017129          3.816550          2.737878  
ORIG_HEX_IDH0545  ORIG_HEX_IDH0546  ORIG_HEX_IDH0547  ORIG_HEX_IDH0548  
        2.664997          1.834998          3.593893          2.095494  
ORIG_HEX_IDH0549  ORIG_HEX_IDH0550  ORIG_HEX_IDH0551  ORIG_HEX_IDH0552  
        2.188918          3.051063          3.080903          3.111462  
ORIG_HEX_IDH0553  ORIG_HEX_IDH0554  ORIG_HEX_IDH0555  ORIG_HEX_IDH0556  
        4.259490          1.672940          2.085149          3.114811  
ORIG_HEX_IDH0557  ORIG_HEX_IDH0558  ORIG_HEX_IDH0559  ORIG_HEX_IDH0560  
        0.847038          2.046675          2.200647          1.194819  
ORIG_HEX_IDH0561  ORIG_HEX_IDH0562  ORIG_HEX_IDH0563  ORIG_HEX_IDH0564  
        3.383578          3.735897          3.255086          1.055518  
ORIG_HEX_IDH0565  ORIG_HEX_IDH0566  ORIG_HEX_IDH0567  ORIG_HEX_IDH0568  
        2.341633          1.757500          1.684860          1.325378  
ORIG_HEX_IDH0569  ORIG_HEX_IDH0570  ORIG_HEX_IDH0571  ORIG_HEX_IDH0572  
       -0.073446          1.076677         -0.397234          2.171714  
ORIG_HEX_IDH0573  ORIG_HEX_IDH0574  ORIG_HEX_IDH0575  ORIG_HEX_IDH0576  
        0.828686          3.364457          1.616551          1.809610  
ORIG_HEX_IDH0577  ORIG_HEX_IDH0578  ORIG_HEX_IDH0579  ORIG_HEX_IDH0580  
        3.406296          1.720353          1.549368          0.719169  
ORIG_HEX_IDH0581  ORIG_HEX_IDH0582  ORIG_HEX_IDH0583  ORIG_HEX_IDH0584  
        3.610262          2.601672          3.050616          3.556780  
ORIG_HEX_IDH0585  ORIG_HEX_IDH0586  ORIG_HEX_IDH0587  ORIG_HEX_IDH0588  
        2.223446          3.354565          3.193509          1.940310  
ORIG_HEX_IDH0589  ORIG_HEX_IDH0590  ORIG_HEX_IDH0591  ORIG_HEX_IDH0592  
        3.835715          3.511511          0.797584          2.775003  
ORIG_HEX_IDH0593  ORIG_HEX_IDH0594  ORIG_HEX_IDH0595  ORIG_HEX_IDH0596  
        3.382629          2.580410          3.319634          4.579056  
ORIG_HEX_IDH0597  ORIG_HEX_IDH0598  ORIG_HEX_IDH0599  ORIG_HEX_IDH0600  
        2.391580          3.964701          2.612681          2.773851  
ORIG_HEX_IDH0601  ORIG_HEX_IDH0602  ORIG_HEX_IDH0603  ORIG_HEX_IDH0604  
       -0.045257          1.198169          3.215265          1.582822  
ORIG_HEX_IDH0605  ORIG_HEX_IDH0606  ORIG_HEX_IDH0607  ORIG_HEX_IDH0608  
        2.829336          2.170335          3.114874          3.170954  
ORIG_HEX_IDH0609  ORIG_HEX_IDH0610  ORIG_HEX_IDH0611  ORIG_HEX_IDH0612  
        3.733249          3.716853         -0.499006          3.616651  
ORIG_HEX_IDH0613  ORIG_HEX_IDH0614  ORIG_HEX_IDH0615  ORIG_HEX_IDH0616  
        2.617435          3.062053          3.159837          3.850517  
ORIG_HEX_IDH0617  ORIG_HEX_IDH0618  ORIG_HEX_IDH0619  ORIG_HEX_IDH0620  
        4.130962          3.372081          2.450467          3.092811  
ORIG_HEX_IDH0621  ORIG_HEX_IDH0622  ORIG_HEX_IDH0623  ORIG_HEX_IDH0624  
        3.143901          2.823300          2.564931          1.935201  
ORIG_HEX_IDH0625  ORIG_HEX_IDH0626  ORIG_HEX_IDH0627  ORIG_HEX_IDH0628  
        2.302780          3.328213          2.682738          3.051169  
ORIG_HEX_IDH0629  ORIG_HEX_IDH0630  ORIG_HEX_IDH0631  ORIG_HEX_IDH0632  
        2.883110          3.372021          2.678636          3.491763  
ORIG_HEX_IDH0633  ORIG_HEX_IDH0634  ORIG_HEX_IDH0635  ORIG_HEX_IDH0636  
        4.192254          4.028276          1.140030          3.942636  
ORIG_HEX_IDH0637  ORIG_HEX_IDH0638  ORIG_HEX_IDH0639  ORIG_HEX_IDH0640  
       -0.769773          2.955869          3.626040          2.741384  
ORIG_HEX_IDH0641  ORIG_HEX_IDH0642  ORIG_HEX_IDH0643  ORIG_HEX_IDH0644  
        1.258474          3.271286          3.506171          3.021930  
ORIG_HEX_IDH0645  ORIG_HEX_IDH0646  ORIG_HEX_IDH0647  ORIG_HEX_IDH0648  
        3.333029          4.338680          2.343457          3.827282  
ORIG_HEX_IDH0649  ORIG_HEX_IDH0650  ORIG_HEX_IDH0651  ORIG_HEX_IDH0652  
        2.551075          1.779647          3.522818          4.308925  
ORIG_HEX_IDH0653  ORIG_HEX_IDH0654  ORIG_HEX_IDH0655  ORIG_HEX_IDH0656  
        3.388617          3.074570          0.587079          0.957122  
ORIG_HEX_IDH0657  ORIG_HEX_IDH0658  ORIG_HEX_IDH0659  ORIG_HEX_IDH0660  
        2.701257          3.693657          2.089588          2.522682  
ORIG_HEX_IDH0661  ORIG_HEX_IDH0662  ORIG_HEX_IDH0663  ORIG_HEX_IDH0664  
        3.346845          2.857516          4.453842          3.456037  
ORIG_HEX_IDH0665  ORIG_HEX_IDH0666  ORIG_HEX_IDH0667  ORIG_HEX_IDH0668  
        3.354405          3.836424          3.557627          2.909063  
ORIG_HEX_IDH0669  ORIG_HEX_IDH0670  ORIG_HEX_IDH0671  ORIG_HEX_IDH0672  
        2.392575          1.932752          0.144559          3.554739  
ORIG_HEX_IDH0673  ORIG_HEX_IDH0674  ORIG_HEX_IDH0675  ORIG_HEX_IDH0676  
        3.525883          3.342151          2.477390          1.789721  
ORIG_HEX_IDH0677  ORIG_HEX_IDH0678  ORIG_HEX_IDH0679  ORIG_HEX_IDH0680  
        2.986212          3.957875          3.403929          3.326510  
ORIG_HEX_IDH0681  ORIG_HEX_IDH0682  ORIG_HEX_IDH0683  ORIG_HEX_IDH0684  
        3.313770          4.378046          1.197293          4.252164  
ORIG_HEX_IDH0685  ORIG_HEX_IDH0686  ORIG_HEX_IDH0687  ORIG_HEX_IDH0688  
        2.830564          2.844442          2.190288          0.710069  
ORIG_HEX_IDH0689  ORIG_HEX_IDH0690  ORIG_HEX_IDH0691  ORIG_HEX_IDH0692  
        2.970971          4.380072          2.012884          4.680152  
ORIG_HEX_IDH0693  ORIG_HEX_IDH0694  ORIG_HEX_IDH0695  ORIG_HEX_IDH0696  
        2.958134          3.300697          3.482853          2.025588  
ORIG_HEX_IDH0697  ORIG_HEX_IDH0698  ORIG_HEX_IDH0700  ORIG_HEX_IDH0701  
        3.861899          3.383278          3.172402          1.466081  
ORIG_HEX_IDH0702  ORIG_HEX_IDH0703  ORIG_HEX_IDH0704  ORIG_HEX_IDH0705  
        3.548939          3.144742          1.041838          3.507249  
ORIG_HEX_IDH0706  ORIG_HEX_IDH0707  ORIG_HEX_IDH0708  ORIG_HEX_IDH0709  
        3.277260          3.287225          2.740845          2.600297  
ORIG_HEX_IDH0710  ORIG_HEX_IDH0711  ORIG_HEX_IDH0712  ORIG_HEX_IDH0713  
       -0.203167          0.668681          2.787136          0.061480  
ORIG_HEX_IDH0714  ORIG_HEX_IDH0715  ORIG_HEX_IDH0716  ORIG_HEX_IDH0717  
        2.458591          3.275800          3.222064          1.509342  
ORIG_HEX_IDH0718  ORIG_HEX_IDH0719  ORIG_HEX_IDH0720  ORIG_HEX_IDH0721  
        3.025844          2.890160          3.329140          3.505672  
ORIG_HEX_IDH0722  ORIG_HEX_IDH0723  ORIG_HEX_IDH0724  ORIG_HEX_IDH0725  
        0.954811         -0.508599          2.539719          4.936959  
ORIG_HEX_IDH0726  ORIG_HEX_IDH0727  ORIG_HEX_IDH0728  ORIG_HEX_IDH0729  
        2.578094          3.377588          1.363042          2.678563  
ORIG_HEX_IDH0730  ORIG_HEX_IDH0731  ORIG_HEX_IDH0732  ORIG_HEX_IDH0733  
        0.694762          2.979350          2.567203          3.416373  
ORIG_HEX_IDH0734  ORIG_HEX_IDH0735  ORIG_HEX_IDH0736  ORIG_HEX_IDH0737  
        2.306269          2.602497          3.040865          3.381809  
ORIG_HEX_IDH0738  ORIG_HEX_IDH0739  ORIG_HEX_IDH0740  ORIG_HEX_IDH0741  
        3.284204          4.020190          3.337316          2.659794  
ORIG_HEX_IDH0742  ORIG_HEX_IDH0743  ORIG_HEX_IDH0744  ORIG_HEX_IDH0745  
        1.317809          3.498836          3.690297          3.230653  
ORIG_HEX_IDH0746  ORIG_HEX_IDH0747  ORIG_HEX_IDH0748  ORIG_HEX_IDH0749  
        2.836028          1.559118          3.809219          2.729669  
ORIG_HEX_IDH0750  ORIG_HEX_IDH0751  ORIG_HEX_IDH0752  ORIG_HEX_IDH0753  
        3.176379          0.767644          3.659698          2.786818  
ORIG_HEX_IDH0754  ORIG_HEX_IDH0755  ORIG_HEX_IDH0756  ORIG_HEX_IDH0757  
        3.110552          2.178651          3.197665          2.274024  
ORIG_HEX_IDH0758  ORIG_HEX_IDH0759  ORIG_HEX_IDH0760  ORIG_HEX_IDH0761  
        1.637303          4.857160          2.635040          3.226562  
ORIG_HEX_IDH0762  ORIG_HEX_IDH0763  ORIG_HEX_IDH0764  ORIG_HEX_IDH0765  
        2.291612          3.489850          2.623888          3.174927  
ORIG_HEX_IDH0766  ORIG_HEX_IDH0767  ORIG_HEX_IDH0768  ORIG_HEX_IDH0769  
        2.528527          4.382619          0.819814          1.649577  
ORIG_HEX_IDH0770  ORIG_HEX_IDH0771  ORIG_HEX_IDH0772  ORIG_HEX_IDH0773  
        1.044059          2.222342          3.338427          2.861244  
ORIG_HEX_IDH0774  ORIG_HEX_IDH0775  ORIG_HEX_IDH0776  ORIG_HEX_IDH0777  
        2.168360         -0.747890          2.246441          1.792258  
ORIG_HEX_IDH0778  ORIG_HEX_IDH0779  ORIG_HEX_IDH0780  ORIG_HEX_IDH0781  
        3.602573          3.710992          3.044040          3.103867  
ORIG_HEX_IDH0782  ORIG_HEX_IDH0783  ORIG_HEX_IDH0784  ORIG_HEX_IDH0785  
        0.991255          3.379132          3.743023          3.942690  
ORIG_HEX_IDH0786  ORIG_HEX_IDH0787  ORIG_HEX_IDH0788  ORIG_HEX_IDH0789  
        3.298332          2.631380          2.391990          2.719142  
ORIG_HEX_IDH0790  ORIG_HEX_IDH0791  ORIG_HEX_IDH0792  ORIG_HEX_IDH0793  
        3.166969          2.175756          1.997595          2.734604  
ORIG_HEX_IDH0794  ORIG_HEX_IDH0795  ORIG_HEX_IDH0796  ORIG_HEX_IDH0797  
        3.286203          2.069741          0.894726          0.574993  
ORIG_HEX_IDH0798  ORIG_HEX_IDH0799  ORIG_HEX_IDH0800  ORIG_HEX_IDH0801  
        2.022088          3.039045          1.951119          1.710433  
ORIG_HEX_IDH0802  ORIG_HEX_IDH0803  ORIG_HEX_IDH0804  ORIG_HEX_IDH0805  
        2.106965          2.289258          1.132719          1.248630  
ORIG_HEX_IDH0806  ORIG_HEX_IDH0807  ORIG_HEX_IDH0808  ORIG_HEX_IDH0809  
        1.301410          1.730728          1.765335          1.832322  
ORIG_HEX_IDH0810  ORIG_HEX_IDH0811  ORIG_HEX_IDH0812  ORIG_HEX_IDH0813  
        1.436352          2.156050          1.583034          0.301508  
ORIG_HEX_IDH0814  ORIG_HEX_IDH0815  ORIG_HEX_IDH0816  ORIG_HEX_IDH0817  
        3.198984         -0.449781          1.158446          0.363168  
ORIG_HEX_IDH0818  ORIG_HEX_IDH0819  ORIG_HEX_IDH0820  ORIG_HEX_IDH0821  
        2.393960          4.159775          5.162756          3.234786  
ORIG_HEX_IDH0822  ORIG_HEX_IDH0823  ORIG_HEX_IDH0824  ORIG_HEX_IDH0825  
        2.634008          2.394387          1.556331         -0.104736  
ORIG_HEX_IDH0826  ORIG_HEX_IDH0827  ORIG_HEX_IDH0828  ORIG_HEX_IDH0829  
        3.180053          2.780734          1.896180          2.916641  
ORIG_HEX_IDH0830  ORIG_HEX_IDH0831  DEST_HEX_IDH0003  DEST_HEX_IDH0004  
        2.814602          2.044869          0.183250          1.267637  
DEST_HEX_IDH0005  DEST_HEX_IDH0006  DEST_HEX_IDH0007  DEST_HEX_IDH0009  
       -0.624764          0.071913          1.602443          0.988491  
DEST_HEX_IDH0010  DEST_HEX_IDH0011  DEST_HEX_IDH0012  DEST_HEX_IDH0013  
        2.715120         -1.239876          0.770263         -4.356602  
DEST_HEX_IDH0014  DEST_HEX_IDH0015  DEST_HEX_IDH0016  DEST_HEX_IDH0017  
        4.306065         -3.080116          3.969004          1.271898  
DEST_HEX_IDH0018  DEST_HEX_IDH0019  DEST_HEX_IDH0020  DEST_HEX_IDH0021  
        2.699912         -1.995816          0.493579         -0.825692  
DEST_HEX_IDH0022  DEST_HEX_IDH0023  DEST_HEX_IDH0024  DEST_HEX_IDH0025  
        3.450524         -0.707177         -0.868829          1.627068  
DEST_HEX_IDH0026  DEST_HEX_IDH0027  DEST_HEX_IDH0028  DEST_HEX_IDH0029  
        1.447632          0.736001          1.708024         -0.206263  
DEST_HEX_IDH0030  DEST_HEX_IDH0031  DEST_HEX_IDH0032  DEST_HEX_IDH0033  
        1.404584          0.108203          3.349168          0.134271  
DEST_HEX_IDH0034  DEST_HEX_IDH0035  DEST_HEX_IDH0036  DEST_HEX_IDH0037  
       -0.377305          0.219759         -0.899342          0.714599  
DEST_HEX_IDH0038  DEST_HEX_IDH0039  DEST_HEX_IDH0040  DEST_HEX_IDH0041  
        3.246656          1.901170         -1.024107          0.716987  
DEST_HEX_IDH0042  DEST_HEX_IDH0043  DEST_HEX_IDH0044  DEST_HEX_IDH0045  
        2.047533         -0.347944         -0.246446          0.312591  
DEST_HEX_IDH0046  DEST_HEX_IDH0047  DEST_HEX_IDH0048  DEST_HEX_IDH0050  
        0.444912          0.963942          1.497019          0.043356  
DEST_HEX_IDH0051  DEST_HEX_IDH0052  DEST_HEX_IDH0053  DEST_HEX_IDH0054  
        2.437026          0.418368          0.151666          1.457781  
DEST_HEX_IDH0055  DEST_HEX_IDH0056  DEST_HEX_IDH0057  DEST_HEX_IDH0058  
        1.572537         -0.627599          1.170023          0.955846  
DEST_HEX_IDH0059  DEST_HEX_IDH0060  DEST_HEX_IDH0061  DEST_HEX_IDH0062  
        0.558614          0.521948          0.902017         -1.600742  
DEST_HEX_IDH0063  DEST_HEX_IDH0064  DEST_HEX_IDH0065  DEST_HEX_IDH0066  
        1.998372         -0.369862          3.900358          2.382201  
DEST_HEX_IDH0067  DEST_HEX_IDH0068  DEST_HEX_IDH0069  DEST_HEX_IDH0070  
        3.541478         -0.624071         -0.184291          1.001394  
DEST_HEX_IDH0071  DEST_HEX_IDH0072  DEST_HEX_IDH0073  DEST_HEX_IDH0074  
        1.543991          2.074396          1.127767         -0.892215  
DEST_HEX_IDH0075  DEST_HEX_IDH0076  DEST_HEX_IDH0077  DEST_HEX_IDH0079  
       -0.819144          2.602139          1.926648          1.265504  
DEST_HEX_IDH0080  DEST_HEX_IDH0081  DEST_HEX_IDH0082  DEST_HEX_IDH0084  
        0.531891          3.470224          2.543647          0.835987  
DEST_HEX_IDH0085  DEST_HEX_IDH0086  DEST_HEX_IDH0087  DEST_HEX_IDH0088  
       -0.890106          1.704596          1.870178         -2.003547  
DEST_HEX_IDH0089  DEST_HEX_IDH0090  DEST_HEX_IDH0091  DEST_HEX_IDH0092  
        1.908969          0.811019          0.803451          1.516722  
DEST_HEX_IDH0093  DEST_HEX_IDH0094  DEST_HEX_IDH0095  DEST_HEX_IDH0096  
        3.512887          0.277670          0.468124         -0.030936  
DEST_HEX_IDH0097  DEST_HEX_IDH0098  DEST_HEX_IDH0099  DEST_HEX_IDH0100  
        0.488967          1.498643          0.501430          3.948098  
DEST_HEX_IDH0101  DEST_HEX_IDH0102  DEST_HEX_IDH0103  DEST_HEX_IDH0104  
        3.651856          1.368314         -0.555314         -0.421192  
DEST_HEX_IDH0105  DEST_HEX_IDH0106  DEST_HEX_IDH0107  DEST_HEX_IDH0108  
        0.849110         -0.243870         -0.138511          0.303577  
DEST_HEX_IDH0109  DEST_HEX_IDH0110  DEST_HEX_IDH0111  DEST_HEX_IDH0112  
        2.943792          2.333509          1.264575         -0.850332  
DEST_HEX_IDH0113  DEST_HEX_IDH0114  DEST_HEX_IDH0115  DEST_HEX_IDH0116  
        0.015091         -2.396014          1.522697          0.847479  
DEST_HEX_IDH0117  DEST_HEX_IDH0118  DEST_HEX_IDH0119  DEST_HEX_IDH0120  
        5.425469          2.753054         -0.854400         -0.005178  
DEST_HEX_IDH0121  DEST_HEX_IDH0122  DEST_HEX_IDH0123  DEST_HEX_IDH0124  
        0.940500          1.498302         -0.296498          0.844411  
DEST_HEX_IDH0125  DEST_HEX_IDH0126  DEST_HEX_IDH0127  DEST_HEX_IDH0128  
       -0.006439          2.688837         -0.782548         -0.386844  
DEST_HEX_IDH0129  DEST_HEX_IDH0130  DEST_HEX_IDH0131  DEST_HEX_IDH0132  
        0.330729         -0.464470          0.556058          0.413961  
DEST_HEX_IDH0133  DEST_HEX_IDH0134  DEST_HEX_IDH0135  DEST_HEX_IDH0136  
        3.367196         -0.126773         -0.223747          3.220549  
DEST_HEX_IDH0137  DEST_HEX_IDH0138  DEST_HEX_IDH0139  DEST_HEX_IDH0140  
        0.388966          2.019797          2.624035          3.974572  
DEST_HEX_IDH0141  DEST_HEX_IDH0142  DEST_HEX_IDH0143  DEST_HEX_IDH0144  
        3.800321          0.881705         -0.495369          3.552317  
DEST_HEX_IDH0145  DEST_HEX_IDH0146  DEST_HEX_IDH0147  DEST_HEX_IDH0148  
        4.286225          2.046438          0.966776          3.122275  
DEST_HEX_IDH0149  DEST_HEX_IDH0150  DEST_HEX_IDH0151  DEST_HEX_IDH0152  
        1.933369          3.662826         -0.359754          1.417993  
DEST_HEX_IDH0154  DEST_HEX_IDH0155  DEST_HEX_IDH0156  DEST_HEX_IDH0157  
        0.101012          1.549520          2.216867          1.234289  
DEST_HEX_IDH0158  DEST_HEX_IDH0159  DEST_HEX_IDH0160  DEST_HEX_IDH0161  
        3.196407          2.034148          1.191732          2.453048  
DEST_HEX_IDH0162  DEST_HEX_IDH0163  DEST_HEX_IDH0164  DEST_HEX_IDH0165  
        0.985640          3.934559          1.497578          3.468720  
DEST_HEX_IDH0166  DEST_HEX_IDH0167  DEST_HEX_IDH0168  DEST_HEX_IDH0169  
        2.355277          0.513632          2.858918          2.115909  
DEST_HEX_IDH0170  DEST_HEX_IDH0171  DEST_HEX_IDH0172  DEST_HEX_IDH0173  
        2.073229          2.676354          1.387059         -0.454641  
DEST_HEX_IDH0174  DEST_HEX_IDH0175  DEST_HEX_IDH0176  DEST_HEX_IDH0177  
        3.586394          4.579994          2.810850          3.527918  
DEST_HEX_IDH0178  DEST_HEX_IDH0179  DEST_HEX_IDH0180  DEST_HEX_IDH0181  
        1.086988          3.339267          2.644262          2.334039  
DEST_HEX_IDH0182  DEST_HEX_IDH0183  DEST_HEX_IDH0184  DEST_HEX_IDH0185  
        0.513002          1.179876          3.184423          3.176619  
DEST_HEX_IDH0186  DEST_HEX_IDH0187  DEST_HEX_IDH0188  DEST_HEX_IDH0189  
        2.922011          2.418567          4.794231          4.105391  
DEST_HEX_IDH0190  DEST_HEX_IDH0191  DEST_HEX_IDH0192  DEST_HEX_IDH0193  
       -0.282622         -0.333525          2.956315          3.745205  
DEST_HEX_IDH0194  DEST_HEX_IDH0195  DEST_HEX_IDH0196  DEST_HEX_IDH0197  
        2.725381          1.863737          2.990297          2.947737  
DEST_HEX_IDH0198  DEST_HEX_IDH0199  DEST_HEX_IDH0200  DEST_HEX_IDH0201  
        2.410262          4.419288          0.274000         -0.366589  
DEST_HEX_IDH0202  DEST_HEX_IDH0203  DEST_HEX_IDH0204  DEST_HEX_IDH0205  
        1.345980          1.462067          1.729338          2.289126  
DEST_HEX_IDH0206  DEST_HEX_IDH0207  DEST_HEX_IDH0208  DEST_HEX_IDH0209  
        2.969510          4.395477          4.110287          1.024613  
DEST_HEX_IDH0210  DEST_HEX_IDH0211  DEST_HEX_IDH0212  DEST_HEX_IDH0213  
        2.401761          1.320175         -0.531893         -0.386527  
DEST_HEX_IDH0214  DEST_HEX_IDH0215  DEST_HEX_IDH0216  DEST_HEX_IDH0217  
        1.624573          1.869707          2.179347          0.066580  
DEST_HEX_IDH0218  DEST_HEX_IDH0219  DEST_HEX_IDH0220  DEST_HEX_IDH0221  
        3.391551          2.126772          3.293913          0.960592  
DEST_HEX_IDH0222  DEST_HEX_IDH0223  DEST_HEX_IDH0224  DEST_HEX_IDH0225  
        1.232918         -0.050680          0.940051          0.810605  
DEST_HEX_IDH0226  DEST_HEX_IDH0227  DEST_HEX_IDH0228  DEST_HEX_IDH0229  
        2.344578          2.478423         -0.286053          2.393194  
DEST_HEX_IDH0230  DEST_HEX_IDH0231  DEST_HEX_IDH0232  DEST_HEX_IDH0233  
        3.145614          2.892147          2.956661         -1.144967  
DEST_HEX_IDH0234  DEST_HEX_IDH0235  DEST_HEX_IDH0236  DEST_HEX_IDH0237  
        1.059981          2.309923          2.945771          3.941147  
DEST_HEX_IDH0238  DEST_HEX_IDH0239  DEST_HEX_IDH0240  DEST_HEX_IDH0241  
        0.323447          0.899805          2.705991          0.056929  
DEST_HEX_IDH0242  DEST_HEX_IDH0243  DEST_HEX_IDH0244  DEST_HEX_IDH0245  
        4.836990         -1.002388          4.605931         -1.604263  
DEST_HEX_IDH0246  DEST_HEX_IDH0247  DEST_HEX_IDH0248  DEST_HEX_IDH0249  
        2.344030          4.062770          4.851738          0.678617  
DEST_HEX_IDH0250  DEST_HEX_IDH0251  DEST_HEX_IDH0252  DEST_HEX_IDH0253  
        2.127236          0.843553          3.698001          1.375858  
DEST_HEX_IDH0254  DEST_HEX_IDH0255  DEST_HEX_IDH0256  DEST_HEX_IDH0257  
        3.104150          0.179720          0.212158          4.880704  
DEST_HEX_IDH0258  DEST_HEX_IDH0259  DEST_HEX_IDH0260  DEST_HEX_IDH0262  
        2.571112          3.346284          3.133476          2.488766  
DEST_HEX_IDH0263  DEST_HEX_IDH0264  DEST_HEX_IDH0265  DEST_HEX_IDH0266  
        1.784681          1.576664          3.065149          2.896031  
DEST_HEX_IDH0267  DEST_HEX_IDH0269  DEST_HEX_IDH0270  DEST_HEX_IDH0271  
        0.589145          2.819768          2.951055          1.966702  
DEST_HEX_IDH0272  DEST_HEX_IDH0273  DEST_HEX_IDH0274  DEST_HEX_IDH0275  
        2.222029          2.942244          2.167842          1.203962  
DEST_HEX_IDH0276  DEST_HEX_IDH0277  DEST_HEX_IDH0278  DEST_HEX_IDH0279  
        3.559157          2.885708          1.069583          3.855028  
DEST_HEX_IDH0280  DEST_HEX_IDH0281  DEST_HEX_IDH0282  DEST_HEX_IDH0283  
        3.789317          1.078231          2.816604          1.800001  
DEST_HEX_IDH0284  DEST_HEX_IDH0285  DEST_HEX_IDH0286  DEST_HEX_IDH0287  
        1.780910          0.977646          4.061641          1.939571  
DEST_HEX_IDH0288  DEST_HEX_IDH0289  DEST_HEX_IDH0290  DEST_HEX_IDH0291  
        3.477877          2.289732          3.050216          0.860934  
DEST_HEX_IDH0292  DEST_HEX_IDH0293  DEST_HEX_IDH0294  DEST_HEX_IDH0295  
        1.969383          2.798230          3.258819          3.092581  
DEST_HEX_IDH0296  DEST_HEX_IDH0297  DEST_HEX_IDH0298  DEST_HEX_IDH0299  
        3.081448          2.826330          3.276986          3.260557  
DEST_HEX_IDH0300  DEST_HEX_IDH0301  DEST_HEX_IDH0302  DEST_HEX_IDH0303  
        3.586009          2.417618          3.223457          2.310931  
DEST_HEX_IDH0304  DEST_HEX_IDH0305  DEST_HEX_IDH0306  DEST_HEX_IDH0307  
       -0.885779          3.771661          3.681922          2.763271  
DEST_HEX_IDH0308  DEST_HEX_IDH0309  DEST_HEX_IDH0310  DEST_HEX_IDH0311  
        1.450853          1.633703          2.082024          3.402805  
DEST_HEX_IDH0312  DEST_HEX_IDH0313  DEST_HEX_IDH0314  DEST_HEX_IDH0315  
       -0.003841          2.703584          1.005761          0.862257  
DEST_HEX_IDH0316  DEST_HEX_IDH0317  DEST_HEX_IDH0318  DEST_HEX_IDH0319  
        1.182176          1.094275          3.935860          1.287776  
DEST_HEX_IDH0320  DEST_HEX_IDH0321  DEST_HEX_IDH0322  DEST_HEX_IDH0323  
        2.709417          4.435332         -0.748167          2.544080  
DEST_HEX_IDH0324  DEST_HEX_IDH0325  DEST_HEX_IDH0326  DEST_HEX_IDH0327  
        5.346679          1.990896          2.086165          1.931681  
DEST_HEX_IDH0328  DEST_HEX_IDH0329  DEST_HEX_IDH0330  DEST_HEX_IDH0331  
        2.322480          2.491817          2.025895          3.107190  
DEST_HEX_IDH0332  DEST_HEX_IDH0333  DEST_HEX_IDH0334  DEST_HEX_IDH0335  
        3.036289          3.219209          1.905494          1.262870  
DEST_HEX_IDH0336  DEST_HEX_IDH0337  DEST_HEX_IDH0338  DEST_HEX_IDH0339  
        3.295169          2.824422         -0.140386          1.681497  
DEST_HEX_IDH0340  DEST_HEX_IDH0341  DEST_HEX_IDH0343  DEST_HEX_IDH0344  
        3.190160          2.268569          1.797536          2.938749  
DEST_HEX_IDH0345  DEST_HEX_IDH0346  DEST_HEX_IDH0347  DEST_HEX_IDH0348  
        3.906581          3.677998          4.332987          1.351320  
DEST_HEX_IDH0350  DEST_HEX_IDH0351  DEST_HEX_IDH0352  DEST_HEX_IDH0353  
        2.853829          3.547084          3.702719          2.687366  
DEST_HEX_IDH0354  DEST_HEX_IDH0355  DEST_HEX_IDH0356  DEST_HEX_IDH0357  
        1.794872          1.971595          2.988406          2.573022  
DEST_HEX_IDH0358  DEST_HEX_IDH0360  DEST_HEX_IDH0361  DEST_HEX_IDH0362  
        1.005433          2.722279          3.382457          2.977146  
DEST_HEX_IDH0363  DEST_HEX_IDH0364  DEST_HEX_IDH0365  DEST_HEX_IDH0366  
        2.239366         -0.162770          3.125654         -0.529941  
DEST_HEX_IDH0367  DEST_HEX_IDH0368  DEST_HEX_IDH0369  DEST_HEX_IDH0370  
        1.069070          3.439712          3.397172          2.863905  
DEST_HEX_IDH0371  DEST_HEX_IDH0372  DEST_HEX_IDH0373  DEST_HEX_IDH0374  
        2.413811          2.594275          1.154426          1.451120  
DEST_HEX_IDH0375  DEST_HEX_IDH0376  DEST_HEX_IDH0377  DEST_HEX_IDH0378  
        0.744983          2.020402          2.191566          2.731020  
DEST_HEX_IDH0379  DEST_HEX_IDH0380  DEST_HEX_IDH0381  DEST_HEX_IDH0382  
        3.372331          3.004485          1.971582          2.692676  
DEST_HEX_IDH0383  DEST_HEX_IDH0384  DEST_HEX_IDH0385  DEST_HEX_IDH0386  
        1.748755          1.803019          3.697530          2.304624  
DEST_HEX_IDH0387  DEST_HEX_IDH0388  DEST_HEX_IDH0389  DEST_HEX_IDH0390  
        2.466567          2.686952          2.242985         -0.797973  
DEST_HEX_IDH0391  DEST_HEX_IDH0392  DEST_HEX_IDH0393  DEST_HEX_IDH0394  
        2.328992          3.689019          1.366299          4.996541  
DEST_HEX_IDH0395  DEST_HEX_IDH0396  DEST_HEX_IDH0397  DEST_HEX_IDH0398  
        3.391627          3.948079          2.142617          0.485669  
DEST_HEX_IDH0399  DEST_HEX_IDH0400  DEST_HEX_IDH0401  DEST_HEX_IDH0402  
       -0.477293          3.496707          1.268366          2.417507  
DEST_HEX_IDH0403  DEST_HEX_IDH0404  DEST_HEX_IDH0405  DEST_HEX_IDH0406  
        3.027973          3.672239          3.394186          1.961095  
DEST_HEX_IDH0407  DEST_HEX_IDH0408  DEST_HEX_IDH0409  DEST_HEX_IDH0410  
        3.208688         -0.768382          0.616544          1.275216  
DEST_HEX_IDH0411  DEST_HEX_IDH0412  DEST_HEX_IDH0413  DEST_HEX_IDH0414  
        0.735737          4.240812          1.832173          3.936151  
DEST_HEX_IDH0415  DEST_HEX_IDH0416  DEST_HEX_IDH0417  DEST_HEX_IDH0418  
        1.660146          3.351324          3.199394          2.660931  
DEST_HEX_IDH0419  DEST_HEX_IDH0420  DEST_HEX_IDH0421  DEST_HEX_IDH0422  
        2.860160          3.590609         -0.422698          1.940814  
DEST_HEX_IDH0423  DEST_HEX_IDH0424  DEST_HEX_IDH0425  DEST_HEX_IDH0426  
        2.368022          1.921513          0.157423          1.107129  
DEST_HEX_IDH0427  DEST_HEX_IDH0428  DEST_HEX_IDH0429  DEST_HEX_IDH0430  
       -1.392985          4.063590          3.329875         -1.526234  
DEST_HEX_IDH0431  DEST_HEX_IDH0432  DEST_HEX_IDH0433  DEST_HEX_IDH0434  
        2.929118          4.564816          3.328197          3.992761  
DEST_HEX_IDH0435  DEST_HEX_IDH0436  DEST_HEX_IDH0437  DEST_HEX_IDH0438  
        1.833718          3.562382          1.373993          2.392601  
DEST_HEX_IDH0439  DEST_HEX_IDH0440  DEST_HEX_IDH0441  DEST_HEX_IDH0442  
        1.074975          3.974422          2.682150          2.202362  
DEST_HEX_IDH0443  DEST_HEX_IDH0444  DEST_HEX_IDH0445  DEST_HEX_IDH0446  
        3.420539         -0.367994          2.509520          2.311254  
DEST_HEX_IDH0447  DEST_HEX_IDH0448  DEST_HEX_IDH0449  DEST_HEX_IDH0450  
        4.671834          2.493709          1.355519          0.712364  
DEST_HEX_IDH0451  DEST_HEX_IDH0452  DEST_HEX_IDH0453  DEST_HEX_IDH0455  
        2.000973          3.319337          1.738318          0.997839  
DEST_HEX_IDH0456  DEST_HEX_IDH0457  DEST_HEX_IDH0458  DEST_HEX_IDH0459  
        4.164103          4.522523          3.533734          1.241112  
DEST_HEX_IDH0460  DEST_HEX_IDH0461  DEST_HEX_IDH0462  DEST_HEX_IDH0463  
        2.917438          2.613080          2.978905          3.545129  
DEST_HEX_IDH0464  DEST_HEX_IDH0465  DEST_HEX_IDH0466  DEST_HEX_IDH0467  
        2.180336          0.980533          3.263621          3.126069  
DEST_HEX_IDH0468  DEST_HEX_IDH0469  DEST_HEX_IDH0470  DEST_HEX_IDH0471  
        3.474220          3.184042          2.090440          2.500310  
DEST_HEX_IDH0472  DEST_HEX_IDH0473  DEST_HEX_IDH0474  DEST_HEX_IDH0475  
        3.761860          2.915269          3.862789          3.816682  
DEST_HEX_IDH0476  DEST_HEX_IDH0477  DEST_HEX_IDH0478  DEST_HEX_IDH0479  
        2.715357          4.343211          3.284310          2.536403  
DEST_HEX_IDH0480  DEST_HEX_IDH0481  DEST_HEX_IDH0482  DEST_HEX_IDH0483  
        2.433342          2.571943          2.433651          3.125202  
DEST_HEX_IDH0484  DEST_HEX_IDH0485  DEST_HEX_IDH0486  DEST_HEX_IDH0487  
        2.544151          2.774886          3.182024          3.281648  
DEST_HEX_IDH0488  DEST_HEX_IDH0489  DEST_HEX_IDH0490  DEST_HEX_IDH0491  
        4.867252          3.950454          1.591628          3.808561  
DEST_HEX_IDH0492  DEST_HEX_IDH0493  DEST_HEX_IDH0494  DEST_HEX_IDH0495  
        3.204731          0.832985          3.356151          3.795090  
DEST_HEX_IDH0496  DEST_HEX_IDH0497  DEST_HEX_IDH0498  DEST_HEX_IDH0499  
        3.897841          1.104229          2.087803          3.004934  
DEST_HEX_IDH0500  DEST_HEX_IDH0501  DEST_HEX_IDH0502  DEST_HEX_IDH0503  
        2.232603          3.359591          3.554157          2.820931  
DEST_HEX_IDH0504  DEST_HEX_IDH0505  DEST_HEX_IDH0506  DEST_HEX_IDH0507  
        2.441593          3.279670          3.835488          4.686846  
DEST_HEX_IDH0508  DEST_HEX_IDH0509  DEST_HEX_IDH0510  DEST_HEX_IDH0511  
        2.700452          3.487657          1.918669          3.163868  
DEST_HEX_IDH0512  DEST_HEX_IDH0513  DEST_HEX_IDH0514  DEST_HEX_IDH0515  
        2.614967          2.225864          2.873639          4.127731  
DEST_HEX_IDH0516  DEST_HEX_IDH0517  DEST_HEX_IDH0518  DEST_HEX_IDH0519  
        4.280162          2.795567          4.816425          2.337709  
DEST_HEX_IDH0520  DEST_HEX_IDH0521  DEST_HEX_IDH0522  DEST_HEX_IDH0523  
        2.454733          4.696284          1.458477          1.554204  
DEST_HEX_IDH0524  DEST_HEX_IDH0525  DEST_HEX_IDH0526  DEST_HEX_IDH0527  
        1.893442          2.208987          3.428967          4.510363  
DEST_HEX_IDH0528  DEST_HEX_IDH0529  DEST_HEX_IDH0530  DEST_HEX_IDH0531  
        3.561677          3.257104          3.502693          3.196951  
DEST_HEX_IDH0532  DEST_HEX_IDH0533  DEST_HEX_IDH0534  DEST_HEX_IDH0535  
        3.380266          3.141548          0.037996         -2.467587  
DEST_HEX_IDH0536  DEST_HEX_IDH0537  DEST_HEX_IDH0538  DEST_HEX_IDH0539  
        2.499707          4.187043          3.962845          2.902911  
DEST_HEX_IDH0540  DEST_HEX_IDH0541  DEST_HEX_IDH0542  DEST_HEX_IDH0543  
        3.282710          2.731063          0.816392          3.659040  
DEST_HEX_IDH0544  DEST_HEX_IDH0545  DEST_HEX_IDH0546  DEST_HEX_IDH0547  
        2.214051          2.536063          1.223049          2.608414  
DEST_HEX_IDH0548  DEST_HEX_IDH0549  DEST_HEX_IDH0550  DEST_HEX_IDH0551  
        2.822135          3.579173          3.722946          3.313077  
DEST_HEX_IDH0552  DEST_HEX_IDH0553  DEST_HEX_IDH0554  DEST_HEX_IDH0555  
        3.124754          3.829221          1.663745          1.997637  
DEST_HEX_IDH0556  DEST_HEX_IDH0557  DEST_HEX_IDH0558  DEST_HEX_IDH0559  
        2.568229          0.116320          2.964469          3.696354  
DEST_HEX_IDH0560  DEST_HEX_IDH0561  DEST_HEX_IDH0562  DEST_HEX_IDH0563  
        3.198403          3.721022          3.918651          3.132998  
DEST_HEX_IDH0564  DEST_HEX_IDH0565  DEST_HEX_IDH0566  DEST_HEX_IDH0567  
        0.680806          2.362188          1.136069          1.239387  
DEST_HEX_IDH0568  DEST_HEX_IDH0569  DEST_HEX_IDH0570  DEST_HEX_IDH0571  
        1.013119         -0.766910          0.718610          1.520767  
DEST_HEX_IDH0572  DEST_HEX_IDH0573  DEST_HEX_IDH0574  DEST_HEX_IDH0575  
        2.187446          1.223950          3.431629          2.230228  
DEST_HEX_IDH0576  DEST_HEX_IDH0577  DEST_HEX_IDH0578  DEST_HEX_IDH0579  
        2.204244          3.279526          1.114432          1.152033  
DEST_HEX_IDH0580  DEST_HEX_IDH0581  DEST_HEX_IDH0582  DEST_HEX_IDH0583  
        0.481599          3.389373          2.863865          3.114102  
DEST_HEX_IDH0584  DEST_HEX_IDH0585  DEST_HEX_IDH0586  DEST_HEX_IDH0587  
        3.861218          2.211253          3.295664          3.116874  
DEST_HEX_IDH0588  DEST_HEX_IDH0589  DEST_HEX_IDH0590  DEST_HEX_IDH0591  
        1.245465          3.425660          3.266696          0.798010  
DEST_HEX_IDH0592  DEST_HEX_IDH0593  DEST_HEX_IDH0594  DEST_HEX_IDH0595  
        3.393224          3.737937          2.362953          3.587353  
DEST_HEX_IDH0596  DEST_HEX_IDH0597  DEST_HEX_IDH0598  DEST_HEX_IDH0599  
        5.042322          2.131685          3.822190          2.082611  
DEST_HEX_IDH0600  DEST_HEX_IDH0601  DEST_HEX_IDH0602  DEST_HEX_IDH0603  
        2.342904         -0.625526          1.228717          3.314596  
DEST_HEX_IDH0604  DEST_HEX_IDH0605  DEST_HEX_IDH0606  DEST_HEX_IDH0607  
        2.253293          2.790110          2.523578          3.118912  
DEST_HEX_IDH0608  DEST_HEX_IDH0609  DEST_HEX_IDH0610  DEST_HEX_IDH0611  
        2.873413          3.129405          3.439544         -0.157867  
DEST_HEX_IDH0612  DEST_HEX_IDH0613  DEST_HEX_IDH0614  DEST_HEX_IDH0615  
        3.684811          2.535365          1.376336          3.094607  
DEST_HEX_IDH0616  DEST_HEX_IDH0617  DEST_HEX_IDH0618  DEST_HEX_IDH0619  
        3.597323          3.695801          2.921710          2.238608  
DEST_HEX_IDH0620  DEST_HEX_IDH0621  DEST_HEX_IDH0622  DEST_HEX_IDH0623  
        3.146736          2.920960          2.666799          2.013978  
DEST_HEX_IDH0624  DEST_HEX_IDH0625  DEST_HEX_IDH0626  DEST_HEX_IDH0627  
        1.876633          2.006745          3.114792          2.325934  
DEST_HEX_IDH0628  DEST_HEX_IDH0629  DEST_HEX_IDH0630  DEST_HEX_IDH0631  
        2.949255          2.757282          3.125329          2.719425  
DEST_HEX_IDH0632  DEST_HEX_IDH0633  DEST_HEX_IDH0634  DEST_HEX_IDH0635  
        3.214072          4.314254          3.665015          1.374005  
DEST_HEX_IDH0636  DEST_HEX_IDH0637  DEST_HEX_IDH0638  DEST_HEX_IDH0639  
        3.386005         -1.322694          3.264108          3.565578  
DEST_HEX_IDH0640  DEST_HEX_IDH0641  DEST_HEX_IDH0642  DEST_HEX_IDH0643  
        2.738016          0.792480          3.036793          3.283025  
DEST_HEX_IDH0644  DEST_HEX_IDH0645  DEST_HEX_IDH0646  DEST_HEX_IDH0647  
        2.769975          3.452383          3.837109          2.449510  
DEST_HEX_IDH0648  DEST_HEX_IDH0649  DEST_HEX_IDH0650  DEST_HEX_IDH0651  
        4.229594          2.732159          1.506714          3.420316  
DEST_HEX_IDH0652  DEST_HEX_IDH0653  DEST_HEX_IDH0654  DEST_HEX_IDH0655  
        4.575117          3.608141          2.957990          0.179054  
DEST_HEX_IDH0656  DEST_HEX_IDH0657  DEST_HEX_IDH0658  DEST_HEX_IDH0659  
        0.536989          2.794187          3.020337          2.440945  
DEST_HEX_IDH0660  DEST_HEX_IDH0661  DEST_HEX_IDH0662  DEST_HEX_IDH0663  
        1.810258          2.878175          2.543317          4.558320  
DEST_HEX_IDH0664  DEST_HEX_IDH0665  DEST_HEX_IDH0666  DEST_HEX_IDH0667  
        3.040395          2.363782          4.008456          3.729332  
DEST_HEX_IDH0668  DEST_HEX_IDH0669  DEST_HEX_IDH0670  DEST_HEX_IDH0671  
        2.957269          2.110771          0.331823          0.459399  
DEST_HEX_IDH0672  DEST_HEX_IDH0673  DEST_HEX_IDH0674  DEST_HEX_IDH0675  
        3.233529          3.241666          3.214507          2.321928  
DEST_HEX_IDH0676  DEST_HEX_IDH0677  DEST_HEX_IDH0678  DEST_HEX_IDH0679  
        2.864394          2.978500          4.052061          3.344093  
DEST_HEX_IDH0680  DEST_HEX_IDH0681  DEST_HEX_IDH0682  DEST_HEX_IDH0683  
        2.937789          3.039784          4.528236          1.038136  
DEST_HEX_IDH0684  DEST_HEX_IDH0685  DEST_HEX_IDH0686  DEST_HEX_IDH0687  
        4.516477          2.687913          2.695599          1.906871  
DEST_HEX_IDH0688  DEST_HEX_IDH0689  DEST_HEX_IDH0690  DEST_HEX_IDH0691  
       -0.111637          2.624262          4.222166          1.943483  
DEST_HEX_IDH0692  DEST_HEX_IDH0693  DEST_HEX_IDH0694  DEST_HEX_IDH0695  
        3.951635          2.968672          3.291826          3.487273  
DEST_HEX_IDH0696  DEST_HEX_IDH0697  DEST_HEX_IDH0698  DEST_HEX_IDH0700  
        0.415928          3.440940          2.908117          3.329157  
DEST_HEX_IDH0701  DEST_HEX_IDH0702  DEST_HEX_IDH0703  DEST_HEX_IDH0704  
        1.445258          3.283821          3.169367          0.128001  
DEST_HEX_IDH0705  DEST_HEX_IDH0706  DEST_HEX_IDH0707  DEST_HEX_IDH0708  
        3.216814          2.761318          2.936464          2.334206  
DEST_HEX_IDH0709  DEST_HEX_IDH0710  DEST_HEX_IDH0711  DEST_HEX_IDH0712  
        1.968273         -0.344207         -0.315852          2.549716  
DEST_HEX_IDH0713  DEST_HEX_IDH0714  DEST_HEX_IDH0715  DEST_HEX_IDH0716  
        0.792849          2.435182          3.335515          3.619398  
DEST_HEX_IDH0717  DEST_HEX_IDH0718  DEST_HEX_IDH0719  DEST_HEX_IDH0720  
        0.701656          2.539664          2.931083          3.322718  
DEST_HEX_IDH0721  DEST_HEX_IDH0722  DEST_HEX_IDH0723  DEST_HEX_IDH0724  
        3.371969          1.011738         -0.404397          2.594094  
DEST_HEX_IDH0725  DEST_HEX_IDH0726  DEST_HEX_IDH0727  DEST_HEX_IDH0728  
        5.136437          2.602730          3.160171          1.113706  
DEST_HEX_IDH0729  DEST_HEX_IDH0730  DEST_HEX_IDH0731  DEST_HEX_IDH0732  
        2.658856          0.904551          3.002982          1.841507  
DEST_HEX_IDH0733  DEST_HEX_IDH0734  DEST_HEX_IDH0735  DEST_HEX_IDH0736  
        3.269840          2.072026          2.609578          2.962415  
DEST_HEX_IDH0737  DEST_HEX_IDH0738  DEST_HEX_IDH0739  DEST_HEX_IDH0740  
        3.443335          3.555666          3.868691          3.158669  
DEST_HEX_IDH0741  DEST_HEX_IDH0742  DEST_HEX_IDH0743  DEST_HEX_IDH0744  
        3.654327          1.024310          3.351287          3.700131  
DEST_HEX_IDH0745  DEST_HEX_IDH0746  DEST_HEX_IDH0747  DEST_HEX_IDH0748  
        3.313557          2.877465          2.115684          3.678146  
DEST_HEX_IDH0749  DEST_HEX_IDH0750  DEST_HEX_IDH0751  DEST_HEX_IDH0752  
        2.752506          3.287471          0.632094          3.980285  
DEST_HEX_IDH0753  DEST_HEX_IDH0754  DEST_HEX_IDH0755  DEST_HEX_IDH0756  
        2.782319          3.015441          1.017841          3.214035  
DEST_HEX_IDH0757  DEST_HEX_IDH0758  DEST_HEX_IDH0759  DEST_HEX_IDH0760  
        2.449048          0.784740          5.313037          2.937669  
DEST_HEX_IDH0761  DEST_HEX_IDH0762  DEST_HEX_IDH0763  DEST_HEX_IDH0764  
        3.178362          2.519548          4.072790          2.990198  
DEST_HEX_IDH0765  DEST_HEX_IDH0766  DEST_HEX_IDH0767  DEST_HEX_IDH0768  
        3.160478          2.365322          4.886030          2.063059  
DEST_HEX_IDH0769  DEST_HEX_IDH0770  DEST_HEX_IDH0771  DEST_HEX_IDH0772  
        2.145451          1.067502          2.145114          3.806161  
DEST_HEX_IDH0773  DEST_HEX_IDH0774  DEST_HEX_IDH0775  DEST_HEX_IDH0776  
        2.901185          2.171768          0.472512          2.064051  
DEST_HEX_IDH0777  DEST_HEX_IDH0778  DEST_HEX_IDH0779  DEST_HEX_IDH0780  
        2.143427          3.635922          3.651786          3.410407  
DEST_HEX_IDH0781  DEST_HEX_IDH0782  DEST_HEX_IDH0783  DEST_HEX_IDH0784  
        2.832403          1.255493          3.534785          4.089724  
DEST_HEX_IDH0785  DEST_HEX_IDH0786  DEST_HEX_IDH0787  DEST_HEX_IDH0788  
        3.766756          3.051946          3.468922          2.259487  
DEST_HEX_IDH0789  DEST_HEX_IDH0790  DEST_HEX_IDH0791  DEST_HEX_IDH0792  
        2.618421          2.942034          2.977135          1.963645  
DEST_HEX_IDH0793  DEST_HEX_IDH0794  DEST_HEX_IDH0795  DEST_HEX_IDH0796  
        2.519339          3.302816          1.702755          1.760121  
DEST_HEX_IDH0797  DEST_HEX_IDH0798  DEST_HEX_IDH0799  DEST_HEX_IDH0800  
        0.566931          1.151620          2.961783          1.712370  
DEST_HEX_IDH0801  DEST_HEX_IDH0802  DEST_HEX_IDH0803  DEST_HEX_IDH0804  
        1.739898          3.146440          2.228989          1.033389  
DEST_HEX_IDH0805  DEST_HEX_IDH0806  DEST_HEX_IDH0807  DEST_HEX_IDH0808  
       -0.319348          0.370189          1.462201          1.108119  
DEST_HEX_IDH0809  DEST_HEX_IDH0810  DEST_HEX_IDH0811  DEST_HEX_IDH0812  
        1.146375          1.031442          1.320106          1.188110  
DEST_HEX_IDH0813  DEST_HEX_IDH0814  DEST_HEX_IDH0815  DEST_HEX_IDH0816  
        0.444582          2.740441          0.855665          1.238869  
DEST_HEX_IDH0817  DEST_HEX_IDH0818  DEST_HEX_IDH0819  DEST_HEX_IDH0820  
        3.586449          4.640875          4.274430          4.880890  
DEST_HEX_IDH0821  DEST_HEX_IDH0822  DEST_HEX_IDH0823  DEST_HEX_IDH0824  
        5.272874          2.751458          3.094201          1.902852  
DEST_HEX_IDH0825  DEST_HEX_IDH0826  DEST_HEX_IDH0827  DEST_HEX_IDH0828  
        0.129452          2.446918          2.226008          0.435696  
DEST_HEX_IDH0829  DEST_HEX_IDH0830  DEST_HEX_IDH0831     log(DISTANCE)  
        1.765409          1.975391          3.047914         -1.566532  

Degrees of Freedom: 59275 Total (i.e. Null);  57640 Residual
Null Deviance:      19980000 
Residual Deviance: 4314000  AIC: 4586000</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="insights-8" class="level4 callout-tips" data-collapse="true" data-appearance="minimal">
<h4 class="anchored" data-anchor-id="insights-8">Insights</h4>
<p>As expected, the <strong>distance</strong> has negative coefficient, which means that the longer the distance, the less number of trips.</p>
<p>This is consistent with real-world observations and our observations from [Plotting TRIPS vs.&nbsp;DISTANCE].</p>
</section>
</div>
</div>
</div>
</section>
<section id="model-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="model-comparisons">Model Comparisons</h2>
<p>To compare the models, we will first create the list containing the different models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Unconstrained =</span> uncSIM,</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Origin_Constrained =</span> orcSIM,</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Destination_Constrained =</span> decSIM,</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Doubly_Constrained =</span> dbcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">Goodness of Fit (via R-squared)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">Performance via RMSE</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<p>We will use the following function to calculate the <strong>goodness of fit</strong>, or <strong>R-squared.</strong> This will calculate how the observed data fits our model by comparing the observed values to the values generated by our models.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The higher the R-squared value is, the better the fit.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>calc_r_squared <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(model<span class="sc">$</span>data<span class="sc">$</span>TRIPS, model<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will apply this function to each model by using <code>sapply()</code> to apply the function to each model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">tibble</span>(</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">names</span>(model_list),</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_squared =</span> <span class="fu">sapply</span>(model_list, calc_r_squared)</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">R_squared</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Unconstrained</td>
<td style="text-align: right;">0.4184592</td>
</tr>
<tr class="even">
<td style="text-align: left;">Origin_Constrained</td>
<td style="text-align: right;">0.4904425</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Destination_Constrained</td>
<td style="text-align: right;">0.5393081</td>
</tr>
<tr class="even">
<td style="text-align: left;">Doubly_Constrained</td>
<td style="text-align: right;">0.6103781</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Doubly constrained model</strong>, which models the effect of solely the <strong>distance</strong> to the number of bus trips has the best fit.</p>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<p><a href="https://www.statisticshowto.com/probability-and-statistics/regression-analysis/rmse-root-mean-square-error/">Root Mean Squared Error (RMSE)</a> is a measure of how spread out the values are from the best-fit line.</p>
<p>To calculate this, we will use the <code>RMSE</code> model in <code>compare_performance()</code>.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The lower the RMSE is, the better the model.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(model_list,</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="st">"RMSE"</span>) <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Name</th>
<th style="text-align: left;">Model</th>
<th style="text-align: right;">RMSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Unconstrained</td>
<td style="text-align: left;">glm</td>
<td style="text-align: right;">288.2614</td>
</tr>
<tr class="even">
<td style="text-align: left;">Origin_Constrained</td>
<td style="text-align: left;">glm</td>
<td style="text-align: right;">269.8498</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Destination_Constrained</td>
<td style="text-align: left;">glm</td>
<td style="text-align: right;">257.2348</td>
</tr>
<tr class="even">
<td style="text-align: left;">Doubly_Constrained</td>
<td style="text-align: left;">glm</td>
<td style="text-align: right;">236.1052</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alternative method
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can also calculate the RMSE by using the <code>rmse()</code> method directly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">tibble</span>(</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">names</span>(model_list),</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_squared =</span> <span class="fu">sapply</span>(model_list, rmse)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">R_squared</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Unconstrained</td>
<td style="text-align: right;">288.2614</td>
</tr>
<tr class="even">
<td style="text-align: left;">Origin_Constrained</td>
<td style="text-align: right;">269.8498</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Destination_Constrained</td>
<td style="text-align: right;">257.2348</td>
</tr>
<tr class="even">
<td style="text-align: left;">Doubly_Constrained</td>
<td style="text-align: right;">236.1052</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p><strong>Doubly constrained model</strong>, which models the effect of solely the <strong>distance</strong> is the best model according to this metric.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-80-contents" aria-controls="callout-80" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-80" class="callout-80-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>From the model comparisons, we can see that the <strong>doubly constrained model</strong>, which models the effect of solely the <strong>distance</strong> is the best model by all metrics.</p>
<p>This means that the distance is the <strong>best indicator of whether a person with take a bus</strong> or not during weekend/holiday mornings.</p>
</div>
</div>
</div>
</section>
<section id="visualizing-the-fit" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-the-fit">Visualizing the fit</h2>
<p>Next, we will visualize the observed values and the fitted values to see how the model fits with the observed data.</p>
<section id="extracting-the-fitted-values" class="level3">
<h3 class="anchored" data-anchor-id="extracting-the-fitted-values">Extracting the fitted values</h3>
<p>First, we will extract the fitted values from the model in preparation for input with <code>ggplot</code>.</p>
<p>We will initiate a data frame from <code>SIM_data_no_intra</code>, with extracted <code>TRIPS</code> data to store those values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>SIM_data_no_intra_fitted <span class="ot">&lt;-</span> SIM_data_no_intra <span class="sc">%&gt;%</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ORIG_HEX_ID, DEST_HEX_ID, TRIPS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">Unconstrained</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">Origin constrained</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false">Destination constrained</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-4" role="tab" aria-controls="tabset-17-4" aria-selected="false">Doubly constrained</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>SIM_data_no_intra_fitted <span class="ot">&lt;-</span> SIM_data_no_intra_fitted <span class="sc">%&gt;%</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(uncSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">uncTRIPS =</span> <span class="st">"uncSIM.fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>SIM_data_no_intra_fitted <span class="ot">&lt;-</span> SIM_data_no_intra_fitted <span class="sc">%&gt;%</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(orcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orcTRIPS =</span> <span class="st">"orcSIM.fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>SIM_data_no_intra_fitted <span class="ot">&lt;-</span> SIM_data_no_intra_fitted <span class="sc">%&gt;%</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(decSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">decTRIPS =</span> <span class="st">"decSIM.fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-17-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>SIM_data_no_intra_fitted <span class="ot">&lt;-</span> SIM_data_no_intra_fitted <span class="sc">%&gt;%</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(dbcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dbcTRIPS =</span> <span class="st">"dbcSIM.fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(SIM_data_no_intra_fitted))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">ORIG_HEX_ID</th>
<th style="text-align: left;">DEST_HEX_ID</th>
<th style="text-align: right;">TRIPS</th>
<th style="text-align: right;">uncTRIPS</th>
<th style="text-align: right;">orcTRIPS</th>
<th style="text-align: right;">decTRIPS</th>
<th style="text-align: right;">dbcTRIPS</th>
<th style="text-align: left;">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">H0002</td>
<td style="text-align: left;">H0016</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">17</td>
<td style="text-align: left;">LINESTRING (4345.122 28430….</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0002</td>
<td style="text-align: left;">H0017</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">LINESTRING (4345.122 28430….</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0002</td>
<td style="text-align: left;">H0032</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">LINESTRING (4345.122 28430….</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0003</td>
<td style="text-align: left;">H0005</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">82</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">LINESTRING (4345.122 31028….</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H0003</td>
<td style="text-align: left;">H0022</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">LINESTRING (4345.122 31028….</td>
</tr>
<tr class="even">
<td style="text-align: left;">H0003</td>
<td style="text-align: left;">H0028</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">LINESTRING (4345.122 31028….</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="plotting-the-fit" class="level3">
<h3 class="anchored" data-anchor-id="plotting-the-fit">Plotting the fit</h3>
<p>Finally, we will plot the fit using `ggplot`, plotting all the graphs in side by side for easier comparison.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>plot_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(modelTrips) {</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data_no_intra_fitted,</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes_string</span>(<span class="at">x =</span> modelTrips,</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> <span class="st">"TRIPS"</span>)) <span class="sc">+</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_fit</span>(<span class="st">"uncTRIPS"</span>), <span class="fu">plot_fit</span>(<span class="st">"orcTRIPS"</span>),</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_fit</span>(<span class="st">"decTRIPS"</span>), <span class="fu">plot_fit</span>(<span class="st">"dbcTRIPS"</span>),</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-161-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-81-contents" aria-controls="callout-81" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-81" class="callout-81-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Although the <strong>doubly constrained</strong> <strong>model</strong> is the most fitted, it can be noticed that the points are most concentrated on the lower values of trips.</p>
<p>Various outliers can be seen above the line, where the <strong>model predicted low values but observed values are high</strong>, i.e.&nbsp;modelled is 3,000 but observed is 12,000.</p>
<p>Similarly, outliers can be seen below the line, where the <strong>model predicted high values but observed values are low</strong>, i.e.&nbsp;modelled is 8,000 but observed is 0.</p>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The result of the modelling thus far does that mean that this is the best reflection of the real-world scenario. It just means that the <strong>alternative models do a worse job of modelling</strong>.</p>
<p>For example, from <a href="#sec-plotting-trips-vs-distance">plotting TRIPS vs DISTANCE</a>, we observed outliers in the plot, i.e.&nbsp;zone pairs that have long distances but on the top 5% highest number of trips. The same can be observed in <a href="#plotting-the-fit">Plotting the fit</a>. Clearly, there are other forces that result in bus trips, other than distance, that are not uncovered by the models we have.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-82-contents" aria-controls="callout-82" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Save point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-82" class="callout-82-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s save <code>SIMdata_no_intra</code> as we will use it for further modelling,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(SIM_data_no_intra, <span class="st">"data/rds/SIM_data_no_intra202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-83-contents" aria-controls="callout-83" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data clear point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-83" class="callout-83-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will clear the data we do not need anymore.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(model_list)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dbcSIM)</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(decSIM)</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(orcSIM)</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(SIM_data)</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(SIM_data_no_intra_fitted)</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(plot_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="improving-the-models" class="level1">
<h1>Improving the Models</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-84-contents" aria-controls="callout-84" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Load point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-84" class="callout-84-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can start from this point by loading the relevant datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/SIM_data_no_intra202310.rds"</span>)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>uncSIM <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/uncSIM202310.rds"</span>)</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>dbcSIM <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/dbcSIM202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will also load the <code>calc_r_squared()</code> function for model comparison.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>calc_r_squared <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(model<span class="sc">$</span>data<span class="sc">$</span>TRIPS, model<span class="sc">$</span>fitted.values)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>From <a href="#spatial-interaction-modelling">Spatial Interaction Modelling</a>, we found that the <strong>doubly constrained model</strong> is the best out of all the models we created so far. In this part, we will try to improve the models, with the doubly constrained metrics as baseline:</p>
<p><strong>R-squared</strong>: 0.6103781</p>
<p><strong>RMSE:</strong> 236.1052</p>
<p>As the doubly constrained model does not use explanatory variables other than distance, we will only focus our improvements on the three other models that consider the attractive and propulsive forces: <strong>origin constrained</strong>, <strong>destination constrained</strong>.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>As I am no statistics expert and do not have research background, the techniques here are based on common sense and are not based on best practices in the industry.</p>
<p>I just want to explore if doing these steps can improve the initial models, for my own curiosity.</p>
</div>
</div>
<section id="opportunities-for-improvement" class="level2">
<h2 class="anchored" data-anchor-id="opportunities-for-improvement">Opportunities for Improvement</h2>
<p>To improve our model, we can do the following approaches.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">Plot correlation matrix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">Inspect variable relationship</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false">Use other regression methods</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<p>By plotting correlation matrix, we can see if there are explanatory variables that are closely correlated to each other.</p>
<p>When use multiple variables with strong correlation, it will skew the model as the effects of common force are amplified.</p>
<p>When we find explanatory variables that are closely correlated, we will remove some of them from the model.</p>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<p>By applying <em>log</em> to all our explanatory variables, we have assumed that all are exponentially correlated, not linearly correlated.</p>
<p>By plotting the <code>TRIPS</code> vs explanatory variable, we can more easily visualize if this relation is true.</p>
<p>If it turns out that the relation is linear and not exponential, we will remove <em>log</em> from the model for that explanatory variable, so that <code>glm()</code> can fit a line better to our data.</p>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<p>We are using <a href="https://stats.oarc.ucla.edu/r/dae/poisson-regression/">Poisson regression</a> method, which is approriate for when the mean and variance of the dependent variable are not extremely different.</p>
<p>However, this is not the case for our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(SIM_data<span class="sc">$</span>TRIPS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 92.74146</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(SIM_data<span class="sc">$</span>TRIPS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 142840.4</code></pre>
</div>
</div>
<p><strong>Negative binomial regression</strong> may be more appropriate for our dataset as it is more suitable for over-dispersed data.</p>
</div>
</div>
</div>
</section>
<section id="plotting-correlation-matrix" class="level2">
<h2 class="anchored" data-anchor-id="plotting-correlation-matrix">Plotting Correlation Matrix</h2>
<p>Let’s plot the correlation matrix using <code>corrplot()</code> we will set a significance level (<span class="math inline">\(\alpha\)</span> value) of <strong>0.05</strong>.</p>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"ORIG_HEX_ID"</span>, <span class="st">"DEST_HEX_ID"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>(</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"lower"</span>,</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"square"</span>,</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Correlation map of model variables"</span>,</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">addCoef.col =</span> <span class="st">"white"</span>,</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">number.cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">number.digits =</span> <span class="dv">2</span>,</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">insig =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-168-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Next, we will remove data with different correlation levels until we determine what will give us the best model performance.</p>
<p>We will use only <strong>unconstrained model</strong> for comparison as it has all the explanatory variables. In addition, we can generate this model the fastest out of all the models.</p>
<p>Also, we will remove <strong>the least number of explanatory variables</strong> that meet the condition we need.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">Correlation &lt; 0.8</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">Correlation &lt; 0.6</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<p>To improve the model, we will remove those that have very strong correlation first (<strong>0.8</strong> to <strong>1</strong>).</p>
<p>Let us remove <code>DEST_LEISURE_COUNT</code>, instead of <code>DEST_F_AND_B_COUNT</code> as it had negative coefficients from our previous model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>SIM_data_corr_lt_08 <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="st">"DEST_LEISURE_COUNT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="correlation-matrix" class="level4">
<h4 class="anchored" data-anchor-id="correlation-matrix">Correlation Matrix</h4>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>SIM_data_corr_lt_08 <span class="sc">%&gt;%</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"ORIG_HEX_ID"</span>, <span class="st">"DEST_HEX_ID"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>(</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"lower"</span>,</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"square"</span>,</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Correlation map of model variables"</span>,</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">addCoef.col =</span> <span class="st">"white"</span>,</span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">number.cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">number.digits =</span> <span class="dv">2</span>,</span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">insig =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-170-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="model-generation" class="level4">
<h4 class="anchored" data-anchor-id="model-generation">Model generation</h4>
<p>We do not have variables with correlation &gt;= 0.8 anymore so we can proceed with generating the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>uncSIM_corr_lt_08 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(ORIG_HDB_RESIDENT_COUNT) <span class="sc">+</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(ORIG_BUS_ALIGHT_COUNT) <span class="sc">+</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(ORIG_TRAIN_ALIGHT_COUNT) <span class="sc">+</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(DEST_BUS_STOP_COUNT) <span class="sc">+</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(DEST_ENTERTN_COUNT) <span class="sc">+</span></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(DEST_F_AND_B_COUNT) <span class="sc">+</span></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(DEST_RETAIL_COUNT) <span class="sc">+</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(DEST_TRAIN_EXITS_COUNT) <span class="sc">+</span></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(DEST_HDB_COUNT) <span class="sc">+</span></span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(DISTANCE),</span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> SIM_data,</span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">na.action =</span> na.exclude)</span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(uncSIM_corr_lt_08, <span class="st">"data/rds/uncSIM_corr_lt_08_202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>uncSIM_corr_lt_08 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/uncSIM_corr_lt_08_202310.rds"</span>)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>uncSIM_corr_lt_08</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = TRIPS ~ log(ORIG_HDB_RESIDENT_COUNT) + log(ORIG_BUS_ALIGHT_COUNT) + 
    log(ORIG_TRAIN_ALIGHT_COUNT) + log(DEST_BUS_STOP_COUNT) + 
    log(DEST_ENTERTN_COUNT) + log(DEST_F_AND_B_COUNT) + log(DEST_RETAIL_COUNT) + 
    log(DEST_TRAIN_EXITS_COUNT) + log(DEST_HDB_COUNT) + log(DISTANCE), 
    family = poisson(link = "log"), data = SIM_data, na.action = na.exclude)

Coefficients:
                 (Intercept)  log(ORIG_HDB_RESIDENT_COUNT)  
                     9.10977                       0.01501  
  log(ORIG_BUS_ALIGHT_COUNT)  log(ORIG_TRAIN_ALIGHT_COUNT)  
                     0.61923                      -0.01804  
    log(DEST_BUS_STOP_COUNT)       log(DEST_ENTERTN_COUNT)  
                     0.23040                      -0.11235  
     log(DEST_F_AND_B_COUNT)        log(DEST_RETAIL_COUNT)  
                    -0.05948                       0.11518  
 log(DEST_TRAIN_EXITS_COUNT)           log(DEST_HDB_COUNT)  
                     0.58593                       0.18638  
               log(DISTANCE)  
                    -1.48389  

Degrees of Freedom: 59275 Total (i.e. Null);  59265 Residual
Null Deviance:      19980000 
Residual Deviance: 7210000  AIC: 7478000</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<p>To improve the model, we will remove those that have very strong correlation first (<strong>0.8</strong> to <strong>1</strong>) and strong correlation (<strong>0.6</strong> to <strong>0.8</strong>).</p>
<p>Let us remove <code>DEST_F_AND_B_COUNT</code> and <code>DEST_ENTERTN_COUNT</code> as it is the least number of columns to be removed to satisfy the condition.</p>
<p>We will remove <code>DEST_ENTERTN_COUNT</code> instead of <code>DEST_RETAIL_COUNT</code> as the former had negative coeficient from the previous model, and has less numbers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>SIM_data_corr_lt_06 <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"DEST_F_AND_B_COUNT"</span>, <span class="st">"DEST_ENTERTN_COUNT"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="correlation-matrix-1" class="level4">
<h4 class="anchored" data-anchor-id="correlation-matrix-1">Correlation Matrix</h4>
<div class="cell">
<details>
<summary><strong>Show the code</strong></summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>SIM_data_corr_lt_06 <span class="sc">%&gt;%</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"ORIG_HEX_ID"</span>, <span class="st">"DEST_HEX_ID"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>(</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"lower"</span>,</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"square"</span>,</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Correlation map of model variables"</span>,</span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">addCoef.col =</span> <span class="st">"white"</span>,</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">number.cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">number.digits =</span> <span class="dv">2</span>,</span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">insig =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex2_files/figure-html/unnamed-chunk-174-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="model-generation-1" class="level4">
<h4 class="anchored" data-anchor-id="model-generation-1">Model generation</h4>
<p>We do not have variables with correlation &gt;= 0.6 anymore so we can proceed with generating the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>uncSIM_corr_lt_06 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(ORIG_HDB_RESIDENT_COUNT) <span class="sc">+</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(ORIG_BUS_ALIGHT_COUNT) <span class="sc">+</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(ORIG_TRAIN_ALIGHT_COUNT) <span class="sc">+</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(DEST_BUS_STOP_COUNT) <span class="sc">+</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(DEST_LEISURE_COUNT) <span class="sc">+</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(DEST_RETAIL_COUNT) <span class="sc">+</span></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(DEST_TRAIN_EXITS_COUNT) <span class="sc">+</span></span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(DEST_HDB_COUNT) <span class="sc">+</span></span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(DISTANCE),</span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> SIM_data,</span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">na.action =</span> na.exclude)</span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(uncSIM_corr_lt_06, <span class="st">"data/rds/uncSIM_corr_lt_06_202310.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>uncSIM_corr_lt_06 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/uncSIM_corr_lt_06_202310.rds"</span>)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>uncSIM_corr_lt_06</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = TRIPS ~ log(ORIG_HDB_RESIDENT_COUNT) + log(ORIG_BUS_ALIGHT_COUNT) + 
    log(ORIG_TRAIN_ALIGHT_COUNT) + log(DEST_BUS_STOP_COUNT) + 
    log(DEST_LEISURE_COUNT) + log(DEST_RETAIL_COUNT) + log(DEST_TRAIN_EXITS_COUNT) + 
    log(DEST_HDB_COUNT) + log(DISTANCE), family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Coefficients:
                 (Intercept)  log(ORIG_HDB_RESIDENT_COUNT)  
                     9.16087                       0.01519  
  log(ORIG_BUS_ALIGHT_COUNT)  log(ORIG_TRAIN_ALIGHT_COUNT)  
                     0.61847                      -0.01831  
    log(DEST_BUS_STOP_COUNT)       log(DEST_LEISURE_COUNT)  
                     0.20658                      -0.11862  
      log(DEST_RETAIL_COUNT)   log(DEST_TRAIN_EXITS_COUNT)  
                     0.11444                       0.56941  
         log(DEST_HDB_COUNT)                 log(DISTANCE)  
                     0.19511                      -1.48215  

Degrees of Freedom: 59275 Total (i.e. Null);  59266 Residual
Null Deviance:      19980000 
Residual Deviance: 7204000  AIC: 7473000</code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
<section id="model-comparison" class="level3">
<h3 class="anchored" data-anchor-id="model-comparison">Model comparison</h3>
<p>We will now compare the model performance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>model_list_corr <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Unconstrained_Original =</span> uncSIM,</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Unconstrained_Corr_Lt08 =</span> uncSIM_corr_lt_08,</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Unconstrained_Corr_Lt06 =</span> uncSIM_corr_lt_06,</span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Doubly_Constrained_Original =</span> dbcSIM)</span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">tibble</span>(</span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">names</span>(model_list_corr),</span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_squared =</span> <span class="fu">sapply</span>(model_list_corr, calc_r_squared),</span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE =</span> <span class="fu">sapply</span>(model_list_corr, rmse)</span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">R_squared</th>
<th style="text-align: right;">RMSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Unconstrained_Original</td>
<td style="text-align: right;">0.4184592</td>
<td style="text-align: right;">288.2614</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unconstrained_Corr_Lt08</td>
<td style="text-align: right;">0.4156528</td>
<td style="text-align: right;">288.9524</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unconstrained_Corr_Lt06</td>
<td style="text-align: right;">0.4164312</td>
<td style="text-align: right;">288.7554</td>
</tr>
<tr class="even">
<td style="text-align: left;">Doubly_Constrained_Original</td>
<td style="text-align: right;">0.6103781</td>
<td style="text-align: right;">236.1052</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-86-contents" aria-controls="callout-86" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-86" class="callout-86-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Removing some explanatory variables does not change the coefficients of the explanatory variables in the model. This means that the coefficients were generated individually for each explanatory variable.</p>
<p>In addition, removing a few variables resulted in <strong>very slight worsening in performance</strong>. Hence, it may not be worth removing variables to for improving model performance. However, for less powerful computer, it may be worth it to remove some variables to enable the computer to generate a model. Using a correlation matrix can be a good way to determine which variables can be removed.</p>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>